{"version":3,"file":"vendors-node_modules_theia_ai-mcp_lib_browser_mcp-frontend-module_js-node_modules_fast-deep-e-bdc21c.js","mappings":";;;;;;;;;;AAAA,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;;AAGhF,wIAAkE;AAClE,8GAAmE;AACnE,iJAA6D;AAE7D,0JAAkE;AAClE,4GAAiE;AAuBhE,CAAC;AAEF,IAAU,oBAAoB,CAa7B;AAbD,WAAU,oBAAoB;IAC1B,SAAgB,OAAO,CAAC,GAAY;QAChC,OAAO,CAAC,CAAC,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ;YACnC,CAAC,SAAS,IAAI,GAAG,IAAI,WAAW,IAAI,GAAG,CAAC;YACxC,CAAC,CAAC,CAAC,SAAS,IAAI,GAAG,CAAC,IAAI,OAAO,GAAG,CAAC,OAAO,KAAK,QAAQ,CAAC;YACxD,CAAC,CAAC,CAAC,MAAM,IAAI,GAAG,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,GAAG,KAAK,QAAQ,CAAC,CAAC;YAC/F,CAAC,CAAC,CAAC,KAAK,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,IAAI,OAAO,GAAG,CAAC,GAAG,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC;YACjI,CAAC,CAAC,CAAC,WAAW,IAAI,GAAG,CAAC,IAAI,OAAO,GAAG,CAAC,SAAS,KAAK,SAAS,CAAC;YAC7D,CAAC,CAAC,CAAC,WAAW,IAAI,GAAG,CAAC,IAAI,OAAO,GAAG,CAAC,SAAS,KAAK,QAAQ,CAAC;YAC5D,CAAC,CAAC,CAAC,iBAAiB,IAAI,GAAG,CAAC,IAAI,OAAO,GAAG,CAAC,eAAe,KAAK,QAAQ,CAAC;YACxE,CAAC,CAAC,CAAC,uBAAuB,IAAI,GAAG,CAAC,IAAI,OAAO,GAAG,CAAC,qBAAqB,KAAK,QAAQ,CAAC;YACpF,CAAC,CAAC,CAAC,SAAS,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,OAAO,IAAI,OAAO,GAAG,CAAC,OAAO,KAAK,QAAQ,IAAI,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC;IAC1J,CAAC;IAXe,4BAAO,UAWtB;AACL,CAAC,EAbS,oBAAoB,KAApB,oBAAoB,QAa7B;AAED,SAAS,iBAAiB,CAAC,OAAgB;IACvC,MAAM,MAAM,GAAyB,EAAE,CAAC;IACxC,IAAI,CAAC,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE,CAAC;QAC1C,OAAO,MAAM,CAAC;IAClB,CAAC;IACD,KAAK,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC;QAClD,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,oBAAoB,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;YAClE,MAAM,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;QACzB,CAAC;IACL,CAAC;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAGM,IAAM,kCAAkC,GAAxC,MAAM,kCAAkC;IAAxC;QAWO,gBAAW,GAAsC,IAAI,GAAG,EAAE,CAAC;IA6GzE,CAAC;IA3GG,OAAO;QACH,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE;YACnC,MAAM,OAAO,GAAG,iBAAiB,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,CACxD,kCAAgB,EAChB,EAAE,CACL,CAAC,CAAC;YACH,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;YAC9C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACnC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAExC,IAAI,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,KAAK,CAAC,EAAE;gBAC/C,IAAI,KAAK,CAAC,cAAc,KAAK,kCAAgB,EAAE,CAAC;oBAC5C,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAChE,CAAC;YACL,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,kBAAkB,CAAC,iCAAiC,EAAE,CAAC;IAChE,CAAC;IAES,KAAK,CAAC,gBAAgB,CAAC,OAA0C;QACvE,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,EAAE,CAAC;QACzE,KAAK,MAAM,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,OAAO,EAAE,CAAC;YACvC,IAAI,UAAU,IAAI,UAAU,CAAC,SAAS,EAAE,CAAC;gBACrC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC;oBACjC,MAAM,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBACpD,CAAC;YACL,CAAC;QACL,CAAC;IACL,CAAC;IAES,mBAAmB,CAAC,UAAgC;QAC1D,MAAM,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC;QACpC,MAAM,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;QAErD,KAAK,MAAM,CAAC,IAAI,CAAC,IAAI,UAAU,EAAE,CAAC;YAC9B,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;gBAC5B,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC;QACL,CAAC;QAED,KAAK,MAAM,CAAC,IAAI,EAAE,WAAW,CAAC,IAAI,cAAc,EAAE,CAAC;YAC/C,MAAM,cAAc,GAAG,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YAC5C,IAAI,IAAI,GAAG,KAAK,CAAC;YACjB,IAAI,CAAC;gBACD,2FAA2F;gBAC3F,IAAI,CAAC,cAAc,IAAI,CAAC,sBAAe,CAAC,SAAS,CAAC,cAAuC,EAAE,WAAoC,CAAC,EAAE,CAAC;oBAC/H,IAAI,GAAG,IAAI,CAAC;gBAChB,CAAC;YACL,CAAC;YAAC,OAAO,CAAC,EAAE,CAAC;gBACT,+GAA+G;gBAC/G,iHAAiH;gBACjH,OAAO,CAAC,KAAK,CAAC,kEAAkE,EAAE,CAAC,CAAC,CAAC;gBACrF,IAAI,GAAG,IAAI,CAAC;YAChB,CAAC;YACD,IAAI,IAAI,EAAE,CAAC;gBACP,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;YAChD,CAAC;QACL,CAAC;QAED,IAAI,CAAC,WAAW,GAAG,cAAc,CAAC;IACtC,CAAC;IAES,WAAW,CAAC,OAA0C;QAE5D,KAAK,MAAM,CAAC,EAAE,WAAW,CAAC,IAAI,OAAO,EAAE,CAAC;YACpC,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;QAChD,CAAC;QAED,KAAK,MAAM,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;YACpC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;gBACrB,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC;QACL,CAAC;IACL,CAAC;IAES,YAAY,CAAC,OAA6B;QAChD,MAAM,GAAG,GAAG,IAAI,GAAG,EAAgC,CAAC;QACpD,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,EAAE,WAAW,CAAC,EAAE,EAAE;YACpD,IAAI,mBAAyC,CAAC;YAE9C,IAAI,WAAW,IAAI,WAAW,EAAE,CAAC;gBAC7B,+EAA+E;gBAC/E,MAAM,EAAE,SAAS,EAAE,eAAe,EAAE,qBAAqB,EAAE,OAAO,EAAE,SAAS,EAAE,GAAG,WAAW,CAAC;gBAC9F,mBAAmB,GAAG;oBAClB,IAAI;oBACJ,SAAS;oBACT,GAAG,CAAC,eAAe,IAAI,EAAE,eAAe,EAAE,CAAC;oBAC3C,GAAG,CAAC,qBAAqB,IAAI,EAAE,qBAAqB,EAAE,CAAC;oBACvD,GAAG,CAAC,OAAO,IAAI,EAAE,OAAO,EAAE,CAAC;oBAC3B,SAAS,EAAE,SAAS,aAAT,SAAS,cAAT,SAAS,GAAI,IAAI;iBAC/B,CAAC;YACN,CAAC;iBAAM,CAAC;gBACJ,6EAA6E;gBAC7E,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,SAAS,EAAE,GAAG,WAAW,CAAC;gBACtD,mBAAmB,GAAG;oBAClB,IAAI;oBACJ,OAAO;oBACP,GAAG,CAAC,IAAI,IAAI,EAAE,IAAI,EAAE,CAAC;oBACrB,GAAG,CAAC,GAAG,IAAI,EAAE,GAAG,EAAE,CAAC;oBACnB,SAAS,EAAE,SAAS,aAAT,SAAS,cAAT,SAAS,GAAI,IAAI;iBAC/B,CAAC;YACN,CAAC;YAED,GAAG,CAAC,GAAG,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QACH,OAAO,GAAG,CAAC;IACf,CAAC;CACJ;AAxHY,gFAAkC;AAGjC;IADT,sBAAM,EAAC,wBAAiB,CAAC;;6EACqB;AAGrC;IADT,sBAAM,EAAC,yBAAgB,CAAC;;mEACW;AAG1B;IADT,sBAAM,EAAC,uCAAkB,CAAC;;8EACsB;6CATxC,kCAAkC;IAD9C,0BAAU,GAAE;GACA,kCAAkC,CAwH9C;;;;;;;;;;;;ACpMD,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;AAEhF,wIAA+D;AAC/D,4HAA+H;AAC/H,0JAKsC;AACtC,4MAA6F;AAC7F,yJAAgE;AAChE,gMAAyF;AACzF,6LAAsF;AACtF,wIAA0H;AAE1H,qBAAe,IAAI,2BAAe,CAAC,IAAI,CAAC,EAAE;IACtC,IAAI,CAAC,yCAA+B,CAAC,CAAC,EAAE,CAAC,0EAAkC,CAAC,CAAC,gBAAgB,EAAE,CAAC;IAChG,IAAI,CAAC,uCAAkB,CAAC,CAAC,EAAE,CAAC,6CAAsB,CAAC,CAAC,gBAAgB,EAAE,CAAC;IACvE,IAAI,CAAC,mDAA8B,CAAC,CAAC,EAAE,CAAC,sEAAkC,CAAC,CAAC,gBAAgB,EAAE,CAAC;IAC/F,IAAI,CAAC,2CAA4B,CAAC,CAAC,EAAE,CAAC,mEAAgC,CAAC,CAAC,gBAAgB,EAAE,CAAC;IAE3F,IAAI,CAAC,qCAAsB,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;QAC9C,MAAM,UAAU,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAA4B,kCAAwB,CAAC,CAAC;QAC1F,MAAM,MAAM,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAA+B,2CAA4B,CAAC,CAAC;QAC7F,OAAO,UAAU,CAAC,WAAW,CAAyB,yCAA0B,EAAE,MAAM,CAAC,CAAC;IAC9F,CAAC,CAAC,CAAC,gBAAgB,EAAE,CAAC;IAEtB,IAAI,CAAC,qCAAgB,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;QACxC,MAAM,SAAS,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAAyB,qCAAsB,CAAC,CAAC;QACpF,MAAM,UAAU,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAA4B,kCAAwB,CAAC,CAAC;QAC1F,MAAM,MAAM,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAAiC,mDAA8B,CAAC,CAAC;QACjG,MAAM,YAAY,GAAG,GAAG,CAAC,SAAS,CAAC,GAAG,CAA+B,2CAA4B,CAAC,CAAC;QACnG,MAAM,oBAAoB,GAAG,UAAU,CAAC,WAAW,CAAmB,yCAAoB,EAAE,MAAM,CAAC,CAAC;QAEpG,uDAAuD;QACvD,MAAM,CAAC,qBAAqB,CAAC,GAAG,EAAE,CAC9B,oBAAoB,CAAC,cAAc,EAAE;aAChC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;aAC/C,KAAK,CAAC,CAAC,KAAc,EAAE,EAAE;YACtB,OAAO,CAAC,KAAK,CAAC,qCAAqC,EAAE,KAAK,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC,CAAC;QAEZ,uFAAuF;QACvF,wEAAwE;QACxE,OAAO,IAAI,KAAK,CAAC,oBAAoB,EAAE;YACnC,GAAG,CAAC,MAAwB,EAAE,IAAiB,EAAE,QAAiB;gBAC9D,mGAAmG;gBACnG,2EAA2E;gBAC3E,IAAI,IAAI,KAAK,mBAAmB,EAAE,CAAC;oBAC/B,OAAO,KAAK,WAAmC,GAAG,IAA+E;wBAC7H,MAAM,OAAO,GAAG,YAAY,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;wBAC3D,MAAM,SAAS,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;oBAC/C,CAAC,CAAC;gBACN,CAAC;gBACD,+EAA+E;gBAC/E,IAAI,IAAI,KAAK,sBAAsB,EAAE,CAAC;oBAClC,OAAO,KAAK,WAAmC,IAAY;wBACvD,MAAM,WAAW,GAAG,MAAM,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,oBAAoB,EAAE,MAAM,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;wBACrF,IAAI,WAAW,EAAE,CAAC;4BACd,MAAM,eAAe,GAAG,YAAY,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC;4BAC9D,IAAI,eAAe,EAAE,CAAC;gCAClB,OAAO;oCACH,GAAG,WAAW;oCACd,OAAO,EAAE,eAAe;iCAC3B,CAAC;4BACN,CAAC;wBACL,CAAC;wBACD,OAAO,WAAW,CAAC;oBACvB,CAAC,CAAC;gBACN,CAAC;gBACD,OAAO,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;YAC/C,CAAC;SACJ,CAAC,CAAC;IACP,CAAC,CAAC,CAAC,gBAAgB,EAAE,CAAC;AAC1B,CAAC,CAAC,CAAC;;;;;;;;;;;;ACzFH,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;;AAEhF,wIAA0D;AAE1D,8HAA8D;AAGvD,IAAM,kCAAkC,GAAxC,MAAM,kCAAkC;IAAxC;QACgB,iCAA4B,GAAG,IAAI,eAAO,EAAQ,CAAC;QACtD,0BAAqB,GAAgB,IAAI,CAAC,4BAA4B,CAAC,KAAK,CAAC;IAKjG,CAAC;IAHG,mBAAmB;QACf,IAAI,CAAC,4BAA4B,CAAC,IAAI,EAAE,CAAC;IAC7C,CAAC;CACJ;AAPY,gFAAkC;6CAAlC,kCAAkC;IAD9C,0BAAU,GAAE;GACA,kCAAkC,CAO9C;;;;;;;;;;;;;;;AC5BD,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;AAChF,wIAAkE;AAClE,0JAA0G;AAC1G,qHAA4H;AAIrH,IAAM,sBAAsB,GAA5B,MAAM,sBAAsB;IAW/B,KAAK,CAAC,WAAW,CAAC,UAAkB;QAChC,MAAM,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;QACpD,MAAM,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;IACzC,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,UAAkB;QAC9B,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;QAChD,OAAO,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IAC5C,CAAC;IAED,KAAK,CAAC,eAAe,CAAC,UAAkB;QACpC,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACtD,OAAO,cAAc,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IAC/C,CAAC;IAED,KAAK,CAAC,iCAAiC;QACnC,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACtD,KAAK,MAAM,UAAU,IAAI,cAAc,EAAE,CAAC;YACtC,MAAM,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;QACzC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,aAAa,CAAC,UAAkB;QAClC,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QACtD,IAAI,aAAa,EAAE,CAAC;YAChB,MAAM,YAAY,GAAkB,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC;YACjH,YAAY,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,CAC/B,IAAI,CAAC,sBAAsB,CAAC,YAAY,CAAC,WAAW,CAAC,CACxD,CAAC;YAEF,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,YAAY,CAAC,CAAC;QACxD,CAAC;IACL,CAAC;IAED,mBAAmB,CAAC,UAAkB;QAClC,OAAO,OAAO,UAAU,QAAQ,CAAC;IACrC,CAAC;IAES,oBAAoB,CAAC,UAAkB,EAAE,YAA2B;QAC1E,MAAM,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,CAAC;QACxD,MAAM,WAAW,GAAG,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;QAC9D,MAAM,QAAQ,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAExC,IAAI,CAAC,aAAa,CAAC,wBAAwB,CAAC;YACxC,EAAE,EAAE,UAAU;YACd,QAAQ;SACX,CAAC,CAAC;IACP,CAAC;IAED,KAAK,CAAC,UAAU,CAAC,UAAkB;QAC/B,IAAI,CAAC,sBAAsB,CAAC,kBAAkB,CAAC,OAAO,UAAU,EAAE,CAAC,CAAC;QACpE,IAAI,CAAC,aAAa,CAAC,oBAAoB,CAAC,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,CAAC,CAAC;QAC9E,MAAM,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;IACvD,CAAC;IAED,iBAAiB;QACb,OAAO,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,CAAC;IACrD,CAAC;IAED,cAAc;QACV,OAAO,IAAI,CAAC,gBAAgB,CAAC,cAAc,EAAE,CAAC;IAClD,CAAC;IAED,KAAK,CAAC,oBAAoB,CAAC,IAAY;QACnC,OAAO,IAAI,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;IAC5D,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,UAAkB;QAC7B,IAAI,CAAC;YACD,OAAO,MAAM,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAC5D,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACb,OAAO,CAAC,KAAK,CAAC,mCAAmC,GAAG,KAAK,CAAC,CAAC;YAC3D,OAAO,SAAS,CAAC;QACrB,CAAC;IACL,CAAC;IAED,KAAK,CAAC,iBAAiB,CAAC,WAAiC;QACrD,OAAO,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;IAChE,CAAC;IAEO,oBAAoB,CAAC,IAAwE,EAAE,UAAkB;QACrH,MAAM,EAAE,GAAG,OAAO,UAAU,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;QAC5C,OAAO;YACH,EAAE,EAAE,EAAE;YACN,IAAI,EAAE,EAAE;YACR,YAAY,EAAE,OAAO,UAAU,EAAE;YACjC,UAAU,EAAE,qBAAW,CAAC,uBAAuB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBAChE,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI;gBAC3B,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,UAAU;gBACvC,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,QAAQ;aACtC,CAAC,CAAC,CAAC;gBACA,IAAI,EAAE,QAAQ;gBACd,UAAU,EAAE,EAAE;aACjB;YACD,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,OAAO,EAAE,KAAK,EAAE,UAAkB,EAA4B,EAAE;;gBAC5D,IAAI,CAAC;oBACD,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;oBACvF,IAAI,MAAM,CAAC,OAAO,EAAE,CAAC;wBACjB,MAAM,WAAW,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,WAAW,CAAC,IAAI,KAAK,MAAM,CAA4B,CAAC;wBAC/G,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,iBAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,IAAI,mCAAI,eAAe,EAAE,CAAC,EAAE,CAAC;oBACxF,CAAC;oBACD,MAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,CAAwB,WAAW,CAAC,EAAE;wBACpE,QAAQ,WAAW,CAAC,IAAI,EAAE,CAAC;4BACvB,KAAK,OAAO;gCACR,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,WAAW,CAAC,IAAI,EAAE,QAAQ,EAAE,WAAW,CAAC,QAAQ,EAAE,CAAC;4BAC3F,KAAK,MAAM;gCACP,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,WAAW,CAAC,IAAI,EAAE,CAAC;4BACpD,KAAK,UAAU,CAAC,CAAC,CAAC;gCACd,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC;4BACxE,CAAC;4BACD,OAAO,CAAC,CAAC,CAAC;gCACN,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC;4BAC/D,CAAC;wBACL,CAAC;oBACL,CAAC,CAAC,CAAC;oBACH,OAAO,EAAE,OAAO,EAAE,CAAC;gBACvB,CAAC;gBAAC,OAAO,KAAK,EAAE,CAAC;oBACb,OAAO,CAAC,KAAK,CAAC,6BAA6B,IAAI,CAAC,IAAI,kBAAkB,UAAU,GAAG,EAAE,KAAK,CAAC,CAAC;oBAC5F,MAAM,KAAK,CAAC;gBAChB,CAAC;YACL,CAAC;SACJ,CAAC;IACN,CAAC;CACJ;AAvIY,wDAAsB;AAGZ;IADlB,sBAAM,EAAC,qCAAgB,CAAC;;gEAC6B;AAGnC;IADlB,sBAAM,EAAC,gCAAsB,CAAC;;sEACmC;AAG/C;IADlB,sBAAM,EAAC,uBAAa,CAAC;;6DAC0B;iCATvC,sBAAsB;IADlC,0BAAU,GAAE;GACA,sBAAsB,CAuIlC;;;;;;;;;;;;AC5JD,gFAAgF;AAChF,4CAA4C;AAC5C,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;;AAEhF,wIAA0D;AAE1D,2HAA2D;AAC3D,wIAAuH;AAKhH,IAAM,gCAAgC,GAAtC,MAAM,gCAAgC;IAAtC;QAEO,uBAAkB,GAAkC,IAAI,GAAG,EAAE,CAAC;IAuD5E,CAAC;IArDG,oBAAoB,CAAC,WAAiC;QAClD,IAAI,WAAW,CAAC,OAAO,EAAE,CAAC;YACtB,MAAM,iBAAiB,GAA4B;gBAC/C,GAAG,WAAW;gBACd,SAAS,EAAE,uBAAY,GAAE;aAC5B,CAAC;YAEF,2CAA2C;YAC3C,IAAI,iBAAiB,CAAC,SAAS,EAAE,CAAC;gBAC9B,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,iBAAiB,CAAC,SAAS,EAAE;oBACrD,IAAI,EAAE,WAAW,CAAC,IAAI;oBACtB,OAAO,EAAE,WAAW,CAAC,OAAO;iBAC/B,CAAC,CAAC;YACP,CAAC;YAED,OAAO,iBAAiB,CAAC;QAC7B,CAAC;QACD,OAAO,WAAW,CAAC;IACvB,CAAC;IAED,kBAAkB,CAAC,IAAY;QAC3B,KAAK,MAAM,UAAU,IAAI,IAAI,CAAC,kBAAkB,CAAC,MAAM,EAAE,EAAE,CAAC;YACxD,IAAI,UAAU,CAAC,IAAI,KAAK,IAAI,EAAE,CAAC;gBAC3B,OAAO,UAAU,CAAC,OAAO,CAAC;YAC9B,CAAC;QACL,CAAC;QACD,OAAO,SAAS,CAAC;IACrB,CAAC;IAED,KAAK,CAAC,wBAAwB,CAAC,WAAoC;QAC/D,MAAM,gBAAgB,GAAG,yCAAsB,EAAC,WAAW,CAAC,CAAC;QAC7D,IAAI,WAAW,CAAC,SAAS,EAAE,CAAC;YACxB,MAAM,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;YACtE,IAAI,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,OAAO,EAAE,CAAC;gBACtB,MAAM,OAAO,GAAG,MAAM,UAAU,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;gBAC3D,IAAI,OAAO,EAAE,CAAC;oBACV,OAAO,OAAO,CAAC;gBACnB,CAAC;YACL,CAAC;QACL,CAAC;QACD,OAAO,gBAAgB,CAAC;IAC5B,CAAC;IAED,YAAY,CAAC,WAAqB;QAC9B,MAAM,eAAe,GAAG,IAAI,GAAG,CAAC,WAAW,CAAC,CAAC;QAC7C,uDAAuD;QACvD,KAAK,MAAM,CAAC,SAAS,EAAE,UAAU,CAAC,IAAI,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,EAAE,CAAC;YACtE,IAAI,UAAU,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC;gBAC3D,OAAO,CAAC,KAAK,CAAC,8FAA8F,EAAE,UAAU,CAAC,CAAC;gBAC1H,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;YAC9C,CAAC;QACL,CAAC;IACL,CAAC;CACJ;AAzDY,4EAAgC;2CAAhC,gCAAgC;IAD5C,0BAAU,GAAE;GACA,gCAAgC,CAyD5C;;;;;;;;;;;;;;ACjFD,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;AAChF,oJAAqC;;;;;;;;;;;;ACfrC,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;AAEhF,4GAAoD;AAEvC,wBAAgB,GAAG,4BAA4B,CAAC;AAEhD,kCAA0B,GAAqB;IACxD,UAAU,EAAE;QACR,CAAC,wBAAgB,CAAC,EAAE;YAChB,IAAI,EAAE,QAAQ;YACd,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,4BAA4B,EAAE,0BAA0B,CAAC;YAC7E,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,oCAAoC,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAiC7E,CAAC;YACI,oBAAoB,EAAE;gBAClB,IAAI,EAAE,QAAQ;gBACd,UAAU,EAAE;oBACR,OAAO,EAAE;wBACL,IAAI,EAAE,QAAQ;wBACd,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,oCAAoC,EAAE,mCAAmC,CAAC;wBAC9F,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,4CAA4C,EAAE,iEAAiE,CAAC;qBACrJ;oBACD,IAAI,EAAE;wBACF,IAAI,EAAE,OAAO;wBACb,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,iCAAiC,EAAE,2BAA2B,CAAC;wBACnF,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,yCAAyC,EAAE,+CAA+C,CAAC;qBAChI;oBACD,GAAG,EAAE;wBACD,IAAI,EAAE,QAAQ;wBACd,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,gCAAgC,EAAE,uBAAuB,CAAC;wBAC9E,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,wCAAwC,EAAE,2EAA2E,CAAC;wBACxJ,oBAAoB,EAAE;4BAClB,IAAI,EAAE,QAAQ;yBACjB;qBACJ;oBACD,SAAS,EAAE;wBACP,IAAI,EAAE,SAAS;wBACf,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,sCAAsC,EAAE,WAAW,CAAC;wBACxE,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,8CAA8C,EAC5E,gIAAgI,CAAC;wBACrI,OAAO,EAAE,IAAI;qBAChB;oBACD,SAAS,EAAE;wBACP,IAAI,EAAE,QAAQ;wBACd,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,sCAAsC,EAAE,YAAY,CAAC;wBACzE,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,8CAA8C,EAC5E,yHAAyH,CAAC;qBACjI;oBACD,eAAe,EAAE;wBACb,IAAI,EAAE,QAAQ;wBACd,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,4CAA4C,EAAE,sBAAsB,CAAC;wBACzF,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,oDAAoD,EAClF,4GAA4G,CAAC;qBACpH;oBACD,qBAAqB,EAAE;wBACnB,IAAI,EAAE,QAAQ;wBACd,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,kDAAkD,EAAE,4BAA4B,CAAC;wBACrG,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,0DAA0D,EACxF,0HAA0H,CAAC;qBAClI;oBACD,OAAO,EAAE;wBACL,IAAI,EAAE,QAAQ;wBACd,KAAK,EAAE,UAAG,CAAC,QAAQ,CAAC,oCAAoC,EAAE,SAAS,CAAC;wBACpE,mBAAmB,EAAE,UAAG,CAAC,QAAQ,CAAC,4CAA4C,EAC1E,uEAAuE,CAAC;qBAC/E;iBACJ;gBACD,QAAQ,EAAE,EAAE;aACf;SACJ;KACJ;CACJ,CAAC;;;;;;;;;;;;ACpHF,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;AAanE,8BAAsB,GAAG,MAAM,CAAC,wBAAwB,CAAC,CAAC;AAC1D,kCAA0B,GAAG,kCAAkC,CAAC;AAUhE,oCAA4B,GAAG,MAAM,CAAC,8BAA8B,CAAC,CAAC;AA8BnF;;GAEG;AACI,MAAM,sBAAsB,GAAG,CAAC,WAAoC,EAAwB,EAAE;IACjG,MAAM,EAAE,SAAS,EAAE,GAAG,qBAAqB,EAAE,GAAG,WAAW,CAAC;IAC5D,OAAO,EAAE,GAAG,qBAAqB,EAA0B,CAAC;AAChE,CAAC,CAAC;AAHW,8BAAsB,0BAGjC;;;;;;;;;;;;AC1EF,gFAAgF;AAChF,yCAAyC;AACzC,EAAE;AACF,2EAA2E;AAC3E,mEAAmE;AACnE,wCAAwC;AACxC,EAAE;AACF,4EAA4E;AAC5E,8EAA8E;AAC9E,6EAA6E;AAC7E,yDAAyD;AACzD,uDAAuD;AACvD,EAAE;AACF,gFAAgF;AAChF,gFAAgF;;;AAKnE,0BAAkB,GAAG,MAAM,CAAC,oBAAoB,CAAC,CAAC;AAelD,sCAA8B,GAAG,MAAM,CAAC,gCAAgC,CAAC,CAAC;AAmCvF,IAAY,eAQX;AARD,WAAY,eAAe;IACvB,6CAA0B;IAC1B,iDAA8B;IAC9B,wCAAqB;IACrB,4CAAyB;IACzB,sCAAmB;IACnB,0CAAuB;IACvB,sCAAmB;AACvB,CAAC,EARW,eAAe,+BAAf,eAAe,QAQ1B;AAiFD,SAAgB,2BAA2B,CAAC,WAAiC;IACzE,OAAQ,WAAyC,CAAC,OAAO,KAAK,SAAS,CAAC;AAC5E,CAAC;AAFD,kEAEC;AACD,SAAgB,4BAA4B,CAAC,WAAiC;IAC1E,OAAQ,WAA0C,CAAC,SAAS,KAAK,SAAS,CAAC;AAC/E,CAAC;AAFD,oEAEC;AAEY,wBAAgB,GAAG,MAAM,CAAC,kBAAkB,CAAC,CAAC;AAC9C,4BAAoB,GAAG,4BAA4B,CAAC;;;;;;;;;;;ACtKpD;;AAEb;;;;AAIA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,UAAU;AAC/B;;AAEA,qBAAqB,UAAU;AAC/B;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA","sources":["webpack:///../../node_modules/@theia/ai-mcp/src/browser/mcp-frontend-application-contribution.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/browser/mcp-frontend-module.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/browser/mcp-frontend-notification-service.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/browser/mcp-frontend-service.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/browser/mcp-server-manager-server-client.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/common/index.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/common/mcp-preferences.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/common/mcp-protocol.ts?","webpack:///../../node_modules/@theia/ai-mcp/src/common/mcp-server-manager.ts?","webpack:///../../node_modules/fast-deep-equal/index.js?"],"sourcesContent":["// *****************************************************************************\n// Copyright (C) 2024 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { FrontendApplicationContribution } from '@theia/core/lib/browser';\nimport { inject, injectable } from '@theia/core/shared/inversify';\nimport { MCPServerDescription, MCPServerManager } from '../common';\nimport { MCP_SERVERS_PREF } from '../common/mcp-preferences';\nimport { JSONObject } from '@theia/core/shared/@lumino/coreutils';\nimport { MCPFrontendService } from '../common/mcp-server-manager';\nimport { PreferenceService, PreferenceUtils } from '@theia/core';\n\ninterface BaseMCPServerPreferenceValue {\n    autostart?: boolean;\n}\n\ninterface LocalMCPServerPreferenceValue extends BaseMCPServerPreferenceValue {\n    command: string;\n    args?: string[];\n    env?: { [key: string]: string };\n}\n\ninterface RemoteMCPServerPreferenceValue extends BaseMCPServerPreferenceValue {\n    serverUrl: string;\n    serverAuthToken?: string;\n    serverAuthTokenHeader?: string;\n    headers?: { [key: string]: string };\n}\n\ntype MCPServersPreferenceValue = LocalMCPServerPreferenceValue | RemoteMCPServerPreferenceValue;\n\ninterface MCPServersPreference {\n    [name: string]: MCPServersPreferenceValue\n};\n\nnamespace MCPServersPreference {\n    export function isValue(obj: unknown): obj is MCPServersPreferenceValue {\n        return !!obj && typeof obj === 'object' &&\n            ('command' in obj || 'serverUrl' in obj) &&\n            (!('command' in obj) || typeof obj.command === 'string') &&\n            (!('args' in obj) || Array.isArray(obj.args) && obj.args.every(arg => typeof arg === 'string')) &&\n            (!('env' in obj) || !!obj.env && typeof obj.env === 'object' && Object.values(obj.env).every(value => typeof value === 'string')) &&\n            (!('autostart' in obj) || typeof obj.autostart === 'boolean') &&\n            (!('serverUrl' in obj) || typeof obj.serverUrl === 'string') &&\n            (!('serverAuthToken' in obj) || typeof obj.serverAuthToken === 'string') &&\n            (!('serverAuthTokenHeader' in obj) || typeof obj.serverAuthTokenHeader === 'string') &&\n            (!('headers' in obj) || !!obj.headers && typeof obj.headers === 'object' && Object.values(obj.headers).every(value => typeof value === 'string'));\n    }\n}\n\nfunction filterValidValues(servers: unknown): MCPServersPreference {\n    const result: MCPServersPreference = {};\n    if (!servers || typeof servers !== 'object') {\n        return result;\n    }\n    for (const [name, value] of Object.entries(servers)) {\n        if (typeof name === 'string' && MCPServersPreference.isValue(value)) {\n            result[name] = value;\n        }\n    }\n    return result;\n}\n\n@injectable()\nexport class McpFrontendApplicationContribution implements FrontendApplicationContribution {\n\n    @inject(PreferenceService)\n    protected preferenceService: PreferenceService;\n\n    @inject(MCPServerManager)\n    protected manager: MCPServerManager;\n\n    @inject(MCPFrontendService)\n    protected frontendMCPService: MCPFrontendService;\n\n    protected prevServers: Map<string, MCPServerDescription> = new Map();\n\n    onStart(): void {\n        this.preferenceService.ready.then(() => {\n            const servers = filterValidValues(this.preferenceService.get(\n                MCP_SERVERS_PREF,\n                {}\n            ));\n            this.prevServers = this.convertToMap(servers);\n            this.syncServers(this.prevServers);\n            this.autoStartServers(this.prevServers);\n\n            this.preferenceService.onPreferenceChanged(event => {\n                if (event.preferenceName === MCP_SERVERS_PREF) {\n                    this.handleServerChanges(filterValidValues(event.newValue));\n                }\n            });\n        });\n        this.frontendMCPService.registerToolsForAllStartedServers();\n    }\n\n    protected async autoStartServers(servers: Map<string, MCPServerDescription>): Promise<void> {\n        const startedServers = await this.frontendMCPService.getStartedServers();\n        for (const [name, serverDesc] of servers) {\n            if (serverDesc && serverDesc.autostart) {\n                if (!startedServers.includes(name)) {\n                    await this.frontendMCPService.startServer(name);\n                }\n            }\n        }\n    }\n\n    protected handleServerChanges(newServers: MCPServersPreference): void {\n        const oldServers = this.prevServers;\n        const updatedServers = this.convertToMap(newServers);\n\n        for (const [name] of oldServers) {\n            if (!updatedServers.has(name)) {\n                this.manager.removeServer(name);\n            }\n        }\n\n        for (const [name, description] of updatedServers) {\n            const oldDescription = oldServers.get(name);\n            let diff = false;\n            try {\n                // We know that that the descriptions are actual JSONObjects as we construct them ourselves\n                if (!oldDescription || !PreferenceUtils.deepEqual(oldDescription as unknown as JSONObject, description as unknown as JSONObject)) {\n                    diff = true;\n                }\n            } catch (e) {\n                // In some cases the deepEqual function throws an error, so we fall back to assuming that there is a difference\n                // This seems to happen in cases where the objects are structured differently, e.g. whole sub-objects are missing\n                console.debug('Failed to compare MCP server descriptions, assuming a difference', e);\n                diff = true;\n            }\n            if (diff) {\n                this.manager.addOrUpdateServer(description);\n            }\n        }\n\n        this.prevServers = updatedServers;\n    }\n\n    protected syncServers(servers: Map<string, MCPServerDescription>): void {\n\n        for (const [, description] of servers) {\n            this.manager.addOrUpdateServer(description);\n        }\n\n        for (const [name] of this.prevServers) {\n            if (!servers.has(name)) {\n                this.manager.removeServer(name);\n            }\n        }\n    }\n\n    protected convertToMap(servers: MCPServersPreference): Map<string, MCPServerDescription> {\n        const map = new Map<string, MCPServerDescription>();\n        Object.entries(servers).forEach(([name, description]) => {\n            let filteredDescription: MCPServerDescription;\n\n            if ('serverUrl' in description) {\n                // Create RemoteMCPServerDescription by picking only remote-specific properties\n                const { serverUrl, serverAuthToken, serverAuthTokenHeader, headers, autostart } = description;\n                filteredDescription = {\n                    name,\n                    serverUrl,\n                    ...(serverAuthToken && { serverAuthToken }),\n                    ...(serverAuthTokenHeader && { serverAuthTokenHeader }),\n                    ...(headers && { headers }),\n                    autostart: autostart ?? true,\n                };\n            } else {\n                // Create LocalMCPServerDescription by picking only local-specific properties\n                const { command, args, env, autostart } = description;\n                filteredDescription = {\n                    name,\n                    command,\n                    ...(args && { args }),\n                    ...(env && { env }),\n                    autostart: autostart ?? true,\n                };\n            }\n\n            map.set(name, filteredDescription);\n        });\n        return map;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { ContainerModule } from '@theia/core/shared/inversify';\nimport { FrontendApplicationContribution, RemoteConnectionProvider, ServiceConnectionProvider } from '@theia/core/lib/browser';\nimport {\n    MCPFrontendService,\n    MCPServerManager,\n    MCPServerManagerPath,\n    MCPFrontendNotificationService\n} from '../common/mcp-server-manager';\nimport { McpFrontendApplicationContribution } from './mcp-frontend-application-contribution';\nimport { MCPFrontendServiceImpl } from './mcp-frontend-service';\nimport { MCPFrontendNotificationServiceImpl } from './mcp-frontend-notification-service';\nimport { MCPServerManagerServerClientImpl } from './mcp-server-manager-server-client';\nimport { MCPServerManagerServer, MCPServerManagerServerClient, MCPServerManagerServerPath } from '../common/mcp-protocol';\n\nexport default new ContainerModule(bind => {\n    bind(FrontendApplicationContribution).to(McpFrontendApplicationContribution).inSingletonScope();\n    bind(MCPFrontendService).to(MCPFrontendServiceImpl).inSingletonScope();\n    bind(MCPFrontendNotificationService).to(MCPFrontendNotificationServiceImpl).inSingletonScope();\n    bind(MCPServerManagerServerClient).to(MCPServerManagerServerClientImpl).inSingletonScope();\n\n    bind(MCPServerManagerServer).toDynamicValue(ctx => {\n        const connection = ctx.container.get<ServiceConnectionProvider>(RemoteConnectionProvider);\n        const client = ctx.container.get<MCPServerManagerServerClient>(MCPServerManagerServerClient);\n        return connection.createProxy<MCPServerManagerServer>(MCPServerManagerServerPath, client);\n    }).inSingletonScope();\n\n    bind(MCPServerManager).toDynamicValue(ctx => {\n        const mgrServer = ctx.container.get<MCPServerManagerServer>(MCPServerManagerServer);\n        const connection = ctx.container.get<ServiceConnectionProvider>(RemoteConnectionProvider);\n        const client = ctx.container.get<MCPFrontendNotificationService>(MCPFrontendNotificationService);\n        const serverClient = ctx.container.get<MCPServerManagerServerClient>(MCPServerManagerServerClient);\n        const backendServerManager = connection.createProxy<MCPServerManager>(MCPServerManagerPath, client);\n\n        // Listen to server updates to clean up removed servers\n        client.onDidUpdateMCPServers(() =>\n            backendServerManager.getServerNames()\n                .then(names => serverClient.cleanServers(names))\n                .catch((error: unknown) => {\n                    console.error('Error cleaning server descriptions:', error);\n                }));\n\n        // We proxy the MCPServerManager to override addOrUpdateServer and getServerDescription\n        // to handle the resolve functions via the MCPServerManagerServerClient.\n        return new Proxy(backendServerManager, {\n            get(target: MCPServerManager, prop: PropertyKey, receiver: unknown): unknown {\n                // override addOrUpdateServer to store the original description in the MCPServerManagerServerClient\n                // to be used in resolveServerDescription if a resolve function is provided\n                if (prop === 'addOrUpdateServer') {\n                    return async function (this: MCPServerManager, ...args: [serverDescription: Parameters<MCPServerManager['addOrUpdateServer']>[0]]): Promise<void> {\n                        const updated = serverClient.addServerDescription(args[0]);\n                        await mgrServer.addOrUpdateServer(updated);\n                    };\n                }\n                // override getServerDescription to mix in the resolve function from the client\n                if (prop === 'getServerDescription') {\n                    return async function (this: MCPServerManager, name: string): ReturnType<MCPServerManager['getServerDescription']> {\n                        const description = await Reflect.apply(target.getServerDescription, target, [name]);\n                        if (description) {\n                            const resolveFunction = serverClient.getResolveFunction(name);\n                            if (resolveFunction) {\n                                return {\n                                    ...description,\n                                    resolve: resolveFunction\n                                };\n                            }\n                        }\n                        return description;\n                    };\n                }\n                return Reflect.get(target, prop, receiver);\n            }\n        });\n    }).inSingletonScope();\n});\n","// *****************************************************************************\n// Copyright (C) 2025 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable } from '@theia/core/shared/inversify';\nimport { MCPFrontendNotificationService } from '../common';\nimport { Emitter, Event } from '@theia/core/lib/common/event';\n\n@injectable()\nexport class MCPFrontendNotificationServiceImpl implements MCPFrontendNotificationService {\n    protected readonly onDidUpdateMCPServersEmitter = new Emitter<void>();\n    public readonly onDidUpdateMCPServers: Event<void> = this.onDidUpdateMCPServersEmitter.event;\n\n    didUpdateMCPServers(): void {\n        this.onDidUpdateMCPServersEmitter.fire();\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nimport { injectable, inject } from '@theia/core/shared/inversify';\nimport { MCPFrontendService, MCPServerDescription, MCPServerManager } from '../common/mcp-server-manager';\nimport { ToolInvocationRegistry, ToolRequest, PromptService, ToolCallContent, ToolCallContentResult } from '@theia/ai-core';\nimport { ListToolsResult, TextContent } from '@modelcontextprotocol/sdk/types';\n\n@injectable()\nexport class MCPFrontendServiceImpl implements MCPFrontendService {\n\n    @inject(MCPServerManager)\n    protected readonly mcpServerManager: MCPServerManager;\n\n    @inject(ToolInvocationRegistry)\n    protected readonly toolInvocationRegistry: ToolInvocationRegistry;\n\n    @inject(PromptService)\n    protected readonly promptService: PromptService;\n\n    async startServer(serverName: string): Promise<void> {\n        await this.mcpServerManager.startServer(serverName);\n        await this.registerTools(serverName);\n    }\n\n    async hasServer(serverName: string): Promise<boolean> {\n        const serverNames = await this.getServerNames();\n        return serverNames.includes(serverName);\n    }\n\n    async isServerStarted(serverName: string): Promise<boolean> {\n        const startedServers = await this.getStartedServers();\n        return startedServers.includes(serverName);\n    }\n\n    async registerToolsForAllStartedServers(): Promise<void> {\n        const startedServers = await this.getStartedServers();\n        for (const serverName of startedServers) {\n            await this.registerTools(serverName);\n        }\n    }\n\n    async registerTools(serverName: string): Promise<void> {\n        const returnedTools = await this.getTools(serverName);\n        if (returnedTools) {\n            const toolRequests: ToolRequest[] = returnedTools.tools.map(tool => this.convertToToolRequest(tool, serverName));\n            toolRequests.forEach(toolRequest =>\n                this.toolInvocationRegistry.registerTool(toolRequest)\n            );\n\n            this.createPromptTemplate(serverName, toolRequests);\n        }\n    }\n\n    getPromptTemplateId(serverName: string): string {\n        return `mcp_${serverName}_tools`;\n    }\n\n    protected createPromptTemplate(serverName: string, toolRequests: ToolRequest[]): void {\n        const templateId = this.getPromptTemplateId(serverName);\n        const functionIds = toolRequests.map(tool => `~{${tool.id}}`);\n        const template = functionIds.join('\\n');\n\n        this.promptService.addBuiltInPromptFragment({\n            id: templateId,\n            template\n        });\n    }\n\n    async stopServer(serverName: string): Promise<void> {\n        this.toolInvocationRegistry.unregisterAllTools(`mcp_${serverName}`);\n        this.promptService.removePromptFragment(this.getPromptTemplateId(serverName));\n        await this.mcpServerManager.stopServer(serverName);\n    }\n\n    getStartedServers(): Promise<string[]> {\n        return this.mcpServerManager.getRunningServers();\n    }\n\n    getServerNames(): Promise<string[]> {\n        return this.mcpServerManager.getServerNames();\n    }\n\n    async getServerDescription(name: string): Promise<MCPServerDescription | undefined> {\n        return this.mcpServerManager.getServerDescription(name);\n    }\n\n    async getTools(serverName: string): Promise<ListToolsResult | undefined> {\n        try {\n            return await this.mcpServerManager.getTools(serverName);\n        } catch (error) {\n            console.error('Error while trying to get tools: ' + error);\n            return undefined;\n        }\n    }\n\n    async addOrUpdateServer(description: MCPServerDescription): Promise<void> {\n        return this.mcpServerManager.addOrUpdateServer(description);\n    }\n\n    private convertToToolRequest(tool: Awaited<ReturnType<MCPServerManager['getTools']>>['tools'][number], serverName: string): ToolRequest {\n        const id = `mcp_${serverName}_${tool.name}`;\n        return {\n            id: id,\n            name: id,\n            providerName: `mcp_${serverName}`,\n            parameters: ToolRequest.isToolRequestParameters(tool.inputSchema) ? {\n                type: tool.inputSchema.type,\n                properties: tool.inputSchema.properties,\n                required: tool.inputSchema.required\n            } : {\n                type: 'object',\n                properties: {}\n            },\n            description: tool.description,\n            handler: async (arg_string: string): Promise<ToolCallContent> => {\n                try {\n                    const result = await this.mcpServerManager.callTool(serverName, tool.name, arg_string);\n                    if (result.isError) {\n                        const textContent = result.content.find(callContent => callContent.type === 'text') as TextContent | undefined;\n                        return { content: [{ type: 'error', data: textContent?.text ?? 'Unknown Error' }] };\n                    }\n                    const content = result.content.map<ToolCallContentResult>(callContent => {\n                        switch (callContent.type) {\n                            case 'image':\n                                return { type: 'image', base64data: callContent.data, mimeType: callContent.mimeType };\n                            case 'text':\n                                return { type: 'text', text: callContent.text };\n                            case 'resource': {\n                                return { type: 'text', text: JSON.stringify(callContent.resource) };\n                            }\n                            default: {\n                                return { type: 'text', text: JSON.stringify(callContent) };\n                            }\n                        }\n                    });\n                    return { content };\n                } catch (error) {\n                    console.error(`Error in tool handler for ${tool.name} on MCP server ${serverName}:`, error);\n                    throw error;\n                }\n            },\n        };\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2025 Dirk Fauth and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable } from '@theia/core/shared/inversify';\nimport { MCPServerDescription } from '../common';\nimport { generateUuid } from '@theia/core/lib/common/uuid';\nimport { cleanServerDescription, MCPServerDescriptionRCP, MCPServerManagerServerClient } from '../common/mcp-protocol';\n\ntype StoredServerInfo = Pick<MCPServerDescription, 'name' | 'resolve'>;\n\n@injectable()\nexport class MCPServerManagerServerClientImpl implements MCPServerManagerServerClient {\n\n    protected serverDescriptions: Map<string, StoredServerInfo> = new Map();\n\n    addServerDescription(description: MCPServerDescription): MCPServerDescriptionRCP {\n        if (description.resolve) {\n            const serverDescription: MCPServerDescriptionRCP = {\n                ...description,\n                resolveId: generateUuid(),\n            };\n\n            // store only the name and resolve function\n            if (serverDescription.resolveId) {\n                this.serverDescriptions.set(serverDescription.resolveId, {\n                    name: description.name,\n                    resolve: description.resolve\n                });\n            }\n\n            return serverDescription;\n        }\n        return description;\n    }\n\n    getResolveFunction(name: string): MCPServerDescription['resolve'] {\n        for (const storedInfo of this.serverDescriptions.values()) {\n            if (storedInfo.name === name) {\n                return storedInfo.resolve;\n            }\n        }\n        return undefined;\n    }\n\n    async resolveServerDescription(description: MCPServerDescriptionRCP): Promise<MCPServerDescription> {\n        const cleanDescription = cleanServerDescription(description);\n        if (description.resolveId) {\n            const storedInfo = this.serverDescriptions.get(description.resolveId);\n            if (storedInfo?.resolve) {\n                const updated = await storedInfo.resolve(cleanDescription);\n                if (updated) {\n                    return updated;\n                }\n            }\n        }\n        return cleanDescription;\n    }\n\n    cleanServers(serverNames: string[]): void {\n        const currentNamesSet = new Set(serverNames);\n        // Remove descriptions for servers that no longer exist\n        for (const [resolveId, storedInfo] of this.serverDescriptions.entries()) {\n            if (storedInfo.name && !currentNamesSet.has(storedInfo.name)) {\n                console.debug('Removing a frontend stored resolve function because the corresponding MCP server was removed', storedInfo);\n                this.serverDescriptions.delete(resolveId);\n            }\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2024 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\nexport * from './mcp-server-manager';\n","// *****************************************************************************\n// Copyright (C) 2024 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { nls, PreferenceSchema } from '@theia/core';\n\nexport const MCP_SERVERS_PREF = 'ai-features.mcp.mcpServers';\n\nexport const McpServersPreferenceSchema: PreferenceSchema = {\n    properties: {\n        [MCP_SERVERS_PREF]: {\n            type: 'object',\n            title: nls.localize('theia/ai/mcp/servers/title', 'MCP Server Configuration'),\n            markdownDescription: nls.localize('theia/ai/mcp/servers/mdDescription', 'Configure MCP servers either local with command, \\\narguments and optionally environment variables, \\\nor remote with server URL, authentication token and optionally an authentication header name. Additionally it is possible to configure autostart (true by default). \\\nEach server is identified by a unique key, such as \"brave-search\" or \"filesystem\". \\\nTo start a server, use the \"MCP: Start MCP Server\" command, which enables you to select the desired server. \\\nTo stop a server, use the \"MCP: Stop MCP Server\" command. \\\nPlease note that autostart will only take effect after a restart, you need to start a server manually for the first time.\\\n\\n\\\nExample configuration:\\n\\\n```\\\n{\\n\\\n  \"brave-search\": {\\n\\\n    \"command\": \"npx\",\\n\\\n    \"args\": [\\n\\\n      \"-y\",\\n\\\n      \"@modelcontextprotocol/server-brave-search\"\\n\\\n    ],\\n\\\n    \"env\": {\\n\\\n      \"BRAVE_API_KEY\": \"YOUR_API_KEY\"\\n\\\n    },\\n\\\n  },\\n\\\n  \"filesystem\": {\\n\\\n    \"command\": \"npx\",\\n\\\n    \"args\": [\"-y\", \"@modelcontextprotocol/server-filesystem\", \"/Users/YOUR_USERNAME/Desktop\"],\\n\\\n    \"env\": {\\n\\\n      \"CUSTOM_ENV_VAR\": \"custom-value\"\\n\\\n    },\\n\\\n    \"autostart\": false\\n\\\n  },\\n\\\n  \"jira\": {\\n\\\n    \"serverUrl\": \"YOUR_JIRA_MCP_SERVER_URL\",\\n\\\n    \"serverAuthToken\": \"YOUR_JIRA_MCP_SERVER_TOKEN\"\\n\\\n  }\\n\\\n}\\n```'),\n            additionalProperties: {\n                type: 'object',\n                properties: {\n                    command: {\n                        type: 'string',\n                        title: nls.localize('theia/ai/mcp/servers/command/title', 'Command to execute the MCP server'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/command/mdDescription', 'The command used to start the MCP server, e.g., \"uvx\" or \"npx\".')\n                    },\n                    args: {\n                        type: 'array',\n                        title: nls.localize('theia/ai/mcp/servers/args/title', 'Arguments for the command'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/args/mdDescription', 'An array of arguments to pass to the command.'),\n                    },\n                    env: {\n                        type: 'object',\n                        title: nls.localize('theia/ai/mcp/servers/env/title', 'Environment variables'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/env/mdDescription', 'Optional environment variables to set for the server, such as an API key.'),\n                        additionalProperties: {\n                            type: 'string'\n                        }\n                    },\n                    autostart: {\n                        type: 'boolean',\n                        title: nls.localize('theia/ai/mcp/servers/autostart/title', 'Autostart'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/autostart/mdDescription',\n                            'Automatically start this server when the frontend starts. Newly added servers are not immediately auto started, but on restart'),\n                        default: true\n                    },\n                    serverUrl: {\n                        type: 'string',\n                        title: nls.localize('theia/ai/mcp/servers/serverUrl/title', 'Server URL'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/serverUrl/mdDescription',\n                            'The URL of the remote MCP server. If provided, the server will connect to this URL instead of starting a local process.'),\n                    },\n                    serverAuthToken: {\n                        type: 'string',\n                        title: nls.localize('theia/ai/mcp/servers/serverAuthToken/title', 'Authentication Token'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/serverAuthToken/mdDescription',\n                            'The authentication token for the server, if required. This is used to authenticate with the remote server.'),\n                    },\n                    serverAuthTokenHeader: {\n                        type: 'string',\n                        title: nls.localize('theia/ai/mcp/servers/serverAuthTokenHeader/title', 'Authentication Header Name'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/serverAuthTokenHeader/mdDescription',\n                            'The header name to use for the server authentication token. If not provided, \"Authorization\" with \"Bearer\" will be used.'),\n                    },\n                    headers: {\n                        type: 'object',\n                        title: nls.localize('theia/ai/mcp/servers/headers/title', 'Headers'),\n                        markdownDescription: nls.localize('theia/ai/mcp/servers/headers/mdDescription',\n                            'Optional additional headers included with each request to the server.'),\n                    }\n                },\n                required: []\n            }\n        }\n    }\n};\n","// *****************************************************************************\n// Copyright (C) 2025 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { MCPServerDescription } from './mcp-server-manager';\n\n/**\n * MCPServerDescriptionRCP is a version of MCPServerDescription that can be sent over RCP.\n * It omits the 'resolve' function and instead includes an optional 'resolveId' to identify\n * the resolve function on the client side.\n */\nexport type MCPServerDescriptionRCP = Omit<MCPServerDescription, 'resolve'> & {\n    resolveId?: string;\n};\n\nexport const MCPServerManagerServer = Symbol('MCPServerManagerServer');\nexport const MCPServerManagerServerPath = '/services/mcpservermanagerserver';\n\n/**\n * The MCPServerManagerServer handles the RCP specialties of adding server descriptions from the frontend\n */\nexport interface MCPServerManagerServer {\n    addOrUpdateServer(description: MCPServerDescriptionRCP): Promise<void>;\n    setClient(client: MCPServerManagerServerClient): void\n}\n\nexport const MCPServerManagerServerClient = Symbol('MCPServerManagerServerClient');\nexport interface MCPServerManagerServerClient {\n    /**\n     * Adds a server description to the client. If the description contains a resolve function,\n     * a unique resolveId is generated and only the name and resolve function are stored.\n     * @param description The server description to add.\n     * @returns The server description with a unique resolveId if a resolve function is provided\n     * or the given description if no resolve function is provided.\n     */\n    addServerDescription(description: MCPServerDescription): MCPServerDescriptionRCP;\n    /**\n     * Retrieves the resolve function for a given server name.\n     * @param name The name of the server to retrieve the resolve function for.\n     * @returns The resolve function if found, or undefined if not found.\n     */\n    getResolveFunction(name: string): MCPServerDescription['resolve'];\n    /**\n     * Resolves the server description by calling the resolve function if it exists.\n     * @param description The server description to resolve.\n     * @returns The resolved server description.\n     */\n    resolveServerDescription(description: MCPServerDescriptionRCP): Promise<MCPServerDescription>;\n    /**\n     * Removes server descriptions that are no longer present in the MCPServerManager.\n     *\n     * @param serverNames The current list of server names from the MCPServerManager.\n     */\n    cleanServers(serverNames: string[]): void;\n}\n\n/**\n * Util function to convert a MCPServerDescriptionRCP to a MCPServerDescription by removing the resolveId.\n */\nexport const cleanServerDescription = (description: MCPServerDescriptionRCP): MCPServerDescription => {\n    const { resolveId, ...descriptionProperties } = description;\n    return { ...descriptionProperties } as MCPServerDescription;\n};\n","// *****************************************************************************\n// Copyright (C) 2024 EclipseSource GmbH.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport type { CallToolResult, ListResourcesResult, ListToolsResult, ReadResourceResult } from '@modelcontextprotocol/sdk/types';\nimport { Event } from '@theia/core/lib/common/event';\n\nexport const MCPFrontendService = Symbol('MCPFrontendService');\nexport interface MCPFrontendService {\n    startServer(serverName: string): Promise<void>;\n    hasServer(serverName: string): Promise<boolean>;\n    isServerStarted(serverName: string): Promise<boolean>;\n    registerToolsForAllStartedServers(): Promise<void>;\n    stopServer(serverName: string): Promise<void>;\n    addOrUpdateServer(description: MCPServerDescription): Promise<void>;\n    getStartedServers(): Promise<string[]>;\n    getServerNames(): Promise<string[]>;\n    getServerDescription(name: string): Promise<MCPServerDescription | undefined>;\n    getTools(serverName: string): Promise<ListToolsResult | undefined>;\n    getPromptTemplateId(serverName: string): string;\n}\n\nexport const MCPFrontendNotificationService = Symbol('MCPFrontendNotificationService');\nexport interface MCPFrontendNotificationService {\n    readonly onDidUpdateMCPServers: Event<void>;\n    didUpdateMCPServers(): void;\n}\n\nexport interface MCPServer {\n    callTool(toolName: string, arg_string: string): Promise<CallToolResult>;\n    getTools(): Promise<ListToolsResult>;\n    readResource(resourceId: string): Promise<ReadResourceResult>;\n    getResources(): Promise<ListResourcesResult>;\n    description: MCPServerDescription;\n}\n\nexport interface MCPServerManager {\n    callTool(serverName: string, toolName: string, arg_string: string): Promise<CallToolResult>;\n    removeServer(name: string): void;\n    addOrUpdateServer(description: MCPServerDescription): void;\n    getTools(serverName: string): Promise<ListToolsResult>;\n    getServerNames(): Promise<string[]>;\n    getServerDescription(name: string): Promise<MCPServerDescription | undefined>;\n    startServer(serverName: string): Promise<void>;\n    stopServer(serverName: string): Promise<void>;\n    getRunningServers(): Promise<string[]>;\n    setClient(client: MCPFrontendNotificationService): void;\n    disconnectClient(client: MCPFrontendNotificationService): void;\n    readResource(serverName: string, resourceId: string): Promise<ReadResourceResult>;\n    getResources(serverName: string): Promise<ListResourcesResult>;\n}\n\nexport interface ToolInformation {\n    name: string;\n    description?: string;\n}\n\nexport enum MCPServerStatus {\n    NotRunning = 'Not Running',\n    NotConnected = 'Not Connected',\n    Starting = 'Starting',\n    Connecting = 'Connecting',\n    Running = 'Running',\n    Connected = 'Connected',\n    Errored = 'Errored'\n}\n\nexport interface BaseMCPServerDescription {\n    /**\n     * The unique name of the MCP server.\n     */\n    name: string;\n\n    /**\n     * Flag indicating whether the server should automatically start when the application starts.\n     */\n    autostart?: boolean;\n\n    /**\n     * The current status of the server. Optional because only set by the server.\n     */\n    status?: MCPServerStatus;\n\n    /**\n     * Last error message that the server has returned.\n     */\n    error?: string;\n\n    /**\n     * List of available tools for the server. Returns the name and description if available.\n     */\n    tools?: ToolInformation[];\n\n    /**\n     * Optional resolve function that gets called during server definition resolution.\n     * This function can be used to dynamically modify server configurations,\n     * resolve environment variables, validate configurations, or perform any\n     * necessary preprocessing before the server starts.\n     *\n     * @param description The current server description\n     * @returns A promise that resolves to the processed server description\n     */\n    resolve?: (description: MCPServerDescription) => Promise<MCPServerDescription>;\n}\n\nexport interface LocalMCPServerDescription extends BaseMCPServerDescription {\n    /**\n     * The command to execute the MCP server.\n     */\n    command: string;\n\n    /**\n     * An array of arguments to pass to the command.\n     */\n    args?: string[];\n\n    /**\n     * Optional environment variables to set when starting the server.\n     */\n    env?: { [key: string]: string };\n}\n\nexport interface RemoteMCPServerDescription extends BaseMCPServerDescription {\n    /**\n     * The URL of the remote MCP server.\n     */\n    serverUrl: string;\n\n    /**\n     * The authentication token for the server, if required.\n     */\n    serverAuthToken?: string;\n\n    /**\n     * The header name to use for the server authentication token.\n     */\n    serverAuthTokenHeader?: string;\n\n    /**\n     * Optional additional headers to include in requests to the server.\n     */\n    headers?: Record<string, string>;\n}\n\nexport type MCPServerDescription = LocalMCPServerDescription | RemoteMCPServerDescription;\n\nexport function isLocalMCPServerDescription(description: MCPServerDescription): description is LocalMCPServerDescription {\n    return (description as LocalMCPServerDescription).command !== undefined;\n}\nexport function isRemoteMCPServerDescription(description: MCPServerDescription): description is RemoteMCPServerDescription {\n    return (description as RemoteMCPServerDescription).serverUrl !== undefined;\n}\n\nexport const MCPServerManager = Symbol('MCPServerManager');\nexport const MCPServerManagerPath = '/services/mcpservermanager';\n","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n"],"names":[],"ignoreList":[],"sourceRoot":""}