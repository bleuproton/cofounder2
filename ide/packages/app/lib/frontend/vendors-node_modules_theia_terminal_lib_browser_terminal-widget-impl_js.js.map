{"version":3,"file":"vendors-node_modules_theia_terminal_lib_browser_terminal-widget-impl_js.js","mappings":"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","sources":["webpack:///../../node_modules/@theia/terminal/src/browser/base/terminal-widget.ts?","webpack:///../../node_modules/@theia/terminal/src/browser/search/terminal-search-widget.tsx?","webpack:///../../node_modules/@theia/terminal/src/browser/shell-terminal-profile.ts?","webpack:///../../node_modules/@theia/terminal/src/browser/terminal-copy-on-selection-handler.ts?","webpack:///../../node_modules/@theia/terminal/src/browser/terminal-frontend-contribution.ts?","webpack:///../../node_modules/@theia/terminal/src/browser/terminal-profile-service.ts?","webpack:///../../node_modules/@theia/terminal/src/browser/terminal-widget-impl.ts?","webpack:///../../node_modules/@theia/terminal/src/common/base-terminal-protocol.ts?","webpack:///../../node_modules/@theia/terminal/src/common/shell-type.ts?","webpack:///../../node_modules/@theia/terminal/src/common/terminal-protocol.ts?","webpack:///../../node_modules/@theia/terminal/src/common/terminal-watcher.ts?","webpack:///../../node_modules/@theia/terminal/src/browser/style/terminal-search.css?","webpack:///../../node_modules/@theia/terminal/src/browser/style/terminal-search.css?../../node_modules/css-loader/dist/cjs.js","webpack:///SearchAddon/webpack/universalModuleDefinition?","webpack:///SearchAddon/../../src/common/EventEmitter.ts?","webpack:///SearchAddon/../../src/common/Lifecycle.ts?","webpack:///SearchAddon/webpack/bootstrap?","webpack:///SearchAddon/./src/SearchAddon.ts?","webpack:///WebglAddon/webpack/universalModuleDefinition?","webpack:///WebglAddon/./src/GlyphRenderer.ts?","webpack:///WebglAddon/./src/RectangleRenderer.ts?","webpack:///WebglAddon/./src/RenderModel.ts?","webpack:///WebglAddon/./src/WebglRenderer.ts?","webpack:///WebglAddon/./src/WebglUtils.ts?","webpack:///WebglAddon/./src/renderLayer/BaseRenderLayer.ts?","webpack:///WebglAddon/./src/renderLayer/LinkRenderLayer.ts?","webpack:///WebglAddon/../../src/browser/Lifecycle.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/CellColorResolver.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/CharAtlasCache.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/CharAtlasUtils.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/Constants.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/CursorBlinkStateManager.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/CustomGlyphs.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/DevicePixelObserver.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/RendererUtils.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/SelectionRenderModel.ts?","webpack:///WebglAddon/../../src/browser/renderer/shared/TextureAtlas.ts?","webpack:///WebglAddon/../../src/common/Color.ts?","webpack:///WebglAddon/../../src/common/EventEmitter.ts?","webpack:///WebglAddon/../../src/common/Lifecycle.ts?","webpack:///WebglAddon/../../src/common/MultiKeyMap.ts?","webpack:///WebglAddon/../../src/common/Platform.ts?","webpack:///WebglAddon/../../src/common/TaskQueue.ts?","webpack:///WebglAddon/../../src/common/buffer/AttributeData.ts?","webpack:///WebglAddon/../../src/common/buffer/CellData.ts?","webpack:///WebglAddon/../../src/common/buffer/Constants.ts?","webpack:///WebglAddon/../../src/common/input/TextDecoder.ts?","webpack:///WebglAddon/../../src/common/services/LogService.ts?","webpack:///WebglAddon/../../src/common/services/ServiceRegistry.ts?","webpack:///WebglAddon/../../src/common/services/Services.ts?","webpack:///WebglAddon/webpack/bootstrap?","webpack:///WebglAddon/./src/WebglAddon.ts?"],"sourcesContent":["// *****************************************************************************\n// Copyright (C) 2018 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Event, ViewColumn } from '@theia/core';\nimport { BaseWidget } from '@theia/core/lib/browser';\nimport { MarkdownString } from '@theia/core/lib/common/markdown-rendering/markdown-string';\nimport { ThemeIcon } from '@theia/core/lib/common/theme';\nimport { CommandLineOptions } from '@theia/process/lib/common/shell-command-builder';\nimport { TerminalSearchWidget } from '../search/terminal-search-widget';\nimport { TerminalProcessInfo, TerminalExitReason } from '../../common/base-terminal-protocol';\nimport URI from '@theia/core/lib/common/uri';\n\nexport interface TerminalDimensions {\n    cols: number;\n    rows: number;\n}\n\nexport interface TerminalExitStatus {\n    readonly code: number | undefined;\n    readonly reason: TerminalExitReason;\n}\n\nexport type TerminalLocationOptions = TerminalLocation | TerminalEditorLocation | TerminalSplitLocation;\n\nexport enum TerminalLocation {\n    Panel = 1,\n    Editor = 2\n}\n\nexport interface TerminalEditorLocation {\n    readonly viewColumn: ViewColumn;\n    readonly preserveFocus?: boolean;\n}\n\nexport interface TerminalSplitLocation {\n    readonly parentTerminal: string;\n}\n\nexport interface TerminalBuffer {\n    readonly length: number;\n    /**\n     * @param start zero based index of the first line to return\n     * @param length the max number or lines to return\n     */\n    getLines(start: number, length: number): string[];\n}\n\n/**\n * Terminal UI widget.\n */\nexport abstract class TerminalWidget extends BaseWidget {\n\n    abstract processId: Promise<number>;\n    /**\n     * Get the current executable and arguments.\n     */\n    abstract processInfo: Promise<TerminalProcessInfo>;\n\n    /** The ids of extensions contributing to the environment of this terminal mapped to the provided description for their changes. */\n    abstract envVarCollectionDescriptionsByExtension: Promise<Map<string, (string | MarkdownString | undefined)[]>>;\n\n    /** Terminal kind that indicates whether a terminal is created by a user or by some extension for a user */\n    abstract readonly kind: 'user' | string;\n\n    abstract readonly terminalId: number;\n\n    abstract readonly dimensions: TerminalDimensions;\n\n    abstract readonly exitStatus: TerminalExitStatus | undefined;\n\n    /** Terminal widget can be hidden from users until explicitly shown once. */\n    abstract readonly hiddenFromUser: boolean;\n\n    /** The position of the terminal widget. */\n    abstract readonly location: TerminalLocationOptions;\n\n    /** The last CWD assigned to the terminal, useful when attempting getCwdURI on a task terminal fails */\n    lastCwd: URI;\n\n    /**\n     * Start terminal and return terminal id.\n     * @param id - terminal id.\n     */\n    abstract start(id?: number): Promise<number>;\n\n    /**\n     * Send text to the terminal server.\n     * @param text - text content.\n     */\n    abstract sendText(text: string): void;\n\n    /**\n     * Resolves when the command is successfully sent, this doesn't mean that it\n     * was evaluated. Might reject if terminal wasn't properly started yet.\n     *\n     * Note that this method will try to escape your arguments as if it was\n     * someone inputting everything in a shell.\n     *\n     * Supported shells: `bash`, `cmd.exe`, `wsl.exe`, `pwsh/powershell.exe`\n     */\n    abstract executeCommand(commandOptions: CommandLineOptions): Promise<void>;\n\n    /** Event that fires when the terminal is connected or reconnected */\n    abstract onDidOpen: Event<void>;\n\n    /** Event that fires when the terminal fails to connect or reconnect */\n    abstract onDidOpenFailure: Event<void>;\n\n    /** Event that fires when the terminal size changed */\n    abstract onSizeChanged: Event<{ cols: number; rows: number; }>;\n\n    /** Event that fires when the terminal receives a key event. */\n    abstract onKey: Event<{ key: string, domEvent: KeyboardEvent }>;\n\n    /** Event that fires when the terminal input data */\n    abstract onData: Event<string>;\n\n    /** Event that fires when the terminal shell type is changed */\n    abstract onShellTypeChanged: Event<string>;\n\n    abstract onOutput: Event<string>;\n\n    abstract buffer: TerminalBuffer;\n\n    abstract scrollLineUp(): void;\n\n    abstract scrollLineDown(): void;\n\n    abstract scrollToTop(): void;\n\n    abstract scrollToBottom(): void;\n\n    abstract scrollPageUp(): void;\n\n    abstract scrollPageDown(): void;\n\n    abstract resetTerminal(): void;\n    /**\n     * Event which fires when terminal did closed. Event value contains closed terminal widget definition.\n     */\n    abstract onTerminalDidClose: Event<TerminalWidget>;\n\n    /**\n     * Cleat terminal output.\n     */\n    abstract clearOutput(): void;\n\n    /**\n     * Select entire content in the terminal.\n     */\n    abstract selectAll(): void;\n\n    abstract writeLine(line: string): void;\n\n    abstract write(data: string): void;\n\n    abstract resize(cols: number, rows: number): void;\n\n    /**\n     * Return Terminal search box widget.\n     */\n    abstract getSearchBox(): TerminalSearchWidget;\n    /**\n     * Whether the terminal process has child processes.\n     */\n    abstract hasChildProcesses(): Promise<boolean>;\n\n    abstract setTitle(title: string): void;\n\n    abstract waitOnExit(waitOnExit?: boolean | string): void;\n}\n\n/**\n * Terminal widget options.\n */\nexport const TerminalWidgetOptions = Symbol('TerminalWidgetOptions');\nexport interface TerminalWidgetOptions {\n\n    /**\n     * Human readable terminal representation on the UI.\n     */\n    readonly title?: string;\n\n    /**\n     * icon class with or without color modifier\n     */\n    readonly iconClass?: string | ThemeIcon;\n\n    /**\n     * Path to the executable shell. For example: `/bin/bash`, `bash`, `sh`.\n     */\n    readonly shellPath?: string;\n\n    /**\n     * Args for the custom shell executable. A string can be used on Windows only which allows\n     * specifying shell args in [command-line format](https://msdn.microsoft.com/en-au/08dfcab2-eb6e-49a4-80eb-87d4076c98c6).\n     */\n    readonly shellArgs?: string[] | string;\n\n    /**\n     * Current working directory.\n     */\n    readonly cwd?: string | URI;\n\n    /**\n     * Environment variables for terminal.\n     */\n    readonly env?: { [key: string]: string | null };\n\n    /**\n     * Whether the terminal process environment should be exactly as provided in `env`.\n     */\n    readonly strictEnv?: boolean;\n\n    /**\n     * In case `destroyTermOnClose` is true - terminal process will be destroyed on close terminal widget, otherwise will be kept\n     * alive.\n     */\n    readonly destroyTermOnClose?: boolean;\n\n    /**\n     * Terminal server side can send to the client `terminal title` to display this value on the UI. If\n     * useServerTitle = true then display this title, otherwise display title defined by 'title' argument.\n     */\n    readonly useServerTitle?: boolean;\n\n    /**\n     * Whether it is a pseudo terminal where an extension controls its input and output.\n     */\n    readonly isPseudoTerminal?: boolean;\n\n    /**\n     * Terminal id. Should be unique for all DOM.\n     */\n    readonly id?: string;\n\n    /**\n     * Terminal attributes. Can be useful to apply some implementation specific information.\n     */\n    readonly attributes?: { [key: string]: string | null };\n\n    /**\n     * Terminal kind that indicates whether a terminal is created by a user or by some extension for a user\n     */\n    readonly kind?: 'user' | string;\n\n    /**\n     * When enabled the terminal will run the process as normal but not be surfaced to the user until `Terminal.show` is called.\n     */\n    readonly hideFromUser?: boolean;\n\n    readonly location?: TerminalLocationOptions;\n\n    /**\n     * When enabled, the terminal will not be persisted across window reloads.\n     */\n    readonly isTransient?: boolean;\n\n    /**\n     * The nonce to use to verify shell integration sequences are coming from a trusted source.\n     * An example impact of UX of this is if the command line is reported with a nonce, it will\n     * not need to verify with the user that the command line is correct before rerunning it\n     * via the [shell integration command decoration](https://code.visualstudio.com/docs/terminal/shell-integration#_command-decorations-and-the-overview-ruler).\n     *\n     * This should be used if the terminal includes [custom shell integration support](https://code.visualstudio.com/docs/terminal/shell-integration#_supported-escape-sequences).\n     * It should be set to a random GUID which will then set the `VSCODE_NONCE` environment\n     * variable. Inside the shell, this should then be removed from the environment so as to\n     * protect it from general access. Once that is done it can be passed through in the\n     * relevant sequences to make them trusted.\n     */\n    readonly shellIntegrationNonce?: string;\n}\n","// *****************************************************************************\n// Copyright (C) 2019 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, inject, postConstruct } from '@theia/core/shared/inversify';\nimport { ReactWidget } from '@theia/core/lib/browser/widgets/react-widget';\nimport * as React from '@theia/core/shared/react';\nimport '../../../src/browser/style/terminal-search.css';\nimport { Terminal } from 'xterm';\nimport { SearchAddon, ISearchOptions } from 'xterm-addon-search';\nimport { codicon, Key } from '@theia/core/lib/browser';\nimport { nls } from '@theia/core';\n\nexport const TERMINAL_SEARCH_WIDGET_FACTORY_ID = 'terminal-search';\nexport const TerminalSearchWidgetFactory = Symbol('TerminalSearchWidgetFactory');\nexport type TerminalSearchWidgetFactory = (terminal: Terminal) => TerminalSearchWidget;\n\n@injectable()\nexport class TerminalSearchWidget extends ReactWidget {\n\n    private searchInput: HTMLInputElement | null;\n    private searchBox: HTMLDivElement | null;\n    private searchOptions: ISearchOptions = {};\n    private searchAddon: SearchAddon;\n\n    @inject(Terminal)\n    protected terminal: Terminal;\n\n    @postConstruct()\n    protected init(): void {\n        this.node.classList.add('theia-search-terminal-widget-parent');\n\n        this.searchAddon = new SearchAddon();\n        this.terminal.loadAddon(this.searchAddon);\n\n        this.hide();\n        this.update();\n    }\n\n    protected render(): React.ReactNode {\n        return <div className='theia-search-terminal-widget'>\n            <div className='theia-search-elem-box' ref={searchBox => this.searchBox = searchBox} >\n                <input\n                    title={nls.localizeByDefault('Find')}\n                    type='text'\n                    spellCheck='false'\n                    placeholder={nls.localizeByDefault('Find')}\n                    ref={ip => this.searchInput = ip}\n                    onKeyUp={this.onInputChanged}\n                    onFocus={this.onSearchInputFocus}\n                    onBlur={this.onSearchInputBlur}\n                />\n                <div\n                    title={nls.localizeByDefault('Match Case')}\n                    tabIndex={0}\n                    className={'search-elem ' + codicon('case-sensitive')}\n                    onClick={this.handleCaseSensitiveOptionClicked}\n                />\n                <div\n                    title={nls.localizeByDefault('Match Whole Word')}\n                    tabIndex={0}\n                    className={'search-elem ' + codicon('whole-word')}\n                    onClick={this.handleWholeWordOptionClicked}\n                />\n                <div\n                    title={nls.localizeByDefault('Use Regular Expression')}\n                    tabIndex={0}\n                    className={'search-elem ' + codicon('regex')}\n                    onClick={this.handleRegexOptionClicked}\n                />\n            </div>\n            <button title={nls.localizeByDefault('Previous Match')} className={'search-elem ' + codicon('arrow-up')} onClick={this.handlePreviousButtonClicked}></button>\n            <button title={nls.localizeByDefault('Next Match')} className={'search-elem ' + codicon('arrow-down')} onClick={this.handleNextButtonClicked}></button>\n            <button title={nls.localizeByDefault('Close')} className={'search-elem ' + codicon('close')} onClick={this.handleHide}></button>\n        </div>;\n    }\n\n    onSearchInputFocus = (): void => {\n        if (this.searchBox) {\n            this.searchBox.classList.add('focused');\n        }\n    };\n\n    onSearchInputBlur = (): void => {\n        if (this.searchBox) {\n            this.searchBox.classList.remove('focused');\n        }\n    };\n\n    private handleHide = (): void => {\n        this.hide();\n    };\n\n    private handleCaseSensitiveOptionClicked = (event: React.MouseEvent<HTMLSpanElement>): void => {\n        this.searchOptions.caseSensitive = !this.searchOptions.caseSensitive;\n        this.updateSearchInputBox(this.searchOptions.caseSensitive, event.currentTarget);\n    };\n\n    private handleWholeWordOptionClicked = (event: React.MouseEvent<HTMLSpanElement>): void => {\n        this.searchOptions.wholeWord = !this.searchOptions.wholeWord;\n        this.updateSearchInputBox(this.searchOptions.wholeWord, event.currentTarget);\n    };\n\n    private handleRegexOptionClicked = (event: React.MouseEvent<HTMLSpanElement>): void => {\n        this.searchOptions.regex = !this.searchOptions.regex;\n        this.updateSearchInputBox(this.searchOptions.regex, event.currentTarget);\n    };\n\n    private updateSearchInputBox(enable: boolean, optionElement: HTMLSpanElement): void {\n        if (enable) {\n            optionElement.classList.add('option-enabled');\n        } else {\n            optionElement.classList.remove('option-enabled');\n        }\n        this.searchInput!.focus();\n    }\n\n    private onInputChanged = (event: React.KeyboardEvent): void => {\n        // move to previous search result on `Shift + Enter`\n        if (event && event.shiftKey && event.keyCode === Key.ENTER.keyCode) {\n            this.search(false, 'previous');\n            return;\n        }\n        // move to next search result on `Enter`\n        if (event && event.keyCode === Key.ENTER.keyCode) {\n            this.search(false, 'next');\n            return;\n        }\n\n        this.search(true, 'next');\n    };\n\n    search(incremental: boolean, searchDirection: 'next' | 'previous'): void {\n        if (this.searchInput) {\n            this.searchOptions.incremental = incremental;\n            const searchText = this.searchInput.value;\n\n            if (searchDirection === 'next') {\n                this.searchAddon.findNext(searchText, this.searchOptions);\n            }\n\n            if (searchDirection === 'previous') {\n                this.searchAddon.findPrevious(searchText, this.searchOptions);\n            }\n        }\n    }\n\n    private handleNextButtonClicked = (): void => {\n        this.search(false, 'next');\n    };\n\n    private handlePreviousButtonClicked = (): void => {\n        this.search(false, 'previous');\n    };\n\n    override onAfterHide(): void {\n        this.terminal.focus();\n    }\n\n    override onAfterShow(): void {\n        if (this.searchInput) {\n            this.searchInput.select();\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2022 STMicroelectronics and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { URI } from '@theia/core';\nimport { TerminalService } from './base/terminal-service';\nimport { TerminalWidget, TerminalWidgetOptions } from './base/terminal-widget';\nimport { TerminalProfile } from './terminal-profile-service';\n\nexport class ShellTerminalProfile implements TerminalProfile {\n\n    get shellPath(): string | undefined {\n        return this.options.shellPath;\n    }\n\n    constructor(protected readonly terminalService: TerminalService, protected readonly options: TerminalWidgetOptions) { }\n\n    async start(): Promise<TerminalWidget> {\n        const widget = await this.terminalService.newTerminal(this.options);\n        widget.start();\n        return widget;\n    }\n\n    /**\n     * Makes a copy of this profile modified with the options given\n     * as an argument.\n     * @param options the options to override\n     * @returns a modified copy of this profile\n     */\n    modify(options: { cwd?: string | URI }): TerminalProfile {\n        return new ShellTerminalProfile(this.terminalService, { ...this.options, ...options });\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2019 Red Hat, Inc. and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable, postConstruct } from '@theia/core/shared/inversify';\nimport { isFirefox } from '@theia/core/lib/browser';\n\n@injectable()\nexport class TerminalCopyOnSelectionHandler {\n\n    private textToCopy: string;\n    private interceptCopy: boolean;\n\n    private copyListener = (ev: ClipboardEvent) => {\n        if (this.interceptCopy && ev.clipboardData) {\n            ev.clipboardData.setData('text/plain', this.textToCopy);\n            ev.preventDefault();\n        }\n    };\n\n    @postConstruct()\n    protected init(): void {\n        document.addEventListener('copy', this.copyListener);\n    }\n\n    private async clipBoardCopyIsGranted(): Promise<boolean> {\n        // Unfortunately Firefox doesn't support permission check `clipboard-write`, so let try to copy anyway,\n        if (isFirefox) {\n            return true;\n        }\n        try {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const permissions = (navigator as any).permissions;\n            const { state } = await permissions.query({ name: 'clipboard-write' });\n            if (state === 'granted') {\n                return true;\n            }\n        } catch (e) { }\n\n        return false;\n    }\n\n    private executeCommandCopy(): void {\n        try {\n            this.interceptCopy = true;\n            document.execCommand('copy');\n            this.interceptCopy = false;\n        } catch (e) {\n            // do nothing\n        }\n    }\n\n    private async writeToClipBoard(): Promise<void> {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const clipboard = (navigator as any).clipboard;\n\n        if (!clipboard) {\n            this.executeCommandCopy();\n            return;\n        }\n\n        try {\n            await clipboard.writeText(this.textToCopy);\n        } catch (e) {\n            this.executeCommandCopy();\n        }\n    }\n\n    async copy(text: string): Promise<void> {\n        this.textToCopy = text;\n\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const permissions = (navigator as any).permissions;\n        if (permissions && permissions.query && await this.clipBoardCopyIsGranted()) {\n            await this.writeToClipBoard();\n        } else {\n            this.executeCommandCopy();\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2017 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { inject, injectable, optional, postConstruct } from '@theia/core/shared/inversify';\nimport {\n    CommandContribution,\n    Command,\n    CommandRegistry,\n    DisposableCollection,\n    MenuContribution,\n    MenuModelRegistry,\n    isOSX,\n    SelectionService,\n    Emitter,\n    Event,\n    ViewColumn,\n    OS,\n    MAIN_MENU_BAR,\n    PreferenceService,\n    PreferenceScope\n} from '@theia/core/lib/common';\nimport {\n    ApplicationShell, KeybindingContribution, KeyCode, Key, WidgetManager,\n    KeybindingRegistry, LabelProvider, WidgetOpenerOptions, StorageService, QuickInputService,\n    codicon, CommonCommands, FrontendApplicationContribution, OnWillStopAction, Dialog, ConfirmDialog, FrontendApplication, Widget, SHELL_TABBAR_CONTEXT_MENU\n} from '@theia/core/lib/browser';\nimport { TabBarToolbarContribution, TabBarToolbarRegistry } from '@theia/core/lib/browser/shell/tab-bar-toolbar';\nimport { TERMINAL_WIDGET_FACTORY_ID, TerminalWidgetFactoryOptions, TerminalWidgetImpl } from './terminal-widget-impl';\nimport { TerminalService } from './base/terminal-service';\nimport { TerminalWidgetOptions, TerminalWidget, TerminalLocation } from './base/terminal-widget';\nimport { ContributedTerminalProfileStore, NULL_PROFILE, TerminalProfile, TerminalProfileService, TerminalProfileStore, UserTerminalProfileStore } from './terminal-profile-service';\nimport { UriAwareCommandHandler } from '@theia/core/lib/common/uri-command-handler';\nimport { ShellTerminalServerProxy } from '../common/shell-terminal-protocol';\nimport URI from '@theia/core/lib/common/uri';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { ContextKeyService } from '@theia/core/lib/browser/context-key-service';\nimport { ColorContribution } from '@theia/core/lib/browser/color-application-contribution';\nimport { ColorRegistry } from '@theia/core/lib/browser/color-registry';\nimport { FileService } from '@theia/filesystem/lib/browser/file-service';\nimport { FileStat } from '@theia/filesystem/lib/common/files';\nimport { TerminalWatcher } from '../common/terminal-watcher';\nimport { nls } from '@theia/core/lib/common/nls';\nimport { Profiles, terminalAnsiColorMap, TerminalPreferences } from '../common/terminal-preferences';\nimport { ShellTerminalProfile } from './shell-terminal-profile';\nimport { VariableResolverService } from '@theia/variable-resolver/lib/browser';\nimport { Color } from '@theia/core/lib/common/color';\n\nexport namespace TerminalMenus {\n    export const TERMINAL = [...MAIN_MENU_BAR, '7_terminal'];\n    export const TERMINAL_NEW = [...TERMINAL, '1_terminal'];\n\n    export const TERMINAL_TASKS = [...TERMINAL, '2_terminal'];\n    export const TERMINAL_TASKS_INFO = [...TERMINAL_TASKS, '3_terminal'];\n    export const TERMINAL_TASKS_CONFIG = [...TERMINAL_TASKS, '4_terminal'];\n    export const TERMINAL_NAVIGATOR_CONTEXT_MENU = ['navigator-context-menu', 'navigation'];\n    export const TERMINAL_OPEN_EDITORS_CONTEXT_MENU = ['open-editors-context-menu', 'navigation'];\n\n    export const TERMINAL_CONTEXT_MENU = ['terminal-context-menu'];\n    export const TERMINAL_CONTRIBUTIONS = [...TERMINAL_CONTEXT_MENU, '5_terminal_contributions'];\n\n    export const TERMINAL_TITLE_CONTRIBUTIONS = [...SHELL_TABBAR_CONTEXT_MENU, 'terminal_title_contributions'];\n}\n\nexport namespace TerminalCommands {\n    export const TERMINAL_CATEGORY = 'Terminal';\n    export const TERMINAL_CATEGORY_KEY = nls.getDefaultKey(TERMINAL_CATEGORY);\n    export const NEW = Command.toDefaultLocalizedCommand({\n        id: 'terminal:new',\n        category: TERMINAL_CATEGORY,\n        label: 'Create New Terminal'\n    });\n    export const PROFILE_NEW = Command.toLocalizedCommand({\n        id: 'terminal:new:profile',\n        category: TERMINAL_CATEGORY,\n        label: 'Create New Integrated Terminal from a Profile'\n    }, undefined, TERMINAL_CATEGORY_KEY);\n    export const PROFILE_DEFAULT = Command.toLocalizedCommand({\n        id: 'terminal:profile:default',\n        category: TERMINAL_CATEGORY,\n        label: 'Choose the default Terminal Profile'\n    }, undefined, TERMINAL_CATEGORY_KEY);\n    export const NEW_ACTIVE_WORKSPACE = Command.toDefaultLocalizedCommand({\n        id: 'terminal:new:active:workspace',\n        category: TERMINAL_CATEGORY,\n        label: 'Create New Terminal (In Active Workspace)'\n    });\n    export const TERMINAL_CLEAR = Command.toDefaultLocalizedCommand({\n        id: 'terminal:clear',\n        category: TERMINAL_CATEGORY,\n        label: 'Clear'\n    });\n    export const TERMINAL_CONTEXT = Command.toDefaultLocalizedCommand({\n        id: 'terminal:context',\n        category: TERMINAL_CATEGORY,\n        label: 'Open in Integrated Terminal'\n    });\n    export const SPLIT = Command.toDefaultLocalizedCommand({\n        id: 'terminal:split',\n        category: TERMINAL_CATEGORY,\n        label: 'Split Terminal'\n    });\n    export const TERMINAL_FIND_TEXT = Command.toDefaultLocalizedCommand({\n        id: 'terminal:find',\n        category: TERMINAL_CATEGORY,\n        label: 'Find'\n    });\n    export const TERMINAL_FIND_TEXT_CANCEL = Command.toDefaultLocalizedCommand({\n        id: 'terminal:find:cancel',\n        category: TERMINAL_CATEGORY,\n        label: 'Hide Find'\n    });\n\n    export const SCROLL_LINE_UP = Command.toDefaultLocalizedCommand({\n        id: 'terminal:scroll:line:up',\n        category: TERMINAL_CATEGORY,\n        label: 'Scroll Up (Line)'\n    });\n    export const SCROLL_LINE_DOWN = Command.toDefaultLocalizedCommand({\n        id: 'terminal:scroll:line:down',\n        category: TERMINAL_CATEGORY,\n        label: 'Scroll Down (Line)'\n    });\n    export const SCROLL_TO_TOP = Command.toDefaultLocalizedCommand({\n        id: 'terminal:scroll:top',\n        category: TERMINAL_CATEGORY,\n        label: 'Scroll to Top'\n    });\n    export const SCROLL_PAGE_UP = Command.toDefaultLocalizedCommand({\n        id: 'terminal:scroll:page:up',\n        category: TERMINAL_CATEGORY,\n        label: 'Scroll Up (Page)'\n    });\n    export const SCROLL_PAGE_DOWN = Command.toDefaultLocalizedCommand({\n        id: 'terminal:scroll:page:down',\n        category: TERMINAL_CATEGORY,\n        label: 'Scroll Down (Page)'\n    });\n    export const TOGGLE_TERMINAL = Command.toDefaultLocalizedCommand({\n        id: 'workbench.action.terminal.toggleTerminal',\n        category: TERMINAL_CATEGORY,\n        label: 'Toggle Terminal'\n    });\n    export const KILL_TERMINAL = Command.toDefaultLocalizedCommand({\n        id: 'terminal:kill',\n        category: TERMINAL_CATEGORY,\n        label: 'Kill Terminal'\n    });\n    export const SELECT_ALL: Command = Command.toDefaultLocalizedCommand({\n        id: 'terminal:select:all',\n        label: 'Select All',\n        category: TERMINAL_CATEGORY,\n    });\n\n    /**\n     * Command that displays all terminals that are currently opened\n     */\n    export const SHOW_ALL_OPENED_TERMINALS = Command.toDefaultLocalizedCommand({\n        id: 'workbench.action.showAllTerminals',\n        category: CommonCommands.VIEW_CATEGORY,\n        label: 'Show All Opened Terminals'\n    });\n}\n\nconst ENVIRONMENT_VARIABLE_COLLECTIONS_KEY = 'terminal.integrated.environmentVariableCollections';\n@injectable()\nexport class TerminalFrontendContribution implements FrontendApplicationContribution, TerminalService, CommandContribution, MenuContribution,\n    KeybindingContribution, TabBarToolbarContribution, ColorContribution {\n\n    @inject(ApplicationShell) protected readonly shell: ApplicationShell;\n    @inject(ShellTerminalServerProxy) protected readonly shellTerminalServer: ShellTerminalServerProxy;\n    @inject(WidgetManager) protected readonly widgetManager: WidgetManager;\n    @inject(FileService) protected readonly fileService: FileService;\n    @inject(SelectionService) protected readonly selectionService: SelectionService;\n\n    @inject(LabelProvider)\n    protected readonly labelProvider: LabelProvider;\n\n    @inject(QuickInputService) @optional()\n    protected readonly quickInputService: QuickInputService;\n\n    @inject(WorkspaceService)\n    protected readonly workspaceService: WorkspaceService;\n\n    @inject(TerminalProfileService)\n    protected readonly profileService: TerminalProfileService;\n\n    @inject(UserTerminalProfileStore)\n    protected readonly userProfileStore: TerminalProfileStore;\n\n    @inject(ContributedTerminalProfileStore)\n    protected readonly contributedProfileStore: TerminalProfileStore;\n\n    @inject(TerminalWatcher)\n    protected readonly terminalWatcher: TerminalWatcher;\n\n    @inject(VariableResolverService)\n    protected readonly variableResolver: VariableResolverService;\n\n    @inject(StorageService)\n    protected readonly storageService: StorageService;\n\n    @inject(PreferenceService)\n    protected readonly preferenceService: PreferenceService;\n\n    @inject(TerminalPreferences)\n    protected terminalPreferences: TerminalPreferences;\n\n    protected mergePreferencesPromise: Promise<void> = Promise.resolve();\n\n    protected readonly onDidCreateTerminalEmitter = new Emitter<TerminalWidget>();\n    readonly onDidCreateTerminal: Event<TerminalWidget> = this.onDidCreateTerminalEmitter.event;\n\n    protected readonly onDidChangeCurrentTerminalEmitter = new Emitter<TerminalWidget | undefined>();\n    readonly onDidChangeCurrentTerminal: Event<TerminalWidget | undefined> = this.onDidChangeCurrentTerminalEmitter.event;\n\n    @inject(ContextKeyService)\n    protected readonly contextKeyService: ContextKeyService;\n\n    @postConstruct()\n    protected init(): void {\n        this.shell.onDidChangeCurrentWidget(() => this.updateCurrentTerminal());\n        this.widgetManager.onDidCreateWidget(({ widget }) => {\n            if (widget instanceof TerminalWidget) {\n                this.updateCurrentTerminal();\n                this.onDidCreateTerminalEmitter.fire(widget);\n                this.setLastUsedTerminal(widget);\n            }\n        });\n\n        const terminalFocusKey = this.contextKeyService.createKey<boolean>('terminalFocus', false);\n        const terminalSearchToggle = this.contextKeyService.createKey<boolean>('terminalHideSearch', false);\n        const updateFocusKey = () => {\n            terminalFocusKey.set(this.shell.activeWidget instanceof TerminalWidget);\n            terminalSearchToggle.set(this.terminalHideSearch);\n        };\n        updateFocusKey();\n        this.shell.onDidChangeActiveWidget(updateFocusKey);\n\n        this.terminalWatcher.onStoreTerminalEnvVariablesRequested(data => {\n            this.storageService.setData(ENVIRONMENT_VARIABLE_COLLECTIONS_KEY, data);\n        });\n        this.terminalWatcher.onUpdateTerminalEnvVariablesRequested(() => {\n            this.storageService.getData<string>(ENVIRONMENT_VARIABLE_COLLECTIONS_KEY).then(data => {\n                if (data) {\n                    this.shellTerminalServer.restorePersisted(data);\n                }\n            });\n        });\n    }\n\n    get terminalHideSearch(): boolean {\n        if (!(this.shell.activeWidget instanceof TerminalWidget)) {\n            return false;\n        }\n        const searchWidget = this.shell.activeWidget.getSearchBox();\n        return searchWidget.isVisible;\n    }\n\n    async onStart(app: FrontendApplication): Promise<void> {\n        this.contributeDefaultProfiles();\n\n        this.terminalPreferences.onPreferenceChanged(e => {\n            if (e.preferenceName.startsWith('terminal.integrated.')) {\n                this.mergePreferencesPromise = this.mergePreferencesPromise.finally(() => this.mergePreferences());\n            }\n        });\n        this.mergePreferencesPromise = this.mergePreferencesPromise.finally(() => this.mergePreferences());\n\n        // extension contributions get read after this point: need to set the default profile if necessary\n        this.profileService.onAdded(id => {\n            let defaultProfileId: string | undefined;\n            switch (OS.backend.type()) {\n                case OS.Type.Windows: {\n                    defaultProfileId = this.terminalPreferences['terminal.integrated.defaultProfile.windows'];\n                    break;\n                }\n                case OS.Type.Linux: {\n                    defaultProfileId = this.terminalPreferences['terminal.integrated.defaultProfile.linux'];\n                    break;\n                }\n                case OS.Type.OSX: {\n                    defaultProfileId = this.terminalPreferences['terminal.integrated.defaultProfile.osx'];\n                    break;\n                }\n            }\n            if (defaultProfileId) {\n                this.profileService.setDefaultProfile(defaultProfileId);\n            }\n        });\n    }\n\n    async contributeDefaultProfiles(): Promise<void> {\n        if (OS.backend.isWindows) {\n            this.contributedProfileStore.registerTerminalProfile('cmd', new ShellTerminalProfile(this, {\n                shellPath: await this.resolveShellPath([\n                    '${env:windir}\\\\Sysnative\\\\cmd.exe',\n                    '${env:windir}\\\\System32\\\\cmd.exe'\n                ])!\n            }));\n        } else {\n            this.contributedProfileStore.registerTerminalProfile('SHELL', new ShellTerminalProfile(this, {\n                shellPath: await this.resolveShellPath('${SHELL}')!,\n                shellArgs: ['-l'],\n                iconClass: 'codicon codicon-terminal'\n            }));\n        }\n\n        // contribute default profiles based on legacy preferences\n    }\n\n    protected async mergePreferences(): Promise<void> {\n        let profiles: Profiles;\n        let defaultProfile: string;\n        let legacyShellPath: string | undefined;\n        let legacyShellArgs: string[] | undefined;\n        const removed = new Set(this.userProfileStore.all.map(([id, profile]) => id));\n        switch (OS.backend.type()) {\n            case OS.Type.Windows: {\n                profiles = this.terminalPreferences['terminal.integrated.profiles.windows'];\n                defaultProfile = this.terminalPreferences['terminal.integrated.defaultProfile.windows'];\n                legacyShellPath = this.terminalPreferences['terminal.integrated.shell.windows'] ?? undefined;\n                legacyShellArgs = this.terminalPreferences['terminal.integrated.shellArgs.windows'];\n                break;\n            }\n            case OS.Type.Linux: {\n                profiles = this.terminalPreferences['terminal.integrated.profiles.linux'];\n                defaultProfile = this.terminalPreferences['terminal.integrated.defaultProfile.linux'];\n                legacyShellPath = this.terminalPreferences['terminal.integrated.shell.linux'] ?? undefined;\n                legacyShellArgs = this.terminalPreferences['terminal.integrated.shellArgs.linux'];\n                break;\n            }\n            case OS.Type.OSX: {\n                profiles = this.terminalPreferences['terminal.integrated.profiles.osx'];\n                defaultProfile = this.terminalPreferences['terminal.integrated.defaultProfile.osx'];\n                legacyShellPath = this.terminalPreferences['terminal.integrated.shell.osx'] ?? undefined;\n                legacyShellArgs = this.terminalPreferences['terminal.integrated.shellArgs.osx'];\n                break;\n            }\n        }\n        if (profiles) {\n            for (const id of Object.getOwnPropertyNames(profiles)) {\n                const profile = profiles[id];\n                removed.delete(id);\n                if (profile) {\n                    const shellPath = await this.resolveShellPath(profile.path);\n\n                    if (shellPath) {\n                        const options: TerminalWidgetOptions = {\n                            shellPath: shellPath,\n                            shellArgs: profile.args ? await this.variableResolver.resolve(profile.args) : undefined,\n                            useServerTitle: profile.overrideName ? false : undefined,\n                            env: profile.env ? await this.variableResolver.resolve(profile.env) : undefined,\n                            title: profile.overrideName ? id : undefined\n                        };\n\n                        this.userProfileStore.registerTerminalProfile(id, new ShellTerminalProfile(this, options));\n                    }\n                } else {\n                    this.userProfileStore.registerTerminalProfile(id, NULL_PROFILE);\n                }\n            }\n        }\n\n        if (legacyShellPath) {\n            this.userProfileStore.registerTerminalProfile('Legacy Shell Preferences', new ShellTerminalProfile(this, {\n                shellPath: legacyShellPath!,\n                shellArgs: legacyShellArgs\n            }));\n            // if no other default is set, use the legacy preferences as default if they exist\n            this.profileService.setDefaultProfile('Legacy Shell Preferences');\n        }\n\n        if (defaultProfile && this.profileService.getProfile(defaultProfile)) {\n            this.profileService.setDefaultProfile(defaultProfile);\n        }\n\n        for (const id of removed) {\n            this.userProfileStore.unregisterTerminalProfile(id);\n        }\n    }\n\n    protected async resolveShellPath(path: string | string[] | undefined): Promise<string | undefined> {\n        if (!path) {\n            return undefined;\n        }\n        if (typeof path === 'string') {\n            path = [path];\n        }\n        for (const p of path) {\n            const resolved = await this.variableResolver.resolve(p);\n            if (resolved) {\n                const resolvedURI = URI.fromFilePath(resolved);\n                if (await this.fileService.exists(resolvedURI)) {\n                    return resolved;\n                }\n            }\n        }\n        return undefined;\n    }\n\n    onWillStop(): OnWillStopAction<number> | undefined {\n        const preferenceValue = this.terminalPreferences['terminal.integrated.confirmOnExit'];\n        if (preferenceValue !== 'never') {\n            const allTerminals = this.widgetManager.getWidgets(TERMINAL_WIDGET_FACTORY_ID) as TerminalWidget[];\n            if (allTerminals.length) {\n                return {\n                    prepare: async () => {\n                        if (preferenceValue === 'always') {\n                            return allTerminals.length;\n                        } else {\n                            const activeTerminals = await Promise.all(allTerminals.map(widget => widget.hasChildProcesses()))\n                                .then(hasChildProcesses => hasChildProcesses.filter(hasChild => hasChild));\n                            return activeTerminals.length;\n                        }\n                    },\n                    action: async activeTerminalCount => activeTerminalCount === 0 || this.confirmExitWithActiveTerminals(activeTerminalCount),\n                    reason: 'Active integrated terminal',\n                };\n            }\n        }\n    }\n\n    protected async confirmExitWithActiveTerminals(activeTerminalCount: number): Promise<boolean> {\n        const msg = activeTerminalCount === 1\n            ? nls.localizeByDefault('Do you want to terminate the active terminal session?')\n            : nls.localizeByDefault('Do you want to terminate the {0} active terminal sessions?', activeTerminalCount);\n        const safeToExit = await new ConfirmDialog({\n            title: '',\n            msg,\n            ok: nls.localizeByDefault('Terminate'),\n            cancel: Dialog.CANCEL,\n        }).open();\n        return safeToExit === true;\n    }\n\n    protected _currentTerminal: TerminalWidget | undefined;\n    get currentTerminal(): TerminalWidget | undefined {\n        return this._currentTerminal;\n    }\n    protected setCurrentTerminal(current: TerminalWidget | undefined): void {\n        if (this._currentTerminal !== current) {\n            this._currentTerminal = current;\n            this.onDidChangeCurrentTerminalEmitter.fire(this._currentTerminal);\n        }\n    }\n    protected updateCurrentTerminal(): void {\n        const widget = this.shell.currentWidget;\n        if (widget instanceof TerminalWidget) {\n            this.setCurrentTerminal(widget);\n        } else if (!this._currentTerminal || !this._currentTerminal.isVisible) {\n            this.setCurrentTerminal(undefined);\n        }\n    }\n\n    // IDs of the most recently used terminals\n    protected mostRecentlyUsedTerminalEntries: { id: string, disposables: DisposableCollection }[] = [];\n\n    protected getLastUsedTerminalId(): string | undefined {\n        const mostRecent = this.mostRecentlyUsedTerminalEntries[this.mostRecentlyUsedTerminalEntries.length - 1];\n        if (mostRecent) {\n            return mostRecent.id;\n        }\n    }\n\n    get lastUsedTerminal(): TerminalWidget | undefined {\n        const id = this.getLastUsedTerminalId();\n        if (id) {\n            return this.getById(id);\n        }\n    }\n\n    protected setLastUsedTerminal(lastUsedTerminal: TerminalWidget): void {\n        const lastUsedTerminalId = lastUsedTerminal.id;\n        const entryIndex = this.mostRecentlyUsedTerminalEntries.findIndex(entry => entry.id === lastUsedTerminalId);\n        let toDispose: DisposableCollection | undefined;\n        if (entryIndex >= 0) {\n            toDispose = this.mostRecentlyUsedTerminalEntries[entryIndex].disposables;\n            this.mostRecentlyUsedTerminalEntries.splice(entryIndex, 1);\n        } else {\n            toDispose = new DisposableCollection();\n            toDispose.push(\n                lastUsedTerminal.onDidChangeVisibility((isVisible: boolean) => {\n                    if (isVisible) {\n                        this.setLastUsedTerminal(lastUsedTerminal);\n                    }\n                })\n            );\n            toDispose.push(\n                lastUsedTerminal.onDidDispose(() => {\n                    const index = this.mostRecentlyUsedTerminalEntries.findIndex(entry => entry.id === lastUsedTerminalId);\n                    if (index >= 0) {\n                        this.mostRecentlyUsedTerminalEntries[index].disposables.dispose();\n                        this.mostRecentlyUsedTerminalEntries.splice(index, 1);\n                    }\n                })\n            );\n        }\n\n        const newEntry = { id: lastUsedTerminalId, disposables: toDispose };\n        if (lastUsedTerminal.isVisible) {\n            this.mostRecentlyUsedTerminalEntries.push(newEntry);\n        } else {\n            this.mostRecentlyUsedTerminalEntries = [newEntry, ...this.mostRecentlyUsedTerminalEntries];\n        }\n    }\n\n    get all(): TerminalWidget[] {\n        return this.widgetManager.getWidgets(TERMINAL_WIDGET_FACTORY_ID) as TerminalWidget[];\n    }\n\n    getById(id: string): TerminalWidget | undefined {\n        return this.all.find(terminal => terminal.id === id);\n    }\n\n    getByTerminalId(terminalId: number): TerminalWidget | undefined {\n        return this.all.find(terminal => terminal.terminalId === terminalId);\n    }\n\n    getDefaultShell(): Promise<string> {\n        return this.shellTerminalServer.getDefaultShell();\n    }\n\n    registerCommands(commands: CommandRegistry): void {\n        commands.registerCommand(TerminalCommands.NEW, {\n            execute: (widget?: Widget) => {\n                const fromWidget = this.withWidget(widget, terminal => terminal);\n                const ref = fromWidget === false ? this.lastUsedTerminal : fromWidget;\n                const widgetOptions = ref ? { ref, mode: 'tab-after' as const } : undefined;\n                return this.openTerminal(widgetOptions);\n            }\n        });\n\n        commands.registerCommand(TerminalCommands.PROFILE_NEW, {\n            execute: async () => {\n                const profile = await this.selectTerminalProfile(nls.localize('theia/terminal/selectProfile', 'Select a profile for the new terminal'));\n                if (!profile) {\n                    return;\n                }\n                this.openTerminal(undefined, profile[1]);\n            }\n        });\n\n        commands.registerCommand(TerminalCommands.PROFILE_DEFAULT, {\n            execute: () => this.chooseDefaultProfile()\n        });\n\n        commands.registerCommand(TerminalCommands.NEW_ACTIVE_WORKSPACE, {\n            execute: () => this.openActiveWorkspaceTerminal()\n        });\n        commands.registerCommand(TerminalCommands.SPLIT, {\n            execute: (widget?: Widget) => this.withWidget(widget, terminal => this.splitTerminal(terminal)),\n            isEnabled: w => this.withWidget(w, () => true),\n            isVisible: w => this.withWidget(w, () => true),\n        });\n        commands.registerCommand(TerminalCommands.TERMINAL_CLEAR);\n        commands.registerHandler(TerminalCommands.TERMINAL_CLEAR.id, {\n            execute: () => this.currentTerminal?.clearOutput()\n        });\n        commands.registerCommand(TerminalCommands.TERMINAL_CONTEXT, UriAwareCommandHandler.MonoSelect(this.selectionService, {\n            execute: uri => this.openInTerminal(uri)\n        }));\n        commands.registerCommand(TerminalCommands.TERMINAL_FIND_TEXT);\n        commands.registerHandler(TerminalCommands.TERMINAL_FIND_TEXT.id, {\n            isEnabled: () => {\n                if (this.shell.activeWidget instanceof TerminalWidget) {\n                    return !this.shell.activeWidget.getSearchBox().isVisible;\n                }\n                return false;\n            },\n            execute: () => {\n                const termWidget = (this.shell.activeWidget as TerminalWidget);\n                const terminalSearchBox = termWidget.getSearchBox();\n                terminalSearchBox.show();\n            }\n        });\n        commands.registerCommand(TerminalCommands.TERMINAL_FIND_TEXT_CANCEL);\n        commands.registerHandler(TerminalCommands.TERMINAL_FIND_TEXT_CANCEL.id, {\n            isEnabled: () => {\n                if (this.shell.activeWidget instanceof TerminalWidget) {\n                    return this.shell.activeWidget.getSearchBox().isVisible;\n                }\n                return false;\n            },\n            execute: () => {\n                const termWidget = (this.shell.activeWidget as TerminalWidget);\n                const terminalSearchBox = termWidget.getSearchBox();\n                terminalSearchBox.hide();\n            }\n        });\n        commands.registerCommand(TerminalCommands.SCROLL_LINE_UP, {\n            isEnabled: () => this.shell.activeWidget instanceof TerminalWidget,\n            isVisible: () => false,\n            execute: () => {\n                (this.shell.activeWidget as TerminalWidget).scrollLineUp();\n            }\n        });\n        commands.registerCommand(TerminalCommands.SCROLL_LINE_DOWN, {\n            isEnabled: () => this.shell.activeWidget instanceof TerminalWidget,\n            isVisible: () => false,\n            execute: () => {\n                (this.shell.activeWidget as TerminalWidget).scrollLineDown();\n            }\n        });\n        commands.registerCommand(TerminalCommands.SCROLL_TO_TOP, {\n            isEnabled: () => this.shell.activeWidget instanceof TerminalWidget,\n            isVisible: () => false,\n            execute: () => {\n                (this.shell.activeWidget as TerminalWidget).scrollToTop();\n            }\n        });\n        commands.registerCommand(TerminalCommands.SCROLL_PAGE_UP, {\n            isEnabled: () => this.shell.activeWidget instanceof TerminalWidget,\n            isVisible: () => false,\n            execute: () => {\n                (this.shell.activeWidget as TerminalWidget).scrollPageUp();\n            }\n        });\n        commands.registerCommand(TerminalCommands.SCROLL_PAGE_DOWN, {\n            isEnabled: () => this.shell.activeWidget instanceof TerminalWidget,\n            isVisible: () => false,\n            execute: () => {\n                (this.shell.activeWidget as TerminalWidget).scrollPageDown();\n            }\n        });\n        commands.registerCommand(TerminalCommands.TOGGLE_TERMINAL, {\n            execute: () => this.toggleTerminal()\n        });\n        commands.registerCommand(TerminalCommands.KILL_TERMINAL, {\n            isEnabled: () => !!this.currentTerminal,\n            execute: () => this.currentTerminal?.close()\n        });\n        commands.registerCommand(TerminalCommands.SELECT_ALL, {\n            isEnabled: () => !!this.currentTerminal,\n            execute: () => this.currentTerminal?.selectAll()\n        });\n    }\n\n    protected toggleTerminal(): void {\n        const terminals = this.shell.getWidgets('bottom').filter(w => w instanceof TerminalWidget);\n\n        if (terminals.length === 0) {\n            this.openTerminal();\n            return;\n        }\n\n        if (!this.shell.isExpanded('bottom')) {\n            this.shell.expandPanel('bottom');\n            terminals[0].activate();\n        } else {\n            const visibleTerminal = terminals.find(t => t.isVisible);\n            if (!visibleTerminal) {\n                this.shell.bottomPanel.activateWidget(terminals[0]);\n            } else if (this.shell.activeWidget !== visibleTerminal) {\n                this.shell.bottomPanel.activateWidget(visibleTerminal);\n            } else {\n                this.shell.collapsePanel('bottom');\n            }\n        }\n\n    }\n\n    async openInTerminal(uri: URI): Promise<void> {\n        // Determine folder path of URI\n        let stat: FileStat;\n        try {\n            stat = await this.fileService.resolve(uri);\n        } catch {\n            return;\n        }\n\n        // Use folder if a file was selected\n        const cwd = (stat.isDirectory) ? uri.toString() : uri.parent.toString();\n\n        // Open terminal\n        const termWidget = await this.newTerminal({ cwd });\n        termWidget.start();\n        this.open(termWidget);\n    }\n\n    registerMenus(menus: MenuModelRegistry): void {\n        menus.registerSubmenu(TerminalMenus.TERMINAL, TerminalWidgetImpl.LABEL);\n        menus.registerMenuAction(TerminalMenus.TERMINAL_NEW, {\n            commandId: TerminalCommands.NEW.id,\n            label: nls.localizeByDefault('New Terminal'),\n            order: '0'\n        });\n        menus.registerMenuAction(TerminalMenus.TERMINAL_NEW, {\n            commandId: TerminalCommands.PROFILE_NEW.id,\n            label: nls.localize('theia/terminal/profileNew', 'New Terminal (With Profile)...'),\n            order: '1'\n        });\n\n        menus.registerMenuAction(TerminalMenus.TERMINAL_NEW, {\n            commandId: TerminalCommands.PROFILE_DEFAULT.id,\n            label: nls.localize('theia/terminal/profileDefault', 'Choose Default Profile...'),\n            order: '3'\n        });\n        menus.registerMenuAction(TerminalMenus.TERMINAL_NEW, {\n            commandId: TerminalCommands.SPLIT.id,\n            order: '3'\n        });\n        menus.registerMenuAction(TerminalMenus.TERMINAL_NAVIGATOR_CONTEXT_MENU, {\n            commandId: TerminalCommands.TERMINAL_CONTEXT.id,\n            order: 'z'\n        });\n        menus.registerMenuAction(TerminalMenus.TERMINAL_OPEN_EDITORS_CONTEXT_MENU, {\n            commandId: TerminalCommands.TERMINAL_CONTEXT.id,\n            order: 'z'\n        });\n\n        menus.registerMenuAction([...TerminalMenus.TERMINAL_CONTEXT_MENU, '_1'], {\n            commandId: TerminalCommands.NEW_ACTIVE_WORKSPACE.id,\n            label: nls.localizeByDefault('New Terminal')\n        });\n        menus.registerMenuAction([...TerminalMenus.TERMINAL_CONTEXT_MENU, '_1'], {\n            commandId: TerminalCommands.SPLIT.id\n        });\n        menus.registerMenuAction([...TerminalMenus.TERMINAL_CONTEXT_MENU, '_2'], {\n            commandId: CommonCommands.COPY.id\n        });\n        menus.registerMenuAction([...TerminalMenus.TERMINAL_CONTEXT_MENU, '_2'], {\n            commandId: CommonCommands.PASTE.id\n        });\n        menus.registerMenuAction([...TerminalMenus.TERMINAL_CONTEXT_MENU, '_2'], {\n            commandId: TerminalCommands.SELECT_ALL.id\n        });\n        menus.registerMenuAction([...TerminalMenus.TERMINAL_CONTEXT_MENU, '_3'], {\n            commandId: TerminalCommands.TERMINAL_CLEAR.id\n        });\n        menus.registerMenuAction([...TerminalMenus.TERMINAL_CONTEXT_MENU, '_4'], {\n            commandId: TerminalCommands.KILL_TERMINAL.id\n        });\n\n        menus.registerSubmenu(TerminalMenus.TERMINAL_CONTRIBUTIONS, '');\n\n        menus.registerSubmenu(TerminalMenus.TERMINAL_TITLE_CONTRIBUTIONS, '', { when: 'isTerminalTab' });\n    }\n\n    registerToolbarItems(toolbar: TabBarToolbarRegistry): void {\n        toolbar.registerItem({\n            id: TerminalCommands.NEW.id,\n            command: TerminalCommands.NEW.id,\n            icon: codicon('add'),\n            tooltip: TerminalCommands.NEW.label,\n            isVisible: w => this.withWidget(w, () => true),\n        });\n        toolbar.registerItem({\n            id: TerminalCommands.SPLIT.id,\n            command: TerminalCommands.SPLIT.id,\n            icon: codicon('split-horizontal'),\n            tooltip: TerminalCommands.SPLIT.label\n        });\n    }\n\n    registerKeybindings(keybindings: KeybindingRegistry): void {\n        /* Register passthrough keybindings for combinations recognized by\n           xterm.js and converted to control characters.\n             See: https://github.com/xtermjs/xterm.js/blob/v3/src/Terminal.ts#L1684 */\n\n        /* Register ctrl + k (the passed Key) as a passthrough command in the\n           context of the terminal.  */\n        const regCtrl = (k: { keyCode: number, code: string }) => {\n            keybindings.registerKeybinding({\n                command: KeybindingRegistry.PASSTHROUGH_PSEUDO_COMMAND,\n                keybinding: KeyCode.createKeyCode({ key: k, ctrl: true }).toString(),\n                when: 'terminalFocus',\n            });\n        };\n\n        /* Register alt + k (the passed Key) as a passthrough command in the\n           context of the terminal.  */\n        const regAlt = (k: { keyCode: number, code: string }) => {\n            keybindings.registerKeybinding({\n                command: KeybindingRegistry.PASSTHROUGH_PSEUDO_COMMAND,\n                keybinding: KeyCode.createKeyCode({ key: k, alt: true }).toString(),\n                when: 'terminalFocus'\n            });\n        };\n\n        /* ctrl-space (000 - NUL).  */\n        regCtrl(Key.SPACE);\n\n        /* ctrl-A (001/1/0x1) through ctrl-Z (032/26/0x1A).  */\n        for (let i = 0; i < 26; i++) {\n            regCtrl({\n                keyCode: Key.KEY_A.keyCode + i,\n                code: 'Key' + String.fromCharCode('A'.charCodeAt(0) + i)\n            });\n        }\n\n        /* ctrl-[ or ctrl-3 (033/27/0x1B - ESC).  */\n        regCtrl(Key.BRACKET_LEFT);\n        regCtrl(Key.DIGIT3);\n\n        /* ctrl-\\ or ctrl-4 (034/28/0x1C - FS).  */\n        regCtrl(Key.BACKSLASH);\n        regCtrl(Key.DIGIT4);\n\n        /* ctrl-] or ctrl-5 (035/29/0x1D - GS).  */\n        regCtrl(Key.BRACKET_RIGHT);\n        regCtrl(Key.DIGIT5);\n\n        /* ctrl-6 (036/30/0x1E - RS).  */\n        regCtrl(Key.DIGIT6);\n\n        /* ctrl-7 (037/31/0x1F - US).  */\n        regCtrl(Key.DIGIT7);\n\n        /* ctrl-8 (177/127/0x7F - DEL).  */\n        regCtrl(Key.DIGIT8);\n\n        /* alt-A (0x1B 0x62) through alt-Z (0x1B 0x7A).  */\n        for (let i = 0; i < 26; i++) {\n            regAlt({\n                keyCode: Key.KEY_A.keyCode + i,\n                code: 'Key' + String.fromCharCode('A'.charCodeAt(0) + i)\n            });\n        }\n\n        /* alt-` (0x1B 0x60).  */\n        regAlt(Key.BACKQUOTE);\n\n        /* alt-0 (0x1B 0x30) through alt-9 (0x1B 0x39).  */\n        for (let i = 0; i < 10; i++) {\n            regAlt({\n                keyCode: Key.DIGIT0.keyCode + i,\n                code: 'Digit' + String.fromCharCode('0'.charCodeAt(0) + i)\n            });\n        }\n        if (isOSX) {\n            // selectAll on OSX\n            keybindings.registerKeybinding({\n                command: KeybindingRegistry.PASSTHROUGH_PSEUDO_COMMAND,\n                keybinding: 'ctrlcmd+a',\n                when: 'terminalFocus'\n            });\n        }\n\n        keybindings.registerKeybinding({\n            command: TerminalCommands.NEW.id,\n            keybinding: 'ctrl+shift+`'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.NEW_ACTIVE_WORKSPACE.id,\n            keybinding: 'ctrl+`'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.TERMINAL_CLEAR.id,\n            keybinding: 'ctrlcmd+k',\n            when: 'terminalFocus'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.TERMINAL_FIND_TEXT.id,\n            keybinding: 'ctrlcmd+f',\n            when: 'terminalFocus'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.TERMINAL_FIND_TEXT_CANCEL.id,\n            keybinding: 'esc',\n            when: 'terminalHideSearch'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.SCROLL_LINE_UP.id,\n            keybinding: 'ctrl+shift+up',\n            when: 'terminalFocus'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.SCROLL_LINE_DOWN.id,\n            keybinding: 'ctrl+shift+down',\n            when: 'terminalFocus'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.SCROLL_TO_TOP.id,\n            keybinding: 'shift-home',\n            when: 'terminalFocus'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.SCROLL_PAGE_UP.id,\n            keybinding: 'shift-pageUp',\n            when: 'terminalFocus'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.SCROLL_PAGE_DOWN.id,\n            keybinding: 'shift-pageDown',\n            when: 'terminalFocus'\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.TOGGLE_TERMINAL.id,\n            keybinding: 'ctrl+`',\n        });\n        keybindings.registerKeybinding({\n            command: TerminalCommands.SELECT_ALL.id,\n            keybinding: 'ctrlcmd+a',\n            when: 'terminalFocus'\n        });\n    }\n\n    async newTerminal(options: TerminalWidgetOptions): Promise<TerminalWidget> {\n        const widget = <TerminalWidget>await this.widgetManager.getOrCreateWidget(TERMINAL_WIDGET_FACTORY_ID, <TerminalWidgetFactoryOptions>{\n            created: new Date().toISOString(),\n            ...options\n        });\n        return widget;\n    }\n\n    // TODO: reuse WidgetOpenHandler.open\n    open(widget: TerminalWidget, options?: WidgetOpenerOptions): void {\n        const area = widget.location === TerminalLocation.Editor ? 'main' : 'bottom';\n        const widgetOptions: ApplicationShell.WidgetOptions = { area: area, ...options?.widgetOptions };\n        let preserveFocus = false;\n\n        if (typeof widget.location === 'object') {\n            if ('parentTerminal' in widget.location) {\n                widgetOptions.ref = this.getById(widget.location.parentTerminal);\n                widgetOptions.mode = 'split-right';\n            } else if ('viewColumn' in widget.location) {\n                preserveFocus = widget.location.preserveFocus ?? false;\n                switch (widget.location.viewColumn) {\n                    case ViewColumn.Active:\n                        widgetOptions.ref = this.shell.currentWidget;\n                        widgetOptions.mode = 'tab-after';\n                        break;\n                    case ViewColumn.Beside:\n                        widgetOptions.ref = this.shell.currentWidget;\n                        widgetOptions.mode = 'split-right';\n                        break;\n                    default:\n                        widgetOptions.area = 'main';\n                        const mainAreaTerminals = this.shell.getWidgets('main').filter(w => w instanceof TerminalWidget && w.isVisible);\n                        const column = Math.min(widget.location.viewColumn, mainAreaTerminals.length);\n                        widgetOptions.mode = widget.location.viewColumn <= mainAreaTerminals.length ? 'split-left' : 'split-right';\n                        widgetOptions.ref = mainAreaTerminals[column - 1];\n                }\n            }\n        }\n\n        const op: WidgetOpenerOptions = {\n            mode: 'activate',\n            ...options,\n            widgetOptions: widgetOptions\n        };\n        if (!widget.isAttached) {\n            this.shell.addWidget(widget, op.widgetOptions);\n        }\n        if (op.mode === 'activate' && !preserveFocus) {\n            this.shell.activateWidget(widget.id);\n        } else if (op.mode === 'reveal' || preserveFocus) {\n            this.shell.revealWidget(widget.id);\n        }\n    }\n\n    protected async selectTerminalCwd(): Promise<string | undefined> {\n        return new Promise(async resolve => {\n            const roots = this.workspaceService.tryGetRoots();\n            if (roots.length === 0) {\n                resolve(undefined);\n            } else if (roots.length === 1) {\n                resolve(roots[0].resource.toString());\n            } else {\n                const items = roots.map(({ resource }) => ({\n                    label: this.labelProvider.getName(resource),\n                    description: this.labelProvider.getLongName(resource),\n                    resource\n                }));\n                const selectedItem = await this.quickInputService?.showQuickPick(items, {\n                    placeholder: nls.localizeByDefault('Select current working directory for new terminal')\n                });\n                resolve(selectedItem?.resource?.toString());\n            }\n        });\n    }\n\n    protected async selectTerminalProfile(placeholder: string): Promise<[string, TerminalProfile] | undefined> {\n        return new Promise(async resolve => {\n            const profiles = this.profileService.all;\n            if (profiles.length === 0) {\n                resolve(undefined);\n            } else {\n                const items = profiles.map(([id, profile]) => ({\n                    label: id,\n                    profile\n                }));\n                const selectedItem = await this.quickInputService?.showQuickPick(items, {\n                    placeholder\n                });\n                resolve(selectedItem ? [selectedItem.label, selectedItem.profile] : undefined);\n            }\n        });\n    }\n\n    protected async splitTerminal(referenceTerminal?: TerminalWidget): Promise<void> {\n        if (referenceTerminal || this.currentTerminal) {\n            const ref = referenceTerminal ?? this.currentTerminal;\n            await this.openTerminal({ ref, mode: 'split-right' });\n        }\n    }\n\n    protected async openTerminal(options?: ApplicationShell.WidgetOptions, terminalProfile?: TerminalProfile): Promise<void> {\n        let profile = terminalProfile;\n        if (!terminalProfile) {\n            profile = this.profileService.defaultProfile;\n            if (!profile) {\n                throw new Error('There are no profiles registered');\n            }\n        }\n\n        if (profile instanceof ShellTerminalProfile) {\n            if (this.workspaceService.workspace) {\n                const cwd = await this.selectTerminalCwd();\n                if (!cwd) {\n                    return;\n                }\n                profile = profile.modify({ cwd });\n            }\n        }\n\n        const termWidget = await profile?.start();\n        if (!!termWidget) {\n            this.open(termWidget, { widgetOptions: options });\n        }\n    }\n\n    protected async chooseDefaultProfile(): Promise<void> {\n        const result = await this.selectTerminalProfile(nls.localizeByDefault('Select your default terminal profile'));\n        if (!result) {\n            return;\n        }\n\n        this.preferenceService.set(`terminal.integrated.defaultProfile.${OS.backend.type().toLowerCase()}`, result[0], PreferenceScope.User);\n    }\n\n    protected async openActiveWorkspaceTerminal(options?: ApplicationShell.WidgetOptions): Promise<void> {\n        const termWidget = await this.newTerminal({});\n        termWidget.start();\n        this.open(termWidget, { widgetOptions: options });\n    }\n\n    protected withWidget<T>(widget: Widget | undefined, fn: (widget: TerminalWidget) => T): T | false {\n        if (widget instanceof TerminalWidget) {\n            return fn(widget);\n        }\n        return false;\n    }\n\n    /**\n     * It should be aligned with https://code.visualstudio.com/api/references/theme-color#integrated-terminal-colors\n     */\n    registerColors(colors: ColorRegistry): void {\n        colors.register({\n            id: 'terminal.background',\n            defaults: {\n                dark: 'panel.background',\n                light: 'panel.background',\n                hcDark: 'panel.background',\n                hcLight: 'panel.background'\n            },\n            description: nls.localizeByDefault('The background color of the terminal, this allows coloring the terminal differently to the panel.')\n        });\n        colors.register({\n            id: 'terminal.foreground',\n            defaults: {\n                light: '#333333',\n                dark: '#CCCCCC',\n                hcDark: '#FFFFFF',\n                hcLight: '#292929'\n            },\n            description: nls.localizeByDefault('The foreground color of the terminal.')\n        });\n        colors.register({\n            id: 'terminalCursor.foreground',\n            description: nls.localizeByDefault('The foreground color of the terminal cursor.')\n        });\n        colors.register({\n            id: 'terminalCursor.background',\n            description: nls.localizeByDefault('The background color of the terminal cursor. Allows customizing the color of a character overlapped by a block cursor.')\n        });\n        colors.register({\n            id: 'terminal.selectionBackground',\n            defaults: {\n                light: 'editor.selectionBackground',\n                dark: 'editor.selectionBackground',\n                hcDark: 'editor.selectionBackground',\n                hcLight: 'editor.selectionBackground'\n            },\n            description: nls.localizeByDefault('The selection background color of the terminal.')\n        });\n        colors.register({\n            id: 'terminal.inactiveSelectionBackground',\n            defaults: {\n                light: Color.transparent('terminal.selectionBackground', 0.5),\n                dark: Color.transparent('terminal.selectionBackground', 0.5),\n                hcDark: Color.transparent('terminal.selectionBackground', 0.7),\n                hcLight: Color.transparent('terminal.selectionBackground', 0.5),\n            },\n            description: nls.localizeByDefault('The selection background color of the terminal when it does not have focus.')\n        });\n        colors.register({\n            id: 'terminal.selectionForeground',\n            defaults: {\n                light: undefined,\n                dark: undefined,\n                hcDark: '#000000',\n                hcLight: '#ffffff'\n            },\n            // eslint-disable-next-line max-len\n            description: nls.localizeByDefault('The selection foreground color of the terminal. When this is null the selection foreground will be retained and have the minimum contrast ratio feature applied.')\n        });\n        colors.register({\n            id: 'terminal.border',\n            defaults: {\n                light: 'panel.border',\n                dark: 'panel.border',\n                hcDark: 'panel.border',\n                hcLight: 'panel.border'\n            },\n            description: nls.localizeByDefault('The color of the border that separates split panes within the terminal. This defaults to panel.border.')\n        });\n        // eslint-disable-next-line guard-for-in\n        for (const id in terminalAnsiColorMap) {\n            const entry = terminalAnsiColorMap[id];\n            const colorName = id.substring(13);\n            colors.register({\n                id,\n                defaults: entry.defaults,\n                description: nls.localizeByDefault(\"'{0}' ANSI color in the terminal.\", colorName)\n            });\n        }\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2022 STMicroelectronics and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Emitter, Event } from '@theia/core';\nimport { injectable, unmanaged } from '@theia/core/shared/inversify';\nimport { TerminalWidget } from './base/terminal-widget';\nimport { ShellTerminalProfile } from './shell-terminal-profile';\n\nexport const TerminalProfileService = Symbol('TerminalProfileService');\nexport const ContributedTerminalProfileStore = Symbol('ContributedTerminalProfileStore');\nexport const UserTerminalProfileStore = Symbol('UserTerminalProfileStore');\n\nexport interface TerminalProfile {\n    start(): Promise<TerminalWidget>;\n}\n\nexport const NULL_PROFILE: TerminalProfile = {\n    start: async () => { throw new Error('you cannot start a null profile'); }\n};\n\nexport interface TerminalProfileService {\n    onAdded: Event<string>;\n    onRemoved: Event<string>;\n    getProfile(id: string): TerminalProfile | undefined\n    readonly all: [string, TerminalProfile][];\n    setDefaultProfile(id: string): void;\n    readonly onDidChangeDefaultShell: Event<string>;\n    readonly defaultProfile: TerminalProfile | undefined;\n}\n\nexport interface TerminalProfileStore {\n    onAdded: Event<[string, TerminalProfile]>;\n    onRemoved: Event<string>;\n    registerTerminalProfile(id: string, profile: TerminalProfile): void;\n    unregisterTerminalProfile(id: string): void;\n    hasProfile(id: string): boolean;\n    getProfile(id: string): TerminalProfile | undefined\n    readonly all: [string, TerminalProfile][];\n}\n\n@injectable()\nexport class DefaultProfileStore implements TerminalProfileStore {\n    protected readonly onAddedEmitter: Emitter<[string, TerminalProfile]> = new Emitter();\n    protected readonly onRemovedEmitter: Emitter<string> = new Emitter();\n    protected readonly profiles: Map<string, TerminalProfile> = new Map();\n\n    onAdded: Event<[string, TerminalProfile]> = this.onAddedEmitter.event;\n    onRemoved: Event<string> = this.onRemovedEmitter.event;\n\n    registerTerminalProfile(id: string, profile: TerminalProfile): void {\n        this.profiles.set(id, profile);\n        this.onAddedEmitter.fire([id, profile]);\n    }\n    unregisterTerminalProfile(id: string): void {\n        this.profiles.delete(id);\n        this.onRemovedEmitter.fire(id);\n    }\n\n    hasProfile(id: string): boolean {\n        return this.profiles.has(id);\n    }\n\n    getProfile(id: string): TerminalProfile | undefined {\n        return this.profiles.get(id);\n    }\n    get all(): [string, TerminalProfile][] {\n        return [...this.profiles.entries()];\n    }\n}\n\n@injectable()\nexport class DefaultTerminalProfileService implements TerminalProfileService {\n    protected defaultProfileIndex = 0;\n    protected order: string[] = [];\n    protected readonly stores: TerminalProfileStore[];\n\n    protected readonly onAddedEmitter: Emitter<string> = new Emitter();\n    protected readonly onRemovedEmitter: Emitter<string> = new Emitter();\n    protected readonly onDidChangeDefaultShellEmitter: Emitter<string> = new Emitter();\n\n    onAdded: Event<string> = this.onAddedEmitter.event;\n    onRemoved: Event<string> = this.onRemovedEmitter.event;\n    onDidChangeDefaultShell: Event<string> = this.onDidChangeDefaultShellEmitter.event;\n\n    constructor(@unmanaged() ...stores: TerminalProfileStore[]) {\n        this.stores = stores;\n        for (const store of this.stores) {\n            store.onAdded(e => {\n                if (e[1] === NULL_PROFILE) {\n                    this.handleRemoved(e[0]);\n                } else {\n                    this.handleAdded(e[0]);\n                }\n            });\n            store.onRemoved(id => {\n                if (!this.getProfile(id)) {\n                    this.handleRemoved(id);\n                } else {\n                    // we may have removed a null profile\n                    this.handleAdded(id);\n                }\n            });\n        }\n    }\n\n    handleRemoved(id: string): void {\n        const index = this.order.indexOf(id);\n        if (index >= 0 && !this.getProfile(id)) {\n            // the profile was removed, but it's still in the `order` array\n            this.order.splice(index, 1);\n            this.defaultProfileIndex = Math.max(0, Math.min(this.order.length - 1, index));\n            this.onRemovedEmitter.fire(id);\n        }\n    }\n\n    handleAdded(id: string): void {\n        const index = this.order.indexOf(id);\n        if (index < 0) {\n            this.order.push(id);\n            this.onAddedEmitter.fire(id);\n        }\n    }\n\n    get defaultProfile(): TerminalProfile | undefined {\n        const id = this.order[this.defaultProfileIndex];\n        if (id) {\n            return this.getProfile(id);\n        }\n        return undefined;\n    }\n\n    setDefaultProfile(id: string): void {\n        const profile = this.getProfile(id);\n        if (!profile) {\n            throw new Error(`Cannot set default to unknown profile '${id}' `);\n        }\n        this.defaultProfileIndex = this.order.indexOf(id);\n\n        if (profile instanceof ShellTerminalProfile && profile.shellPath) {\n            this.onDidChangeDefaultShellEmitter.fire(profile.shellPath);\n        } else {\n            this.onDidChangeDefaultShellEmitter.fire('');\n        }\n    }\n\n    getProfile(id: string): TerminalProfile | undefined {\n        for (const store of this.stores) {\n            if (store.hasProfile(id)) {\n                const found = store.getProfile(id);\n                return found === NULL_PROFILE ? undefined : found;\n            }\n        }\n        return undefined;\n    }\n\n    getId(profile: TerminalProfile): string | undefined {\n        for (const [id, p] of this.all) {\n            if (p === profile) {\n                return id;\n            }\n        }\n    }\n\n    get all(): [string, TerminalProfile][] {\n        return this.order.filter(id => !!this.getProfile(id)).map(id => [id, this.getProfile(id)!]);\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2017 TypeFox and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { Terminal } from 'xterm';\nimport { FitAddon } from 'xterm-addon-fit';\nimport { WebglAddon } from 'xterm-addon-webgl';\nimport { inject, injectable, named, postConstruct } from '@theia/core/shared/inversify';\nimport { ContributionProvider, Disposable, Event, Emitter, ILogger, DisposableCollection, Channel, OS, generateUuid } from '@theia/core';\nimport {\n    Widget, Message, StatefulWidget, isFirefox, MessageLoop, KeyCode, ExtractableWidget, ContextMenuRenderer,\n    DecorationStyle\n} from '@theia/core/lib/browser';\nimport { isOSX } from '@theia/core/lib/common';\nimport { WorkspaceService } from '@theia/workspace/lib/browser';\nimport { ShellTerminalServerProxy, IShellTerminalPreferences } from '../common/shell-terminal-protocol';\nimport { terminalsPath } from '../common/terminal-protocol';\nimport { IBaseTerminalServer, TerminalProcessInfo, TerminalExitReason } from '../common/base-terminal-protocol';\nimport { TerminalWatcher } from '../common/terminal-watcher';\nimport {\n    TerminalWidgetOptions, TerminalWidget, TerminalDimensions, TerminalExitStatus, TerminalLocationOptions,\n    TerminalLocation,\n    TerminalBuffer\n} from './base/terminal-widget';\nimport { Deferred } from '@theia/core/lib/common/promise-util';\nimport { TerminalPreferences } from '../common/terminal-preferences';\nimport URI from '@theia/core/lib/common/uri';\nimport { TerminalService } from './base/terminal-service';\nimport { TerminalSearchWidgetFactory, TerminalSearchWidget } from './search/terminal-search-widget';\nimport { TerminalCopyOnSelectionHandler } from './terminal-copy-on-selection-handler';\nimport { TerminalThemeService } from './terminal-theme-service';\nimport { CommandLineOptions, ShellCommandBuilder } from '@theia/process/lib/common/shell-command-builder';\nimport { Key } from '@theia/core/lib/browser/keys';\nimport { nls } from '@theia/core/lib/common/nls';\nimport { TerminalMenus } from './terminal-frontend-contribution';\nimport debounce = require('p-debounce');\nimport { MarkdownString, MarkdownStringImpl } from '@theia/core/lib/common/markdown-rendering/markdown-string';\nimport { EnhancedPreviewWidget } from '@theia/core/lib/browser/widgets/enhanced-preview-widget';\nimport { MarkdownRenderer, MarkdownRendererFactory } from '@theia/core/lib/browser/markdown-rendering/markdown-renderer';\nimport { RemoteConnectionProvider, ServiceConnectionProvider } from '@theia/core/lib/browser/messaging/service-connection-provider';\nimport { ColorRegistry } from '@theia/core/lib/browser/color-registry';\nimport { guessShellTypeFromExecutable } from '../common/shell-type';\n\nexport const TERMINAL_WIDGET_FACTORY_ID = 'terminal';\n\nexport interface TerminalWidgetFactoryOptions extends Partial<TerminalWidgetOptions> {\n    /* a unique string per terminal */\n    created: string\n}\n\nexport const TerminalContribution = Symbol('TerminalContribution');\nexport interface TerminalContribution {\n    onCreate(term: TerminalWidgetImpl): void;\n}\n\nclass TerminalBufferImpl implements TerminalBuffer {\n    constructor(private readonly term: Terminal) {\n    }\n\n    get length(): number {\n        return this.term.buffer.active.length;\n    };\n    getLines(start: number, length: number): string[] {\n        const result: string[] = [];\n        for (let i = 0; i < length && this.length - 1 - i >= 0; i++) {\n            result.push(this.term.buffer.active.getLine(this.length - 1 - i)!.translateToString());\n        }\n        return result;\n    }\n\n}\n\n@injectable()\nexport class TerminalWidgetImpl extends TerminalWidget implements StatefulWidget, ExtractableWidget, EnhancedPreviewWidget {\n    readonly isExtractable: boolean = true;\n    secondaryWindow: Window | undefined;\n    location: TerminalLocationOptions;\n\n    static LABEL = nls.localizeByDefault('Terminal');\n\n    exitStatus: TerminalExitStatus | undefined;\n\n    protected terminalKind = 'user';\n    protected _terminalId = -1;\n    protected readonly onTermDidClose = new Emitter<TerminalWidget>();\n    protected fitAddon: FitAddon;\n    protected webglAddon: WebglAddon;\n    protected term: Terminal;\n    protected searchBox: TerminalSearchWidget;\n    protected restored = false;\n    protected closeOnDispose = true;\n    protected waitForConnection: Deferred<Channel> | undefined;\n    protected linkHover: HTMLDivElement;\n    protected linkHoverButton: HTMLAnchorElement;\n    protected lastTouchEnd: TouchEvent | undefined;\n    protected lastMousePosition: { x: number, y: number } | undefined;\n    protected isAttachedCloseListener: boolean = false;\n    protected shown = false;\n    protected enhancedPreviewNode: Node | undefined;\n    protected styleElement: HTMLStyleElement | undefined;\n    override lastCwd = new URI();\n\n    @inject(WorkspaceService) protected readonly workspaceService: WorkspaceService;\n    @inject(RemoteConnectionProvider) protected readonly connectionProvider: ServiceConnectionProvider;\n    @inject(TerminalWidgetOptions) options: TerminalWidgetOptions;\n    @inject(ShellTerminalServerProxy) protected readonly shellTerminalServer: ShellTerminalServerProxy;\n    @inject(TerminalWatcher) protected readonly terminalWatcher: TerminalWatcher;\n    @inject(ILogger) @named('terminal') protected readonly logger: ILogger;\n    @inject('terminal-dom-id') readonly _terminalDOMId: string;\n    @inject(TerminalPreferences) protected readonly preferences: TerminalPreferences;\n    @inject(ContributionProvider) @named(TerminalContribution) protected readonly terminalContributionProvider: ContributionProvider<TerminalContribution>;\n    @inject(TerminalService) protected readonly terminalService: TerminalService;\n    @inject(TerminalSearchWidgetFactory) protected readonly terminalSearchBoxFactory: TerminalSearchWidgetFactory;\n    @inject(TerminalCopyOnSelectionHandler) protected readonly copyOnSelectionHandler: TerminalCopyOnSelectionHandler;\n    @inject(TerminalThemeService) protected readonly themeService: TerminalThemeService;\n    @inject(ColorRegistry) protected readonly colorRegistry: ColorRegistry;\n    @inject(ShellCommandBuilder) protected readonly shellCommandBuilder: ShellCommandBuilder;\n    @inject(ContextMenuRenderer) protected readonly contextMenuRenderer: ContextMenuRenderer;\n    @inject(MarkdownRendererFactory) protected readonly markdownRendererFactory: MarkdownRendererFactory;\n\n    protected _markdownRenderer: MarkdownRenderer | undefined;\n    protected get markdownRenderer(): MarkdownRenderer {\n        this._markdownRenderer ||= this.markdownRendererFactory();\n        return this._markdownRenderer;\n    }\n\n    protected readonly onDidOpenEmitter = new Emitter<void>();\n    readonly onDidOpen: Event<void> = this.onDidOpenEmitter.event;\n\n    protected readonly onDidOpenFailureEmitter = new Emitter<void>();\n    readonly onDidOpenFailure: Event<void> = this.onDidOpenFailureEmitter.event;\n\n    protected readonly onSizeChangedEmitter = new Emitter<{ cols: number; rows: number; }>();\n    readonly onSizeChanged: Event<{ cols: number; rows: number; }> = this.onSizeChangedEmitter.event;\n\n    protected readonly onDataEmitter = new Emitter<string>();\n    readonly onData: Event<string> = this.onDataEmitter.event;\n\n    protected readonly onOutputEmitter = new Emitter<string>();\n    readonly onOutput: Event<string> = this.onOutputEmitter.event;\n\n    protected readonly onKeyEmitter = new Emitter<{ key: string, domEvent: KeyboardEvent }>();\n    readonly onKey: Event<{ key: string, domEvent: KeyboardEvent }> = this.onKeyEmitter.event;\n\n    protected readonly onMouseEnterLinkHoverEmitter = new Emitter<MouseEvent>();\n    readonly onMouseEnterLinkHover: Event<MouseEvent> = this.onMouseEnterLinkHoverEmitter.event;\n\n    protected readonly onMouseLeaveLinkHoverEmitter = new Emitter<MouseEvent>();\n    readonly onMouseLeaveLinkHover: Event<MouseEvent> = this.onMouseLeaveLinkHoverEmitter.event;\n\n    protected readonly onShellTypeChangedEmiter = new Emitter<string>();\n    readonly onShellTypeChanged: Event<string> = this.onShellTypeChangedEmiter.event;\n\n    protected readonly toDisposeOnConnect = new DisposableCollection();\n\n    private _buffer: TerminalBuffer;\n    override get buffer(): TerminalBuffer {\n        return this._buffer;\n    }\n\n    @postConstruct()\n    protected init(): void {\n        this.id = this._terminalDOMId;\n        this.setTitle(this.options.title || TerminalWidgetImpl.LABEL);\n        this.setIconClass();\n\n        if (this.options.kind) {\n            this.terminalKind = this.options.kind;\n        }\n\n        if (this.options.destroyTermOnClose === true) {\n            this.toDispose.push(Disposable.create(() =>\n                this.term.dispose()\n            ));\n        }\n\n        this.location = this.options.location || TerminalLocation.Panel;\n\n        this.title.closable = true;\n        this.addClass('terminal-container');\n\n        this.term = new Terminal({\n            cursorBlink: this.preferences['terminal.integrated.cursorBlinking'],\n            cursorStyle: this.preferences['terminal.integrated.cursorStyle'] === 'line' ? 'bar' : this.preferences['terminal.integrated.cursorStyle'],\n            cursorWidth: this.preferences['terminal.integrated.cursorWidth'],\n            fontFamily: this.preferences['terminal.integrated.fontFamily'],\n            fontSize: this.preferences['terminal.integrated.fontSize'],\n            fontWeight: this.preferences['terminal.integrated.fontWeight'],\n            fontWeightBold: this.preferences['terminal.integrated.fontWeightBold'],\n            drawBoldTextInBrightColors: this.preferences['terminal.integrated.drawBoldTextInBrightColors'],\n            letterSpacing: this.preferences['terminal.integrated.letterSpacing'],\n            lineHeight: this.preferences['terminal.integrated.lineHeight'],\n            scrollback: this.preferences['terminal.integrated.scrollback'],\n            fastScrollSensitivity: this.preferences['terminal.integrated.fastScrollSensitivity'],\n            theme: this.themeService.theme\n        });\n        this._buffer = new TerminalBufferImpl(this.term);\n\n        this.fitAddon = new FitAddon();\n        this.term.loadAddon(this.fitAddon);\n\n        this.webglAddon = new WebglAddon();\n        this.term.loadAddon(this.webglAddon);\n\n        this.initializeLinkHover();\n\n        this.toDispose.push(this.preferences.onPreferenceChanged(change => {\n            this.updateConfig();\n            this.needsResize = true;\n            this.update();\n        }));\n\n        this.toDispose.push(this.themeService.onDidChange(() => {\n            this.term.options.theme = this.themeService.theme;\n            this.setIconClass();\n        }));\n        this.attachCustomKeyEventHandler();\n        const titleChangeListenerDispose = this.term.onTitleChange((title: string) => {\n            if (this.options.useServerTitle) {\n                this.title.label = title;\n            }\n        });\n        this.toDispose.push(titleChangeListenerDispose);\n\n        this.toDispose.push(this.terminalWatcher.onTerminalError(({ terminalId, error, attached }) => {\n            if (terminalId === this.terminalId) {\n                this.exitStatus = { code: undefined, reason: TerminalExitReason.Process };\n                this.logger.error(`The terminal process terminated. Cause: ${error}`);\n                if (!attached) {\n                    this.dispose();\n                }\n            }\n        }));\n        this.toDispose.push(this.terminalWatcher.onTerminalExit(({ terminalId, code, reason, attached }) => {\n            if (terminalId === this.terminalId) {\n                if (reason) {\n                    this.exitStatus = { code, reason };\n                } else {\n                    this.exitStatus = { code, reason: TerminalExitReason.Process };\n                }\n                if (!attached) {\n                    this.dispose();\n                }\n            }\n        }));\n        this.toDispose.push(this.toDisposeOnConnect);\n        this.toDispose.push(this.shellTerminalServer.onDidCloseConnection(() => {\n            const disposable = this.shellTerminalServer.onDidOpenConnection(() => {\n                disposable.dispose();\n                this.reconnectTerminalProcess();\n            });\n            this.toDispose.push(disposable);\n        }));\n        this.toDispose.push(this.onTermDidClose);\n        this.toDispose.push(this.onDidOpenEmitter);\n        this.toDispose.push(this.onDidOpenFailureEmitter);\n        this.toDispose.push(this.onSizeChangedEmitter);\n        this.toDispose.push(this.onDataEmitter);\n        this.toDispose.push(this.onKeyEmitter);\n        this.toDispose.push(this.onShellTypeChangedEmiter);\n\n        const touchEndListener = (event: TouchEvent) => {\n            if (this.node.contains(event.target as Node)) {\n                this.lastTouchEnd = event;\n            }\n        };\n        document.addEventListener('touchend', touchEndListener, { passive: true });\n        this.onDispose(() => {\n            document.removeEventListener('touchend', touchEndListener);\n        });\n\n        const mouseListener = (event: MouseEvent) => {\n            this.lastMousePosition = { x: event.x, y: event.y };\n        };\n        this.node.addEventListener('mousemove', mouseListener);\n        this.onDispose(() => {\n            this.node.removeEventListener('mousemove', mouseListener);\n        });\n\n        const contextMenuListener = (event: MouseEvent) => {\n            event.preventDefault();\n            event.stopPropagation();\n            this.contextMenuRenderer.render({ menuPath: TerminalMenus.TERMINAL_CONTEXT_MENU, anchor: event, context: this.node });\n        };\n        this.node.addEventListener('contextmenu', contextMenuListener);\n        this.onDispose(() => this.node.removeEventListener('contextmenu', contextMenuListener));\n\n        this.toDispose.push(this.term.onSelectionChange(() => {\n            if (this.copyOnSelection) {\n                this.copyOnSelectionHandler.copy(this.term.getSelection());\n            }\n        }));\n\n        this.toDispose.push(this.term.onResize(data => {\n            this.onSizeChangedEmitter.fire(data);\n        }));\n\n        this.toDispose.push(this.term.onData(data => {\n            this.onDataEmitter.fire(data);\n        }));\n\n        this.toDispose.push(this.term.onBinary(data => {\n            this.onDataEmitter.fire(data);\n        }));\n\n        this.toDispose.push(this.term.onKey(data => {\n            this.onKeyEmitter.fire(data);\n        }));\n\n        for (const contribution of this.terminalContributionProvider.getContributions()) {\n            contribution.onCreate(this);\n        }\n\n        this.searchBox = this.terminalSearchBoxFactory(this.term);\n        this.toDispose.push(this.searchBox);\n    }\n\n    get kind(): 'user' | string {\n        return this.terminalKind;\n    }\n\n    updateConfig(): void {\n        this.setCursorBlink(this.preferences.get('terminal.integrated.cursorBlinking'));\n        this.setCursorStyle(this.preferences.get('terminal.integrated.cursorStyle'));\n        this.setCursorWidth(this.preferences.get('terminal.integrated.cursorWidth'));\n        this.term.options.fontFamily = this.preferences.get('terminal.integrated.fontFamily');\n        this.term.options.fontSize = this.preferences.get('terminal.integrated.fontSize');\n        this.term.options.fontWeight = this.preferences.get('terminal.integrated.fontWeight');\n        this.term.options.fontWeightBold = this.preferences.get('terminal.integrated.fontWeightBold');\n        this.term.options.drawBoldTextInBrightColors = this.preferences.get('terminal.integrated.drawBoldTextInBrightColors');\n        this.term.options.letterSpacing = this.preferences.get('terminal.integrated.letterSpacing');\n        this.term.options.lineHeight = this.preferences.get('terminal.integrated.lineHeight');\n        this.term.options.scrollback = this.preferences.get('terminal.integrated.scrollback');\n        this.term.options.fastScrollSensitivity = this.preferences.get('terminal.integrated.fastScrollSensitivity');\n    }\n\n    protected setIconClass(): void {\n        this.styleElement?.remove();\n        if (this.options.iconClass) {\n            const iconClass = this.options.iconClass;\n            if (typeof iconClass === 'string') {\n                this.title.iconClass = iconClass;\n            } else {\n                const iconClasses: string[] = [];\n                iconClasses.push(iconClass.id);\n                if (iconClass.color) {\n                    this.styleElement = DecorationStyle.createStyleElement(`${this.terminalId}-terminal-style`);\n                    const classId = 'terminal-icon-' + generateUuid().replace(/-/g, '');\n                    const color = this.colorRegistry.getCurrentColor(iconClass.color.id);\n                    this.styleElement.textContent = `\n                        .${classId}::before {\n                            color: ${color};\n                        }\n                    `;\n                    iconClasses.push(classId);\n                }\n                this.title.iconClass = iconClasses.join(' ');\n            }\n        }\n    }\n\n    private setCursorBlink(blink: boolean): void {\n        if (this.term.options.cursorBlink !== blink) {\n            this.term.options.cursorBlink = blink;\n            this.term.refresh(0, this.term.rows - 1);\n        }\n    }\n\n    private setCursorStyle(style: 'block' | 'underline' | 'bar' | 'line'): void {\n        if (this.term.options.cursorStyle !== style) {\n            this.term.options.cursorStyle = (style === 'line') ? 'bar' : style;\n        }\n    }\n\n    private setCursorWidth(width: number): void {\n        if (this.term.options.cursorWidth !== width) {\n            this.term.options.cursorWidth = width;\n        }\n    }\n\n    protected initializeLinkHover(): void {\n        this.linkHover = document.createElement('div');\n        this.linkHover.style.position = 'fixed';\n        this.linkHover.style.color = 'var(--theia-editorHoverWidget-foreground)';\n        this.linkHover.style.backgroundColor = 'var(--theia-editorHoverWidget-background)';\n        this.linkHover.style.borderColor = 'var(--theia-editorHoverWidget-border)';\n        this.linkHover.style.borderWidth = '0.5px';\n        this.linkHover.style.borderStyle = 'solid';\n        this.linkHover.style.padding = '5px';\n        // Above the xterm.js canvas layers:\n        // https://github.com/xtermjs/xterm.js/blob/ff790236c1b205469f17a21246141f512d844295/src/renderer/Renderer.ts#L41-L46\n        this.linkHover.style.zIndex = '10';\n        // Initially invisible:\n        this.linkHover.style.display = 'none';\n\n        this.linkHoverButton = document.createElement('a');\n        this.linkHoverButton.textContent = this.linkHoverMessage();\n        this.linkHoverButton.style.cursor = 'pointer';\n        this.linkHover.appendChild(this.linkHoverButton);\n\n        const cmdCtrl = isOSX ? 'cmd' : 'ctrl';\n        const cmdHint = document.createTextNode(` (${nls.localizeByDefault(`${cmdCtrl} + click`)})`);\n        this.linkHover.appendChild(cmdHint);\n\n        const onMouseEnter = (mouseEvent: MouseEvent) => this.onMouseEnterLinkHoverEmitter.fire(mouseEvent);\n        this.linkHover.addEventListener('mouseenter', onMouseEnter);\n        this.toDispose.push(Disposable.create(() => this.linkHover.removeEventListener('mouseenter', onMouseEnter)));\n\n        const onMouseLeave = (mouseEvent: MouseEvent) => this.onMouseLeaveLinkHoverEmitter.fire(mouseEvent);\n        this.linkHover.addEventListener('mouseleave', onMouseLeave);\n        this.toDispose.push(Disposable.create(() => this.linkHover.removeEventListener('mouseleave', onMouseLeave)));\n\n        this.node.appendChild(this.linkHover);\n    }\n\n    showLinkHover(invokeAction: (event: MouseEvent) => void, x: number, y: number, message?: string): void {\n        const mouseY = this.lastMousePosition?.y ?? y;\n        const mouseX = this.lastMousePosition?.x ?? x;\n        this.linkHoverButton.textContent = this.linkHoverMessage(message);\n        this.linkHoverButton.onclick = (mouseEvent: MouseEvent) => invokeAction(mouseEvent);\n        this.linkHover.style.display = 'inline';\n        this.linkHover.style.top = `${mouseY - 30}px`;\n        this.linkHover.style.left = `${mouseX - 60}px`;\n    }\n\n    protected linkHoverMessage(message?: string): string {\n        return message ?? nls.localizeByDefault('Follow link');\n    }\n\n    hideLinkHover(): void {\n        this.linkHover.style.display = 'none';\n        // eslint-disable-next-line no-null/no-null\n        this.linkHoverButton.onclick = null;\n    }\n\n    getTerminal(): Terminal {\n        return this.term;\n    }\n\n    getSearchBox(): TerminalSearchWidget {\n        return this.searchBox;\n    }\n\n    protected override onCloseRequest(msg: Message): void {\n        this.exitStatus = { code: undefined, reason: TerminalExitReason.User };\n        super.onCloseRequest(msg);\n    }\n\n    get dimensions(): TerminalDimensions {\n        return {\n            cols: this.term.cols,\n            rows: this.term.rows,\n        };\n    }\n\n    get cwd(): Promise<URI> {\n        if (!IBaseTerminalServer.validateId(this.terminalId)) {\n            return Promise.reject(new Error('terminal is not started'));\n        }\n        if (this.terminalService.getById(this.id)) {\n            return this.shellTerminalServer.getCwdURI(this.terminalId)\n                .then(cwdUrl => {\n                    this.lastCwd = new URI(cwdUrl);\n                    return this.lastCwd;\n                }).catch(() => this.lastCwd);\n        }\n        return Promise.resolve(new URI());\n    }\n\n    get processId(): Promise<number> {\n        if (!IBaseTerminalServer.validateId(this.terminalId)) {\n            return Promise.reject(new Error('terminal is not started'));\n        }\n        return this.shellTerminalServer.getProcessId(this.terminalId);\n    }\n\n    get processInfo(): Promise<TerminalProcessInfo> {\n        if (!IBaseTerminalServer.validateId(this.terminalId)) {\n            return Promise.reject(new Error('terminal is not started'));\n        }\n        return this.shellTerminalServer.getProcessInfo(this.terminalId);\n    }\n\n    get envVarCollectionDescriptionsByExtension(): Promise<Map<string, (string | MarkdownString | undefined)[]>> {\n        if (!IBaseTerminalServer.validateId(this.terminalId)) {\n            return Promise.reject(new Error('terminal is not started'));\n        }\n        return this.shellTerminalServer.getEnvVarCollectionDescriptionsByExtension(this.terminalId);\n    }\n\n    get terminalId(): number {\n        return this._terminalId;\n    }\n\n    get lastTouchEndEvent(): TouchEvent | undefined {\n        return this.lastTouchEnd;\n    }\n\n    get hiddenFromUser(): boolean {\n        if (this.shown) {\n            return false;\n        }\n        return this.options.hideFromUser ?? false;\n    }\n\n    get transient(): boolean {\n        // The terminal is transient if session persistence is disabled or it's explicitly marked as transient\n        return !this.preferences['terminal.integrated.enablePersistentSessions'] || !!this.options.isTransient;\n    }\n\n    onDispose(onDispose: () => void): void {\n        this.toDispose.push(Disposable.create(onDispose));\n    }\n\n    clearOutput(): void {\n        this.term.clear();\n    }\n\n    selectAll(): void {\n        this.term.selectAll();\n    }\n\n    async hasChildProcesses(): Promise<boolean> {\n        return this.shellTerminalServer.hasChildProcesses(await this.processId);\n    }\n\n    storeState(): object {\n        this.closeOnDispose = false;\n        if (this.transient || this.options.isPseudoTerminal) {\n            return {};\n        }\n        return { terminalId: this.terminalId, titleLabel: this.title.label };\n    }\n\n    restoreState(oldState: object): void {\n        // transient terminals and pseudo terminals are not restored\n        if (this.transient || this.options.isPseudoTerminal) {\n            this.dispose();\n            return;\n        }\n        if (this.restored === false) {\n            const state = oldState as { terminalId: number, titleLabel: string };\n            /* This is a workaround to issue #879 */\n            this.restored = true;\n            this.title.label = state.titleLabel;\n            this.start(state.terminalId);\n        }\n    }\n\n    /**\n     * Create a new shell terminal in the back-end and attach it to a\n     * new terminal widget.\n     * If id is provided attach to the terminal for this id.\n     */\n    async start(id?: number): Promise<number> {\n        this._terminalId = typeof id !== 'number' ? await this.createTerminal() : await this.attachTerminal(id);\n        this.resizeTerminalProcess();\n        this.connectTerminalProcess();\n        if (IBaseTerminalServer.validateId(this.terminalId)) {\n            this.onDidOpenEmitter.fire(undefined);\n            await this.shellTerminalServer.onAttachAttempted(this._terminalId);\n            return this.terminalId;\n        }\n        this.onDidOpenFailureEmitter.fire(undefined);\n        throw new Error('Failed to start terminal' + (id ? ` for id: ${id}.` : '.'));\n    }\n\n    protected async attachTerminal(id: number): Promise<number> {\n        const terminalId = await this.shellTerminalServer.attach(id);\n        if (IBaseTerminalServer.validateId(terminalId)) {\n            // reset exit status if a new terminal process is attached\n            this.exitStatus = undefined;\n            return terminalId;\n        }\n        this.logger.warn(`Failed attaching to terminal id ${id}, the terminal is most likely gone. Starting up a new terminal instead.`);\n        if (this.kind === 'user') {\n            return this.createTerminal();\n        } else {\n            return -1;\n        }\n    }\n\n    protected async createTerminal(): Promise<number> {\n        let rootURI = this.options.cwd?.toString();\n        if (!rootURI) {\n            const root = (await this.workspaceService.roots)[0];\n            rootURI = root?.resource?.toString();\n        }\n        const { cols, rows } = this.term;\n        const terminalId = await this.shellTerminalServer.create({\n            shell: this.options.shellPath || this.shellPreferences.shell[OS.backend.type()],\n            args: this.options.shellArgs || this.shellPreferences.shellArgs[OS.backend.type()],\n            env: this.options.env,\n            strictEnv: this.options.strictEnv,\n            isPseudo: this.options.isPseudoTerminal,\n            rootURI,\n            cols,\n            rows\n        });\n        if (IBaseTerminalServer.validateId(terminalId)) {\n            const processInfo = await this.shellTerminalServer.getProcessInfo(terminalId);\n            const shellType = guessShellTypeFromExecutable(processInfo.executable);\n            if (shellType) {\n                this.onShellTypeChangedEmiter.fire(shellType);\n            }\n            return terminalId;\n        }\n        throw new Error('Error creating terminal widget, see the backend error log for more information.');\n    }\n\n    override processMessage(msg: Message): void {\n        super.processMessage(msg);\n        switch (msg.type) {\n            case 'fit-request':\n                this.onFitRequest(msg);\n                break;\n            default:\n                break;\n        }\n    }\n    protected override onFitRequest(msg: Message): void {\n        super.onFitRequest(msg);\n        MessageLoop.sendMessage(this, Widget.ResizeMessage.UnknownSize);\n    }\n    protected override onActivateRequest(msg: Message): void {\n        super.onActivateRequest(msg);\n        this.term.focus();\n    }\n    protected override onAfterShow(msg: Message): void {\n        super.onAfterShow(msg);\n        this.update();\n        this.shown = true;\n    }\n    protected override onAfterAttach(msg: Message): void {\n        Widget.attach(this.searchBox, this.node);\n        super.onAfterAttach(msg);\n        this.update();\n    }\n    protected override onBeforeDetach(msg: Message): void {\n        Widget.detach(this.searchBox);\n        super.onBeforeDetach(msg);\n    }\n    protected override onResize(msg: Widget.ResizeMessage): void {\n        super.onResize(msg);\n        this.needsResize = true;\n        this.update();\n    }\n\n    protected needsResize = true;\n    protected override onUpdateRequest(msg: Message): void {\n        super.onUpdateRequest(msg);\n        if (!this.isVisible || !this.isAttached) {\n            return;\n        }\n\n        this.open();\n\n        if (this.needsResize) {\n            this.resizeTerminal();\n            this.needsResize = false;\n        }\n    }\n\n    // Device status code emitted by Xterm.js\n    // Check: https://github.com/xtermjs/xterm.js/blob/release/3.14/src/InputHandler.ts#L1055-L1082\n    protected readonly deviceStatusCodes = new Set(['\\u001B[>0;276;0c', '\\u001B[>85;95;0c', '\\u001B[>83;40003;0c', '\\u001B[?1;2c', '\\u001B[?6c']);\n\n    protected connectTerminalProcess(): void {\n        if (typeof this.terminalId !== 'number') {\n            return;\n        }\n        if (this.options.isPseudoTerminal) {\n            return;\n        }\n        this.toDisposeOnConnect.dispose();\n        this.toDispose.push(this.toDisposeOnConnect);\n        const waitForConnection = this.waitForConnection = new Deferred<Channel>();\n        this.connectionProvider.listen(\n            `${terminalsPath}/${this.terminalId}`,\n            (_path, connection) => {\n                connection.onMessage(e => {\n                    this.write(e().readString());\n                });\n\n                // Excludes the device status code emitted by Xterm.js\n                const sendData = (data?: string) => {\n                    if (data && !this.deviceStatusCodes.has(data) && !this.disableEnterWhenAttachCloseListener()) {\n                        connection.getWriteBuffer().writeString(data).commit();\n                    }\n                };\n\n                const disposable = new DisposableCollection();\n                disposable.push(this.term.onData(sendData));\n                disposable.push(this.term.onBinary(sendData));\n\n                connection.onClose(() => disposable.dispose());\n\n                if (waitForConnection) {\n                    waitForConnection.resolve(connection);\n                }\n            }, false);\n    }\n    protected async reconnectTerminalProcess(): Promise<void> {\n        if (this.options.isPseudoTerminal) {\n            return;\n        }\n        if (typeof this.terminalId === 'number') {\n            await this.start(this.terminalId);\n        }\n    }\n\n    protected termOpened = false;\n    protected initialData = '';\n    protected open(): void {\n        if (this.termOpened) {\n            return;\n        }\n        this.term.open(this.node);\n\n        interface ViewportType {\n            register(d: Disposable): void;\n            _refreshAnimationFrame: number | null;\n            _coreBrowserService: {\n                window: Window;\n            }\n        }\n\n        // Workaround for https://github.com/xtermjs/xterm.js/issues/4775. Can be removed for releases > 5.3.0\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const viewPort: ViewportType = (this.term as any)._core.viewport;\n        viewPort.register(Disposable.create(() => {\n            if (typeof viewPort._refreshAnimationFrame === 'number') {\n                viewPort._coreBrowserService.window.cancelAnimationFrame(viewPort._refreshAnimationFrame);\n            }\n        }));\n\n        if (isFirefox) {\n            // monkey patching intersection observer handling for secondary window support\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const renderService: any = (this.term as any)._core._renderService;\n\n            const originalFunc: (entry: IntersectionObserverEntry) => void = renderService._handleIntersectionChange.bind(renderService);\n            const replacement = function (entry: IntersectionObserverEntry): void {\n                if (entry.target.ownerDocument !== document) {\n                    // in Firefox, the intersection observer always reports the widget as non-intersecting if the dom element\n                    // is in a different document from when the IntersectionObserver started observing. Since we know\n                    // that the widget is always \"visible\" when in a secondary window, so we refresh the rows ourselves\n                    const patchedEvent: IntersectionObserverEntry = {\n                        ...entry,\n                        isIntersecting: true,\n                    };\n                    originalFunc(patchedEvent);\n                } else {\n                    originalFunc(entry);\n                }\n            };\n\n            renderService._handleIntersectionChange = replacement.bind(renderService);\n        }\n\n        if (this.initialData) {\n            this.term.write(this.initialData);\n        }\n        this.termOpened = true;\n        this.initialData = '';\n    }\n\n    write(data: string): void {\n        if (this.termOpened) {\n            this.term.write(data);\n            this.onOutputEmitter.fire(data);\n        } else {\n            this.initialData += data;\n        }\n    }\n\n    resize(cols: number, rows: number): void {\n        this.term.resize(cols, rows);\n    }\n\n    sendText(text: string): void {\n        if (this.waitForConnection) {\n            this.waitForConnection.promise.then(connection =>\n                connection.getWriteBuffer().writeString(text).commit()\n            );\n        }\n    }\n\n    async executeCommand(commandOptions: CommandLineOptions): Promise<void> {\n        this.sendText(this.shellCommandBuilder.buildCommand(await this.processInfo, commandOptions) + OS.backend.EOL);\n    }\n\n    scrollLineUp(): void {\n        this.term.scrollLines(-1);\n    }\n\n    scrollLineDown(): void {\n        this.term.scrollLines(1);\n    }\n\n    scrollToTop(): void {\n        this.term.scrollToTop();\n    }\n\n    scrollToBottom(): void {\n        this.term.scrollToBottom();\n    }\n\n    scrollPageUp(): void {\n        this.term.scrollPages(-1);\n    }\n\n    scrollPageDown(): void {\n        this.term.scrollPages(1);\n    }\n\n    resetTerminal(): void {\n        this.term.reset();\n    }\n\n    writeLine(text: string): void {\n        this.term.writeln(text);\n        this.onOutputEmitter.fire(text + '\\n');\n    }\n\n    get onTerminalDidClose(): Event<TerminalWidget> {\n        return this.onTermDidClose.event;\n    }\n\n    override dispose(): void {\n        if (this.closeOnDispose === true && typeof this.terminalId === 'number' && !this.exitStatus?.code) {\n            // Close the backend terminal only when explicitly closing the terminal\n            // a refresh for example won't close it.\n            this.shellTerminalServer.close(this.terminalId);\n            // Exit status is set when terminal is closed by user or by process, so most likely an extension closed it.\n            this.exitStatus = { code: undefined, reason: TerminalExitReason.Extension };\n        }\n        if (this.exitStatus) {\n            this.onTermDidClose.fire(this);\n        }\n        if (this.enhancedPreviewNode) {\n            // don't use preview node anymore. rendered markdown will be disposed on super call\n            this.enhancedPreviewNode = undefined;\n        }\n        this.styleElement?.remove();\n        this.webglAddon?.dispose();\n        super.dispose();\n    }\n\n    protected resizeTerminal = debounce(() => this.doResizeTerminal(), 50);\n\n    protected doResizeTerminal(): void {\n        if (this.isDisposed) {\n            return;\n        }\n        const geo = this.fitAddon.proposeDimensions();\n        if (geo) {\n            const cols = geo.cols;\n            const rows = geo.rows - 1; // subtract one row for margin\n            this.term.resize(cols, rows);\n\n            this.resizeTerminalProcess();\n        }\n    }\n\n    protected resizeTerminalProcess(): void {\n        if (this.options.isPseudoTerminal) {\n            return;\n        }\n        if (!IBaseTerminalServer.validateId(this.terminalId)\n            || this.exitStatus\n            || !this.terminalService.getById(this.id)\n        ) {\n            return;\n        }\n        const { cols, rows } = this.term;\n        this.shellTerminalServer.resize(this.terminalId, cols, rows);\n    }\n\n    protected get enableCopy(): boolean {\n        return this.preferences['terminal.enableCopy'];\n    }\n\n    protected get enablePaste(): boolean {\n        return this.preferences['terminal.enablePaste'];\n    }\n\n    protected get shellPreferences(): IShellTerminalPreferences {\n        return {\n            shell: {\n                Windows: this.preferences['terminal.integrated.shell.windows'] ?? undefined,\n                Linux: this.preferences['terminal.integrated.shell.linux'] ?? undefined,\n                OSX: this.preferences['terminal.integrated.shell.osx'] ?? undefined,\n            },\n            shellArgs: {\n                Windows: this.preferences['terminal.integrated.shellArgs.windows'],\n                Linux: this.preferences['terminal.integrated.shellArgs.linux'],\n                OSX: this.preferences['terminal.integrated.shellArgs.osx'],\n            }\n        };\n    }\n\n    protected customKeyHandler(event: KeyboardEvent): boolean {\n        const keyBindings = KeyCode.createKeyCode(event).toString();\n        const ctrlCmdCopy = (isOSX && keyBindings === 'meta+c') || (!isOSX && keyBindings === 'ctrl+c');\n        const ctrlCmdPaste = (isOSX && keyBindings === 'meta+v') || (!isOSX && keyBindings === 'ctrl+v');\n        if (ctrlCmdCopy && this.enableCopy && this.term.hasSelection()) {\n            return false;\n        }\n        if (ctrlCmdPaste && this.enablePaste) {\n            return false;\n        }\n        return true;\n    }\n\n    protected get copyOnSelection(): boolean {\n        return this.preferences['terminal.integrated.copyOnSelection'];\n    }\n\n    protected attachCustomKeyEventHandler(): void {\n        this.term.attachCustomKeyEventHandler(e => this.customKeyHandler(e));\n    }\n\n    setTitle(title: string): void {\n        this.title.caption = title;\n        this.title.label = title;\n    }\n\n    waitOnExit(waitOnExit?: boolean | string): void {\n        if (waitOnExit) {\n            if (typeof waitOnExit === 'string') {\n                let message = waitOnExit;\n                // Bold the message and add an extra new line to make it stand out from the rest of the output\n                message = `\\r\\n\\x1b[1m${message}\\x1b[0m`;\n                this.write(message);\n            }\n            this.attachPressEnterKeyToCloseListener(this.term);\n            return;\n        }\n        this.dispose();\n    }\n\n    private attachPressEnterKeyToCloseListener(term: Terminal): void {\n        if (term.textarea) {\n            this.isAttachedCloseListener = true;\n            this.addKeyListener(term.textarea, Key.ENTER, (event: KeyboardEvent) => {\n                this.dispose();\n                this.isAttachedCloseListener = false;\n            });\n        }\n    }\n\n    private disableEnterWhenAttachCloseListener(): boolean {\n        return this.isAttachedCloseListener;\n    }\n\n    getEnhancedPreviewNode(): Node | undefined {\n        if (this.enhancedPreviewNode) {\n            return this.enhancedPreviewNode;\n        }\n\n        this.enhancedPreviewNode = document.createElement('div');\n\n        Promise.all([this.envVarCollectionDescriptionsByExtension, this.processId, this.processInfo])\n            .then((values: [Map<string, (string | MarkdownString | undefined)[]>, number, TerminalProcessInfo]) => {\n                const extensions = values[0];\n                const processId = values[1];\n                const processInfo = values[2];\n\n                const markdown = new MarkdownStringImpl();\n                markdown.appendMarkdown(nls.localizeByDefault('Process ID ({0}): {1}', 'PID', processId) + '\\\\\\n');\n                markdown.appendMarkdown(nls.localizeByDefault('Command line: {0}',\n                    processInfo.executable +\n                    ' ' +\n                    processInfo.arguments.join(' ') +\n                    '\\n\\n---\\n\\n'));\n                markdown.appendMarkdown(nls.localizeByDefault(\"The following extensions have contributed to this terminal's environment:\") + '\\n');\n                extensions.forEach((arr, key) => {\n                    arr.forEach(value => {\n                        if (value === undefined) {\n                            markdown.appendMarkdown('* ' + key + '\\n');\n                        } else if (typeof value === 'string') {\n                            markdown.appendMarkdown('* ' + key + ': ' + value + '\\n');\n                        } else {\n                            markdown.appendMarkdown('* ' + key + ': ' + value.value + '\\n');\n                        }\n                    });\n                });\n\n                const enhancedPreviewNode = this.enhancedPreviewNode;\n                if (!this.isDisposed && enhancedPreviewNode) {\n                    const result = this.markdownRenderer.render(markdown);\n                    this.toDispose.push(result);\n                    enhancedPreviewNode.appendChild(result.element);\n                }\n            });\n\n        return this.enhancedPreviewNode;\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2017 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { RpcServer } from '@theia/core/lib/common/messaging/proxy-factory';\nimport { Disposable } from '@theia/core';\n\nexport interface TerminalProcessInfo {\n    executable: string\n    arguments: string[]\n}\n\nexport interface IBaseTerminalServerOptions { }\n\nexport interface IBaseTerminalServer extends RpcServer<IBaseTerminalClient> {\n    create(IBaseTerminalServerOptions: object): Promise<number>;\n    getProcessId(id: number): Promise<number>;\n    getProcessInfo(id: number): Promise<TerminalProcessInfo>;\n    getCwdURI(id: number): Promise<string>;\n    resize(id: number, cols: number, rows: number): Promise<void>;\n    attach(id: number): Promise<number>;\n    onAttachAttempted(id: number): Promise<void>;\n    close(id: number): Promise<void>;\n    getDefaultShell(): Promise<string>;\n}\nexport namespace IBaseTerminalServer {\n    export function validateId(id?: number): boolean {\n        return typeof id === 'number' && id !== -1;\n    }\n}\n\nexport interface IBaseTerminalExitEvent {\n    terminalId: number;\n\n    // Either code and reason will be set or signal.\n    code?: number;\n    reason?: TerminalExitReason;\n    signal?: string;\n\n    attached?: boolean;\n}\n\nexport enum TerminalExitReason {\n    Unknown = 0,\n    Shutdown = 1,\n    Process = 2,\n    User = 3,\n    Extension = 4,\n}\n\nexport interface IBaseTerminalErrorEvent {\n    terminalId: number;\n    error: Error;\n    attached?: boolean;\n}\n\nexport interface IBaseTerminalClient {\n    onTerminalExitChanged(event: IBaseTerminalExitEvent): void;\n    onTerminalError(event: IBaseTerminalErrorEvent): void;\n    updateTerminalEnvVariables(): void;\n    storeTerminalEnvVariables(data: string): void;\n}\n\nexport class DispatchingBaseTerminalClient {\n\n    protected readonly clients = new Set<IBaseTerminalClient>();\n\n    push(client: IBaseTerminalClient): Disposable {\n        this.clients.add(client);\n        return Disposable.create(() => this.clients.delete(client));\n    }\n\n    onTerminalExitChanged(event: IBaseTerminalExitEvent): void {\n        this.clients.forEach(c => {\n            try {\n                c.onTerminalExitChanged(event);\n            } catch (e) {\n                console.error(e);\n            }\n        });\n    }\n\n    onTerminalError(event: IBaseTerminalErrorEvent): void {\n\n        this.clients.forEach(c => {\n            try {\n                c.onTerminalError(event);\n            } catch (e) {\n                console.error(e);\n            }\n        });\n    }\n\n    updateTerminalEnvVariables(): void {\n        this.clients.forEach(c => {\n            try {\n                c.updateTerminalEnvVariables();\n            } catch (e) {\n                console.error(e);\n            }\n        });\n    }\n\n    storeTerminalEnvVariables(data: string): void {\n        this.clients.forEach(c => {\n            try {\n                c.storeTerminalEnvVariables(data);\n            } catch (e) {\n                console.error(e);\n            }\n        });\n    }\n}\n","// *****************************************************************************\n// Copyright (C) 2025 STMicroelectronics and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { OS } from '@theia/core';\nimport * as path from 'path';\n\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n// code copied and modified from https://github.com/microsoft/vscode/blob/1.99.0/src/vs/platform/terminal/common/terminal.ts#L135-L155\n\nexport const enum GeneralShellType {\n    Bash = 'bash',\n    Csh = 'csh',\n    Fish = 'fish',\n    Julia = 'julia',\n    Ksh = 'ksh',\n    Node = 'node',\n    NuShell = 'nu',\n    PowerShell = 'pwsh',\n    Python = 'python',\n    Sh = 'sh',\n    Zsh = 'zsh',\n}\n\nexport const enum WindowsShellType {\n    CommandPrompt = 'cmd',\n    GitBash = 'gitbash',\n    Wsl = 'wsl'\n}\n\nexport type ShellType = GeneralShellType | WindowsShellType;\n\nexport const windowShellTypesToRegex: Map<string, RegExp> = new Map([\n    [WindowsShellType.CommandPrompt, /^cmd$/],\n    [WindowsShellType.GitBash, /^bash$/],\n    [WindowsShellType.Wsl, /^wsl$/]\n]);\n\nexport const shellTypesToRegex: Map<string, RegExp> = new Map([\n    [GeneralShellType.Bash, /^bash$/],\n    [GeneralShellType.Csh, /^csh$/],\n    [GeneralShellType.Fish, /^fish$/],\n    [GeneralShellType.Julia, /^julia$/],\n    [GeneralShellType.Ksh, /^ksh$/],\n    [GeneralShellType.Node, /^node$/],\n    [GeneralShellType.NuShell, /^nu$/],\n    [GeneralShellType.PowerShell, /^pwsh(-preview)?|powershell$/],\n    [GeneralShellType.Python, /^py(?:thon)?(?:\\d+)?$/],\n    [GeneralShellType.Sh, /^sh$/],\n    [GeneralShellType.Zsh, /^zsh$/]\n]);\n\nexport function guessShellTypeFromExecutable(executable: string | undefined): string | undefined {\n    if (!executable) {\n        return undefined;\n    }\n\n    if (OS.backend.isWindows) {\n        const windowsExecutableName = path.basename(executable, '.exe');\n        for (const [shellType, pattern] of windowShellTypesToRegex) {\n            if (windowsExecutableName.match(pattern)) {\n                return shellType;\n            }\n        }\n        // check also for generic ones as python\n        for (const [shellType, pattern] of shellTypesToRegex) {\n            if (windowsExecutableName.match(pattern)) {\n                return shellType;\n            }\n        }\n    }\n\n    const executableName = path.basename(executable);\n    for (const [shellType, pattern] of shellTypesToRegex) {\n        if (executableName.match(pattern)) {\n            return shellType;\n        }\n    }\n    return undefined;\n}\n","// *****************************************************************************\n// Copyright (C) 2017 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { IBaseTerminalServer, IBaseTerminalServerOptions } from './base-terminal-protocol';\n\nexport const ITerminalServer = Symbol('ITerminalServer');\n\nexport const terminalPath = '/services/terminal';\nexport const terminalsPath = '/services/terminals';\n\nexport interface ITerminalServer extends IBaseTerminalServer {\n    create(ITerminalServerOptions: object): Promise<number>;\n}\n\nexport interface ITerminalServerOptions extends IBaseTerminalServerOptions {\n    command: string,\n    args?: string[],\n    options?: object\n}\n","// *****************************************************************************\n// Copyright (C) 2017 Ericsson and others.\n//\n// This program and the accompanying materials are made available under the\n// terms of the Eclipse Public License v. 2.0 which is available at\n// http://www.eclipse.org/legal/epl-2.0.\n//\n// This Source Code may also be made available under the following Secondary\n// Licenses when the conditions for such availability set forth in the Eclipse\n// Public License v. 2.0 are satisfied: GNU General Public License, version 2\n// with the GNU Classpath Exception which is available at\n// https://www.gnu.org/software/classpath/license.html.\n//\n// SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n// *****************************************************************************\n\nimport { injectable } from '@theia/core/shared/inversify';\nimport { Emitter, Event } from '@theia/core/lib/common/event';\nimport {\n    IBaseTerminalClient,\n    IBaseTerminalExitEvent,\n    IBaseTerminalErrorEvent\n} from './base-terminal-protocol';\n\n@injectable()\nexport class TerminalWatcher {\n\n    getTerminalClient(): IBaseTerminalClient {\n        const exitEmitter = this.onTerminalExitEmitter;\n        const errorEmitter = this.onTerminalErrorEmitter;\n        const storeTerminalEnvVariablesEmitter = this.onStoreTerminalEnvVariablesRequestedEmitter;\n        const updateTerminalEnvVariablesEmitter = this.onUpdateTerminalEnvVariablesRequestedEmitter;\n        return {\n            storeTerminalEnvVariables(data: string): void {\n                storeTerminalEnvVariablesEmitter.fire(data);\n            },\n            updateTerminalEnvVariables(): void {\n                updateTerminalEnvVariablesEmitter.fire(undefined);\n            },\n            onTerminalExitChanged(event: IBaseTerminalExitEvent): void {\n                exitEmitter.fire(event);\n            },\n            onTerminalError(event: IBaseTerminalErrorEvent): void {\n                errorEmitter.fire(event);\n            }\n        };\n    }\n\n    private onTerminalExitEmitter = new Emitter<IBaseTerminalExitEvent>();\n    private onTerminalErrorEmitter = new Emitter<IBaseTerminalErrorEvent>();\n    private onStoreTerminalEnvVariablesRequestedEmitter = new Emitter<string>();\n    private onUpdateTerminalEnvVariablesRequestedEmitter = new Emitter<undefined>();\n\n    get onTerminalExit(): Event<IBaseTerminalExitEvent> {\n        return this.onTerminalExitEmitter.event;\n    }\n\n    get onTerminalError(): Event<IBaseTerminalErrorEvent> {\n        return this.onTerminalErrorEmitter.event;\n    }\n\n    get onStoreTerminalEnvVariablesRequested(): Event<string> {\n        return this.onStoreTerminalEnvVariablesRequestedEmitter.event;\n    }\n\n    get onUpdateTerminalEnvVariablesRequested(): Event<undefined> {\n        return this.onUpdateTerminalEnvVariablesRequestedEmitter.event;\n    }\n}\n","import api from \"!../../../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../../css-loader/dist/cjs.js!./terminal-search.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/********************************************************************************\n * Copyright (C) 2019 Red Hat, Inc. and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\n ********************************************************************************/\n\n.theia-search-terminal-widget-parent {\n  background: var(--theia-sideBar-background);\n  position: absolute;\n  margin: 0px;\n  border: var(--theia-border-width) solid transparent;\n  padding: 0px;\n  top: 1px;\n  right: 19px;\n\n  z-index: 10;\n}\n\n.theia-search-terminal-widget-parent .theia-search-elem-box {\n  display: flex;\n  margin: 0px;\n  border: var(--theia-border-width) solid transparent;\n  padding: 0px;\n  align-items: center;\n  color: var(--theia-input-foreground);\n  background: var(--theia-input-background);\n}\n\n.theia-search-terminal-widget-parent .theia-search-elem-box input {\n  margin-left: 5px;\n  padding: 0px;\n  width: 100px;\n  height: 18px;\n  color: inherit;\n  background-color: inherit;\n  border: var(--theia-border-width) solid transparent;\n  outline: none;\n}\n\n.theia-search-terminal-widget-parent\n  .theia-search-elem-box\n  .search-elem.codicon {\n  height: 16px;\n  width: 18px;\n}\n\n.theia-search-terminal-widget-parent .search-elem.codicon {\n  border: var(--theia-border-width) solid transparent;\n  height: 20px;\n  width: 20px;\n  opacity: 0.7;\n  outline: none;\n  color: var(--theia-input-foreground);\n  padding: 0px;\n  margin-left: 3px;\n}\n\n.theia-search-terminal-widget-parent .search-elem:hover {\n  opacity: 1;\n}\n\n.theia-search-terminal-widget-parent .theia-search-elem-box.focused {\n  border: var(--theia-border-width) solid var(--theia-focusBorder);\n}\n\n.theia-search-terminal-widget-parent\n  .theia-search-elem-box\n  .search-elem.option-enabled {\n  border: var(--theia-border-width) solid var(--theia-inputOption-activeBorder);\n  background-color: var(--theia-inputOption-activeBackground);\n}\n\n.theia-search-terminal-widget-parent .theia-search-terminal-widget {\n  margin: 2px;\n  display: flex;\n  align-items: center;\n  font: var(--theia-content-font-size);\n  color: var(--theia-input-foreground);\n}\n\n.theia-search-terminal-widget-parent .theia-search-terminal-widget button {\n  background-color: transparent;\n}\n\n.theia-search-terminal-widget-parent\n  .theia-search-terminal-widget\n  button:focus {\n  border: var(--theia-border-width) var(--theia-focusBorder) solid;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./../../node_modules/@theia/terminal/src/browser/style/terminal-search.css\"],\"names\":[],\"mappings\":\"AAAA;;;;;;;;;;;;;;iFAciF;;AAEjF;EACE,2CAA2C;EAC3C,kBAAkB;EAClB,WAAW;EACX,mDAAmD;EACnD,YAAY;EACZ,QAAQ;EACR,WAAW;;EAEX,WAAW;AACb;;AAEA;EACE,aAAa;EACb,WAAW;EACX,mDAAmD;EACnD,YAAY;EACZ,mBAAmB;EACnB,oCAAoC;EACpC,yCAAyC;AAC3C;;AAEA;EACE,gBAAgB;EAChB,YAAY;EACZ,YAAY;EACZ,YAAY;EACZ,cAAc;EACd,yBAAyB;EACzB,mDAAmD;EACnD,aAAa;AACf;;AAEA;;;EAGE,YAAY;EACZ,WAAW;AACb;;AAEA;EACE,mDAAmD;EACnD,YAAY;EACZ,WAAW;EACX,YAAY;EACZ,aAAa;EACb,oCAAoC;EACpC,YAAY;EACZ,gBAAgB;AAClB;;AAEA;EACE,UAAU;AACZ;;AAEA;EACE,gEAAgE;AAClE;;AAEA;;;EAGE,6EAA6E;EAC7E,2DAA2D;AAC7D;;AAEA;EACE,WAAW;EACX,aAAa;EACb,mBAAmB;EACnB,oCAAoC;EACpC,oCAAoC;AACtC;;AAEA;EACE,6BAA6B;AAC/B;;AAEA;;;EAGE,gEAAgE;AAClE\",\"sourcesContent\":[\"/********************************************************************************\\n * Copyright (C) 2019 Red Hat, Inc. and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0-only WITH Classpath-exception-2.0\\n ********************************************************************************/\\n\\n.theia-search-terminal-widget-parent {\\n  background: var(--theia-sideBar-background);\\n  position: absolute;\\n  margin: 0px;\\n  border: var(--theia-border-width) solid transparent;\\n  padding: 0px;\\n  top: 1px;\\n  right: 19px;\\n\\n  z-index: 10;\\n}\\n\\n.theia-search-terminal-widget-parent .theia-search-elem-box {\\n  display: flex;\\n  margin: 0px;\\n  border: var(--theia-border-width) solid transparent;\\n  padding: 0px;\\n  align-items: center;\\n  color: var(--theia-input-foreground);\\n  background: var(--theia-input-background);\\n}\\n\\n.theia-search-terminal-widget-parent .theia-search-elem-box input {\\n  margin-left: 5px;\\n  padding: 0px;\\n  width: 100px;\\n  height: 18px;\\n  color: inherit;\\n  background-color: inherit;\\n  border: var(--theia-border-width) solid transparent;\\n  outline: none;\\n}\\n\\n.theia-search-terminal-widget-parent\\n  .theia-search-elem-box\\n  .search-elem.codicon {\\n  height: 16px;\\n  width: 18px;\\n}\\n\\n.theia-search-terminal-widget-parent .search-elem.codicon {\\n  border: var(--theia-border-width) solid transparent;\\n  height: 20px;\\n  width: 20px;\\n  opacity: 0.7;\\n  outline: none;\\n  color: var(--theia-input-foreground);\\n  padding: 0px;\\n  margin-left: 3px;\\n}\\n\\n.theia-search-terminal-widget-parent .search-elem:hover {\\n  opacity: 1;\\n}\\n\\n.theia-search-terminal-widget-parent .theia-search-elem-box.focused {\\n  border: var(--theia-border-width) solid var(--theia-focusBorder);\\n}\\n\\n.theia-search-terminal-widget-parent\\n  .theia-search-elem-box\\n  .search-elem.option-enabled {\\n  border: var(--theia-border-width) solid var(--theia-inputOption-activeBorder);\\n  background-color: var(--theia-inputOption-activeBackground);\\n}\\n\\n.theia-search-terminal-widget-parent .theia-search-terminal-widget {\\n  margin: 2px;\\n  display: flex;\\n  align-items: center;\\n  font: var(--theia-content-font-size);\\n  color: var(--theia-input-foreground);\\n}\\n\\n.theia-search-terminal-widget-parent .theia-search-terminal-widget button {\\n  background-color: transparent;\\n}\\n\\n.theia-search-terminal-widget-parent\\n  .theia-search-terminal-widget\\n  button:focus {\\n  border: var(--theia-border-width) var(--theia-focusBorder) solid;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SearchAddon\"] = factory();\n\telse\n\t\troot[\"SearchAddon\"] = factory();\n})(self, () => {\nreturn ","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IDisposable } from 'common/Types';\n\ninterface IListener<T, U = void> {\n  (arg1: T, arg2: U): void;\n}\n\nexport interface IEvent<T, U = void> {\n  (listener: (arg1: T, arg2: U) => any): IDisposable;\n}\n\nexport interface IEventEmitter<T, U = void> {\n  event: IEvent<T, U>;\n  fire(arg1: T, arg2: U): void;\n  dispose(): void;\n}\n\nexport class EventEmitter<T, U = void> implements IEventEmitter<T, U> {\n  private _listeners: IListener<T, U>[] = [];\n  private _event?: IEvent<T, U>;\n  private _disposed: boolean = false;\n\n  public get event(): IEvent<T, U> {\n    if (!this._event) {\n      this._event = (listener: (arg1: T, arg2: U) => any) => {\n        this._listeners.push(listener);\n        const disposable = {\n          dispose: () => {\n            if (!this._disposed) {\n              for (let i = 0; i < this._listeners.length; i++) {\n                if (this._listeners[i] === listener) {\n                  this._listeners.splice(i, 1);\n                  return;\n                }\n              }\n            }\n          }\n        };\n        return disposable;\n      };\n    }\n    return this._event;\n  }\n\n  public fire(arg1: T, arg2: U): void {\n    const queue: IListener<T, U>[] = [];\n    for (let i = 0; i < this._listeners.length; i++) {\n      queue.push(this._listeners[i]);\n    }\n    for (let i = 0; i < queue.length; i++) {\n      queue[i].call(undefined, arg1, arg2);\n    }\n  }\n\n  public dispose(): void {\n    this.clearListeners();\n    this._disposed = true;\n  }\n\n  public clearListeners(): void {\n    if (this._listeners) {\n      this._listeners.length = 0;\n    }\n  }\n}\n\nexport function forwardEvent<T>(from: IEvent<T>, to: IEventEmitter<T>): IDisposable {\n  return from(e => to.fire(e));\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IDisposable } from 'common/Types';\n\n/**\n * A base class that can be extended to provide convenience methods for managing the lifecycle of an\n * object and its components.\n */\nexport abstract class Disposable implements IDisposable {\n  protected _disposables: IDisposable[] = [];\n  protected _isDisposed: boolean = false;\n\n  /**\n   * Disposes the object, triggering the `dispose` method on all registered IDisposables.\n   */\n  public dispose(): void {\n    this._isDisposed = true;\n    for (const d of this._disposables) {\n      d.dispose();\n    }\n    this._disposables.length = 0;\n  }\n\n  /**\n   * Registers a disposable object.\n   * @param d The disposable to register.\n   * @returns The disposable.\n   */\n  public register<T extends IDisposable>(d: T): T {\n    this._disposables.push(d);\n    return d;\n  }\n\n  /**\n   * Unregisters a disposable object if it has been registered, if not do\n   * nothing.\n   * @param d The disposable to unregister.\n   */\n  public unregister<T extends IDisposable>(d: T): void {\n    const index = this._disposables.indexOf(d);\n    if (index !== -1) {\n      this._disposables.splice(index, 1);\n    }\n  }\n}\n\nexport class MutableDisposable<T extends IDisposable> implements IDisposable {\n  private _value?: T;\n  private _isDisposed = false;\n\n  /**\n   * Gets the value if it exists.\n   */\n  public get value(): T | undefined {\n    return this._isDisposed ? undefined : this._value;\n  }\n\n  /**\n   * Sets the value, disposing of the old value if it exists.\n   */\n  public set value(value: T | undefined) {\n    if (this._isDisposed || value === this._value) {\n      return;\n    }\n    this._value?.dispose();\n    this._value = value;\n  }\n\n  /**\n   * Resets the stored value and disposes of the previously stored value.\n   */\n  public clear(): void {\n    this.value = undefined;\n  }\n\n  public dispose(): void {\n    this._isDisposed = true;\n    this._value?.dispose();\n    this._value = undefined;\n  }\n}\n\n/**\n * Wrap a function in a disposable.\n */\nexport function toDisposable(f: () => void): IDisposable {\n  return { dispose: f };\n}\n\n/**\n * Dispose of all disposables in an array and set its length to 0.\n */\nexport function disposeArray(disposables: IDisposable[]): void {\n  for (const d of disposables) {\n    d.dispose();\n  }\n  disposables.length = 0;\n}\n\n/**\n * Creates a disposable that will dispose of an array of disposables when disposed.\n */\nexport function getDisposeArrayDisposable(array: IDisposable[]): IDisposable {\n  return { dispose: () => disposeArray(array) };\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { Terminal, IDisposable, ITerminalAddon, IDecoration } from 'xterm';\nimport { EventEmitter } from 'common/EventEmitter';\nimport { Disposable, toDisposable, disposeArray, MutableDisposable } from 'common/Lifecycle';\n\nexport interface ISearchOptions {\n  regex?: boolean;\n  wholeWord?: boolean;\n  caseSensitive?: boolean;\n  incremental?: boolean;\n  decorations?: ISearchDecorationOptions;\n  noScroll?: boolean;\n}\n\ninterface ISearchDecorationOptions {\n  matchBackground?: string;\n  matchBorder?: string;\n  matchOverviewRuler: string;\n  activeMatchBackground?: string;\n  activeMatchBorder?: string;\n  activeMatchColorOverviewRuler: string;\n}\n\nexport interface ISearchPosition {\n  startCol: number;\n  startRow: number;\n}\n\nexport interface ISearchAddonOptions {\n  highlightLimit: number;\n}\n\nexport interface ISearchResult {\n  term: string;\n  col: number;\n  row: number;\n  size: number;\n}\n\ntype LineCacheEntry = [\n  /**\n   * The string representation of a line (as opposed to the buffer cell representation).\n   */\n  lineAsString: string,\n  /**\n   * The offsets where each line starts when the entry describes a wrapped line.\n   */\n  lineOffsets: number[]\n];\n\ninterface IHighlight extends IDisposable {\n  decoration: IDecoration;\n  match: ISearchResult;\n}\n\nconst NON_WORD_CHARACTERS = ' ~!@#$%^&*()+`-=[]{}|\\\\;:\"\\',./<>?';\nconst LINES_CACHE_TIME_TO_LIVE = 15 * 1000; // 15 secs\nconst DEFAULT_HIGHLIGHT_LIMIT = 1000;\n\nexport class SearchAddon extends Disposable implements ITerminalAddon {\n  private _terminal: Terminal | undefined;\n  private _cachedSearchTerm: string | undefined;\n  private _highlightedLines: Set<number> = new Set();\n  private _highlightDecorations: IHighlight[] = [];\n  private _selectedDecoration: MutableDisposable<IHighlight> = this.register(new MutableDisposable());\n  private _highlightLimit: number;\n  private _lastSearchOptions: ISearchOptions | undefined;\n  private _highlightTimeout: number | undefined;\n  /**\n   * translateBufferLineToStringWithWrap is a fairly expensive call.\n   * We memoize the calls into an array that has a time based ttl.\n   * _linesCache is also invalidated when the terminal cursor moves.\n   */\n  private _linesCache: LineCacheEntry[] | undefined;\n  private _linesCacheTimeoutId = 0;\n  private _cursorMoveListener: IDisposable | undefined;\n  private _resizeListener: IDisposable | undefined;\n\n  private readonly _onDidChangeResults = this.register(new EventEmitter<{ resultIndex: number, resultCount: number }>());\n  public readonly onDidChangeResults = this._onDidChangeResults.event;\n\n  constructor(options?: Partial<ISearchAddonOptions>) {\n    super();\n\n    this._highlightLimit = options?.highlightLimit ?? DEFAULT_HIGHLIGHT_LIMIT;\n  }\n\n  public activate(terminal: Terminal): void {\n    this._terminal = terminal;\n    this.register(this._terminal.onWriteParsed(() => this._updateMatches()));\n    this.register(this._terminal.onResize(() => this._updateMatches()));\n    this.register(toDisposable(() => this.clearDecorations()));\n  }\n\n  private _updateMatches(): void {\n    if (this._highlightTimeout) {\n      window.clearTimeout(this._highlightTimeout);\n    }\n    if (this._cachedSearchTerm && this._lastSearchOptions?.decorations) {\n      this._highlightTimeout = setTimeout(() => {\n        const term = this._cachedSearchTerm;\n        this._cachedSearchTerm = undefined;\n        this.findPrevious(term!, { ...this._lastSearchOptions, incremental: true, noScroll: true });\n      }, 200);\n    }\n  }\n\n  public clearDecorations(retainCachedSearchTerm?: boolean): void {\n    this._selectedDecoration.clear();\n    disposeArray(this._highlightDecorations);\n    this._highlightDecorations = [];\n    this._highlightedLines.clear();\n    if (!retainCachedSearchTerm) {\n      this._cachedSearchTerm = undefined;\n    }\n  }\n\n  /**\n   * Find the next instance of the term, then scroll to and select it. If it\n   * doesn't exist, do nothing.\n   * @param term The search term.\n   * @param searchOptions Search options.\n   * @returns Whether a result was found.\n   */\n  public findNext(term: string, searchOptions?: ISearchOptions): boolean {\n    if (!this._terminal) {\n      throw new Error('Cannot use addon until it has been loaded');\n    }\n    this._lastSearchOptions = searchOptions;\n    if (searchOptions?.decorations) {\n      if (this._cachedSearchTerm === undefined || term !== this._cachedSearchTerm) {\n        this._highlightAllMatches(term, searchOptions);\n      }\n    }\n\n    const found = this._findNextAndSelect(term, searchOptions);\n    this._fireResults(searchOptions);\n    this._cachedSearchTerm = term;\n\n    return found;\n  }\n\n  private _highlightAllMatches(term: string, searchOptions: ISearchOptions): void {\n    if (!this._terminal) {\n      throw new Error('Cannot use addon until it has been loaded');\n    }\n    if (!term || term.length === 0) {\n      this.clearDecorations();\n      return;\n    }\n    searchOptions = searchOptions || {};\n\n    // new search, clear out the old decorations\n    this.clearDecorations(true);\n\n    const searchResultsWithHighlight: ISearchResult[] = [];\n    let prevResult: ISearchResult | undefined = undefined;\n    let result = this._find(term, 0, 0, searchOptions);\n    while (result && (prevResult?.row !== result.row || prevResult?.col !== result.col)) {\n      if (searchResultsWithHighlight.length >= this._highlightLimit) {\n        break;\n      }\n      prevResult = result;\n      searchResultsWithHighlight.push(prevResult);\n      result = this._find(\n        term,\n        prevResult.col + prevResult.term.length >= this._terminal.cols ? prevResult.row + 1 : prevResult.row,\n        prevResult.col + prevResult.term.length >= this._terminal.cols ? 0 : prevResult.col + 1,\n        searchOptions\n      );\n    }\n    for (const match of searchResultsWithHighlight) {\n      const decoration = this._createResultDecoration(match, searchOptions.decorations!);\n      if (decoration) {\n        this._highlightedLines.add(decoration.marker.line);\n        this._highlightDecorations.push({ decoration, match, dispose() { decoration.dispose(); } });\n      }\n    }\n  }\n\n  private _find(term: string, startRow: number, startCol: number, searchOptions?: ISearchOptions): ISearchResult | undefined {\n    if (!this._terminal || !term || term.length === 0) {\n      this._terminal?.clearSelection();\n      this.clearDecorations();\n      return undefined;\n    }\n    if (startCol > this._terminal.cols) {\n      throw new Error(`Invalid col: ${startCol} to search in terminal of ${this._terminal.cols} cols`);\n    }\n\n    let result: ISearchResult | undefined = undefined;\n\n    this._initLinesCache();\n\n    const searchPosition: ISearchPosition = {\n      startRow,\n      startCol\n    };\n\n    // Search startRow\n    result = this._findInLine(term, searchPosition, searchOptions);\n    // Search from startRow + 1 to end\n    if (!result) {\n\n      for (let y = startRow + 1; y < this._terminal.buffer.active.baseY + this._terminal.rows; y++) {\n        searchPosition.startRow = y;\n        searchPosition.startCol = 0;\n        // If the current line is wrapped line, increase index of column to ignore the previous scan\n        // Otherwise, reset beginning column index to zero with set new unwrapped line index\n        result = this._findInLine(term, searchPosition, searchOptions);\n        if (result) {\n          break;\n        }\n      }\n    }\n    return result;\n  }\n\n  private _findNextAndSelect(term: string, searchOptions?: ISearchOptions): boolean {\n    if (!this._terminal || !term || term.length === 0) {\n      this._terminal?.clearSelection();\n      this.clearDecorations();\n      return false;\n    }\n\n    const prevSelectedPos = this._terminal.getSelectionPosition();\n    this._terminal.clearSelection();\n\n    let startCol = 0;\n    let startRow = 0;\n    if (prevSelectedPos) {\n      if (this._cachedSearchTerm === term) {\n        startCol = prevSelectedPos.end.x;\n        startRow = prevSelectedPos.end.y;\n      } else {\n        startCol = prevSelectedPos.start.x;\n        startRow = prevSelectedPos.start.y;\n      }\n    }\n\n    this._initLinesCache();\n\n    const searchPosition: ISearchPosition = {\n      startRow,\n      startCol\n    };\n\n    // Search startRow\n    let result = this._findInLine(term, searchPosition, searchOptions);\n    // Search from startRow + 1 to end\n    if (!result) {\n\n      for (let y = startRow + 1; y < this._terminal.buffer.active.baseY + this._terminal.rows; y++) {\n        searchPosition.startRow = y;\n        searchPosition.startCol = 0;\n        // If the current line is wrapped line, increase index of column to ignore the previous scan\n        // Otherwise, reset beginning column index to zero with set new unwrapped line index\n        result = this._findInLine(term, searchPosition, searchOptions);\n        if (result) {\n          break;\n        }\n      }\n    }\n    // If we hit the bottom and didn't search from the very top wrap back up\n    if (!result && startRow !== 0) {\n      for (let y = 0; y < startRow; y++) {\n        searchPosition.startRow = y;\n        searchPosition.startCol = 0;\n        result = this._findInLine(term, searchPosition, searchOptions);\n        if (result) {\n          break;\n        }\n      }\n    }\n\n    // If there is only one result, wrap back and return selection if it exists.\n    if (!result && prevSelectedPos) {\n      searchPosition.startRow = prevSelectedPos.start.y;\n      searchPosition.startCol = 0;\n      result = this._findInLine(term, searchPosition, searchOptions);\n    }\n\n    // Set selection and scroll if a result was found\n    return this._selectResult(result, searchOptions?.decorations, searchOptions?.noScroll);\n  }\n  /**\n   * Find the previous instance of the term, then scroll to and select it. If it\n   * doesn't exist, do nothing.\n   * @param term The search term.\n   * @param searchOptions Search options.\n   * @returns Whether a result was found.\n   */\n  public findPrevious(term: string, searchOptions?: ISearchOptions): boolean {\n    if (!this._terminal) {\n      throw new Error('Cannot use addon until it has been loaded');\n    }\n    this._lastSearchOptions = searchOptions;\n    if (searchOptions?.decorations) {\n      if (this._cachedSearchTerm === undefined || term !== this._cachedSearchTerm) {\n        this._highlightAllMatches(term, searchOptions);\n      }\n    }\n\n    const found = this._findPreviousAndSelect(term, searchOptions);\n    this._fireResults(searchOptions);\n    this._cachedSearchTerm = term;\n\n    return found;\n  }\n\n  private _fireResults(searchOptions?: ISearchOptions): void {\n    if (searchOptions?.decorations) {\n      let resultIndex = -1;\n      if (this._selectedDecoration.value) {\n        const selectedMatch = this._selectedDecoration.value.match;\n        for (let i = 0; i < this._highlightDecorations.length; i++) {\n          const match = this._highlightDecorations[i].match;\n          if (match.row === selectedMatch.row && match.col === selectedMatch.col && match.size === selectedMatch.size) {\n            resultIndex = i;\n            break;\n          }\n        }\n      }\n      this._onDidChangeResults.fire({ resultIndex, resultCount: this._highlightDecorations.length });\n    }\n  }\n\n  private _findPreviousAndSelect(term: string, searchOptions?: ISearchOptions): boolean {\n    if (!this._terminal) {\n      throw new Error('Cannot use addon until it has been loaded');\n    }\n    if (!this._terminal || !term || term.length === 0) {\n      this._terminal?.clearSelection();\n      this.clearDecorations();\n      return false;\n    }\n\n    const prevSelectedPos = this._terminal.getSelectionPosition();\n    this._terminal.clearSelection();\n\n    let startRow = this._terminal.buffer.active.baseY + this._terminal.rows - 1;\n    let startCol = this._terminal.cols;\n    const isReverseSearch = true;\n\n    this._initLinesCache();\n    const searchPosition: ISearchPosition = {\n      startRow,\n      startCol\n    };\n\n    let result: ISearchResult | undefined;\n    if (prevSelectedPos) {\n      searchPosition.startRow = startRow = prevSelectedPos.start.y;\n      searchPosition.startCol = startCol = prevSelectedPos.start.x;\n      if (this._cachedSearchTerm !== term) {\n        // Try to expand selection to right first.\n        result = this._findInLine(term, searchPosition, searchOptions, false);\n        if (!result) {\n          // If selection was not able to be expanded to the right, then try reverse search\n          searchPosition.startRow = startRow = prevSelectedPos.end.y;\n          searchPosition.startCol = startCol = prevSelectedPos.end.x;\n        }\n      }\n    }\n\n    if (!result) {\n      result = this._findInLine(term, searchPosition, searchOptions, isReverseSearch);\n    }\n\n    // Search from startRow - 1 to top\n    if (!result) {\n      searchPosition.startCol = Math.max(searchPosition.startCol, this._terminal.cols);\n      for (let y = startRow - 1; y >= 0; y--) {\n        searchPosition.startRow = y;\n        result = this._findInLine(term, searchPosition, searchOptions, isReverseSearch);\n        if (result) {\n          break;\n        }\n      }\n    }\n    // If we hit the top and didn't search from the very bottom wrap back down\n    if (!result && startRow !== (this._terminal.buffer.active.baseY + this._terminal.rows - 1)) {\n      for (let y = (this._terminal.buffer.active.baseY + this._terminal.rows - 1); y >= startRow; y--) {\n        searchPosition.startRow = y;\n        result = this._findInLine(term, searchPosition, searchOptions, isReverseSearch);\n        if (result) {\n          break;\n        }\n      }\n    }\n\n    // Set selection and scroll if a result was found\n    return this._selectResult(result, searchOptions?.decorations, searchOptions?.noScroll);\n  }\n\n  /**\n   * Sets up a line cache with a ttl\n   */\n  private _initLinesCache(): void {\n    const terminal = this._terminal!;\n    if (!this._linesCache) {\n      this._linesCache = new Array(terminal.buffer.active.length);\n      this._cursorMoveListener = terminal.onCursorMove(() => this._destroyLinesCache());\n      this._resizeListener = terminal.onResize(() => this._destroyLinesCache());\n    }\n\n    window.clearTimeout(this._linesCacheTimeoutId);\n    this._linesCacheTimeoutId = window.setTimeout(() => this._destroyLinesCache(), LINES_CACHE_TIME_TO_LIVE);\n  }\n\n  private _destroyLinesCache(): void {\n    this._linesCache = undefined;\n    if (this._cursorMoveListener) {\n      this._cursorMoveListener.dispose();\n      this._cursorMoveListener = undefined;\n    }\n    if (this._resizeListener) {\n      this._resizeListener.dispose();\n      this._resizeListener = undefined;\n    }\n    if (this._linesCacheTimeoutId) {\n      window.clearTimeout(this._linesCacheTimeoutId);\n      this._linesCacheTimeoutId = 0;\n    }\n  }\n\n  /**\n   * A found substring is a whole word if it doesn't have an alphanumeric character directly\n   * adjacent to it.\n   * @param searchIndex starting indext of the potential whole word substring\n   * @param line entire string in which the potential whole word was found\n   * @param term the substring that starts at searchIndex\n   */\n  private _isWholeWord(searchIndex: number, line: string, term: string): boolean {\n    return ((searchIndex === 0) || (NON_WORD_CHARACTERS.includes(line[searchIndex - 1]))) &&\n      (((searchIndex + term.length) === line.length) || (NON_WORD_CHARACTERS.includes(line[searchIndex + term.length])));\n  }\n\n  /**\n   * Searches a line for a search term. Takes the provided terminal line and searches the text line,\n   * which may contain subsequent terminal lines if the text is wrapped. If the provided line number\n   * is part of a wrapped text line that started on an earlier line then it is skipped since it will\n   * be properly searched when the terminal line that the text starts on is searched.\n   * @param term The search term.\n   * @param searchPosition The position to start the search.\n   * @param searchOptions Search options.\n   * @param isReverseSearch Whether the search should start from the right side of the terminal and\n   * search to the left.\n   * @returns The search result if it was found.\n   */\n  protected _findInLine(term: string, searchPosition: ISearchPosition, searchOptions: ISearchOptions = {}, isReverseSearch: boolean = false): ISearchResult | undefined {\n    const terminal = this._terminal!;\n    const row = searchPosition.startRow;\n    const col = searchPosition.startCol;\n\n    // Ignore wrapped lines, only consider on unwrapped line (first row of command string).\n    const firstLine = terminal.buffer.active.getLine(row);\n    if (firstLine?.isWrapped) {\n      if (isReverseSearch) {\n        searchPosition.startCol += terminal.cols;\n        return;\n      }\n\n      // This will iterate until we find the line start.\n      // When we find it, we will search using the calculated start column.\n      searchPosition.startRow--;\n      searchPosition.startCol += terminal.cols;\n      return this._findInLine(term, searchPosition, searchOptions);\n    }\n    let cache = this._linesCache?.[row];\n    if (!cache) {\n      cache = this._translateBufferLineToStringWithWrap(row, true);\n      if (this._linesCache) {\n        this._linesCache[row] = cache;\n      }\n    }\n    const [stringLine, offsets] = cache;\n\n    const offset = this._bufferColsToStringOffset(row, col);\n    const searchTerm = searchOptions.caseSensitive ? term : term.toLowerCase();\n    const searchStringLine = searchOptions.caseSensitive ? stringLine : stringLine.toLowerCase();\n\n    let resultIndex = -1;\n    if (searchOptions.regex) {\n      const searchRegex = RegExp(searchTerm, 'g');\n      let foundTerm: RegExpExecArray | null;\n      if (isReverseSearch) {\n        // This loop will get the resultIndex of the _last_ regex match in the range 0..offset\n        while (foundTerm = searchRegex.exec(searchStringLine.slice(0, offset))) {\n          resultIndex = searchRegex.lastIndex - foundTerm[0].length;\n          term = foundTerm[0];\n          searchRegex.lastIndex -= (term.length - 1);\n        }\n      } else {\n        foundTerm = searchRegex.exec(searchStringLine.slice(offset));\n        if (foundTerm && foundTerm[0].length > 0) {\n          resultIndex = offset + (searchRegex.lastIndex - foundTerm[0].length);\n          term = foundTerm[0];\n        }\n      }\n    } else {\n      if (isReverseSearch) {\n        if (offset - searchTerm.length >= 0) {\n          resultIndex = searchStringLine.lastIndexOf(searchTerm, offset - searchTerm.length);\n        }\n      } else {\n        resultIndex = searchStringLine.indexOf(searchTerm, offset);\n      }\n    }\n\n    if (resultIndex >= 0) {\n      if (searchOptions.wholeWord && !this._isWholeWord(resultIndex, searchStringLine, term)) {\n        return;\n      }\n\n      // Adjust the row number and search index if needed since a \"line\" of text can span multiple\n      // rows\n      let startRowOffset = 0;\n      while (startRowOffset < offsets.length - 1 && resultIndex >= offsets[startRowOffset + 1]) {\n        startRowOffset++;\n      }\n      let endRowOffset = startRowOffset;\n      while (endRowOffset < offsets.length - 1 && resultIndex + term.length >= offsets[endRowOffset + 1]) {\n        endRowOffset++;\n      }\n      const startColOffset = resultIndex - offsets[startRowOffset];\n      const endColOffset = resultIndex + term.length - offsets[endRowOffset];\n      const startColIndex = this._stringLengthToBufferSize(row + startRowOffset, startColOffset);\n      const endColIndex = this._stringLengthToBufferSize(row + endRowOffset, endColOffset);\n      const size = endColIndex - startColIndex + terminal.cols * (endRowOffset - startRowOffset);\n\n      return {\n        term,\n        col: startColIndex,\n        row: row + startRowOffset,\n        size\n      };\n    }\n  }\n\n  private _stringLengthToBufferSize(row: number, offset: number): number {\n    const line = this._terminal!.buffer.active.getLine(row);\n    if (!line) {\n      return 0;\n    }\n    for (let i = 0; i < offset; i++) {\n      const cell = line.getCell(i);\n      if (!cell) {\n        break;\n      }\n      // Adjust the searchIndex to normalize emoji into single chars\n      const char = cell.getChars();\n      if (char.length > 1) {\n        offset -= char.length - 1;\n      }\n      // Adjust the searchIndex for empty characters following wide unicode\n      // chars (eg. CJK)\n      const nextCell = line.getCell(i + 1);\n      if (nextCell && nextCell.getWidth() === 0) {\n        offset++;\n      }\n    }\n    return offset;\n  }\n\n  private _bufferColsToStringOffset(startRow: number, cols: number): number {\n    const terminal = this._terminal!;\n    let lineIndex = startRow;\n    let offset = 0;\n    let line = terminal.buffer.active.getLine(lineIndex);\n    while (cols > 0 && line) {\n      for (let i = 0; i < cols && i < terminal.cols; i++) {\n        const cell = line.getCell(i);\n        if (!cell) {\n          break;\n        }\n        if (cell.getWidth()) {\n          // Treat null characters as whitespace to align with the translateToString API\n          offset += cell.getCode() === 0 ? 1 : cell.getChars().length;\n        }\n      }\n      lineIndex++;\n      line = terminal.buffer.active.getLine(lineIndex);\n      if (line && !line.isWrapped) {\n        break;\n      }\n      cols -= terminal.cols;\n    }\n    return offset;\n  }\n\n  /**\n   * Translates a buffer line to a string, including subsequent lines if they are wraps.\n   * Wide characters will count as two columns in the resulting string. This\n   * function is useful for getting the actual text underneath the raw selection\n   * position.\n   * @param lineIndex The index of the line being translated.\n   * @param trimRight Whether to trim whitespace to the right.\n   */\n  private _translateBufferLineToStringWithWrap(lineIndex: number, trimRight: boolean): LineCacheEntry {\n    const terminal = this._terminal!;\n    const strings = [];\n    const lineOffsets = [0];\n    let line = terminal.buffer.active.getLine(lineIndex);\n    while (line) {\n      const nextLine = terminal.buffer.active.getLine(lineIndex + 1);\n      const lineWrapsToNext = nextLine ? nextLine.isWrapped : false;\n      let string = line.translateToString(!lineWrapsToNext && trimRight);\n      if (lineWrapsToNext && nextLine) {\n        const lastCell = line.getCell(line.length - 1);\n        const lastCellIsNull = lastCell && lastCell.getCode() === 0 && lastCell.getWidth() === 1;\n        // a wide character wrapped to the next line\n        if (lastCellIsNull && nextLine.getCell(0)?.getWidth() === 2) {\n          string = string.slice(0, -1);\n        }\n      }\n      strings.push(string);\n      if (lineWrapsToNext) {\n        lineOffsets.push(lineOffsets[lineOffsets.length - 1] + string.length);\n      } else {\n        break;\n      }\n      lineIndex++;\n      line = nextLine;\n    }\n    return [strings.join(''), lineOffsets];\n  }\n\n  /**\n   * Selects and scrolls to a result.\n   * @param result The result to select.\n   * @returns Whether a result was selected.\n   */\n  private _selectResult(result: ISearchResult | undefined, options?: ISearchDecorationOptions, noScroll?: boolean): boolean {\n    const terminal = this._terminal!;\n    this._selectedDecoration.clear();\n    if (!result) {\n      terminal.clearSelection();\n      return false;\n    }\n    terminal.select(result.col, result.row, result.size);\n    if (options) {\n      const marker = terminal.registerMarker(-terminal.buffer.active.baseY - terminal.buffer.active.cursorY + result.row);\n      if (marker) {\n        const decoration = terminal.registerDecoration({\n          marker,\n          x: result.col,\n          width: result.size,\n          backgroundColor: options.activeMatchBackground,\n          layer: 'top',\n          overviewRulerOptions: {\n            color: options.activeMatchColorOverviewRuler\n          }\n        });\n        if (decoration) {\n          const disposables: IDisposable[] = [];\n          disposables.push(marker);\n          disposables.push(decoration.onRender((e) => this._applyStyles(e, options.activeMatchBorder, true)));\n          disposables.push(decoration.onDispose(() => disposeArray(disposables)));\n          this._selectedDecoration.value = { decoration, match: result, dispose() { decoration.dispose(); } };\n        }\n      }\n    }\n\n    if (!noScroll) {\n      // If it is not in the viewport then we scroll else it just gets selected\n      if (result.row >= (terminal.buffer.active.viewportY + terminal.rows) || result.row < terminal.buffer.active.viewportY) {\n        let scroll = result.row - terminal.buffer.active.viewportY;\n        scroll -= Math.floor(terminal.rows / 2);\n        terminal.scrollLines(scroll);\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Applies styles to the decoration when it is rendered.\n   * @param element The decoration's element.\n   * @param borderColor The border color to apply.\n   * @param isActiveResult Whether the element is part of the active search result.\n   * @returns\n   */\n  private _applyStyles(element: HTMLElement, borderColor: string | undefined, isActiveResult: boolean): void {\n    if (!element.classList.contains('xterm-find-result-decoration')) {\n      element.classList.add('xterm-find-result-decoration');\n      if (borderColor) {\n        element.style.outline = `1px solid ${borderColor}`;\n      }\n    }\n    if (isActiveResult) {\n      element.classList.add('xterm-find-active-result-decoration');\n    }\n  }\n\n  /**\n   * Creates a decoration for the result and applies styles\n   * @param result the search result for which to create the decoration\n   * @param options the options for the decoration\n   * @returns the {@link IDecoration} or undefined if the marker has already been disposed of\n   */\n  private _createResultDecoration(result: ISearchResult, options: ISearchDecorationOptions): IDecoration | undefined {\n    const terminal = this._terminal!;\n    const marker = terminal.registerMarker(-terminal.buffer.active.baseY - terminal.buffer.active.cursorY + result.row);\n    if (!marker) {\n      return undefined;\n    }\n    const findResultDecoration = terminal.registerDecoration({\n      marker,\n      x: result.col,\n      width: result.size,\n      backgroundColor: options.matchBackground,\n      overviewRulerOptions: this._highlightedLines.has(marker.line) ? undefined : {\n        color: options.matchOverviewRuler,\n        position: 'center'\n      }\n    });\n    if (findResultDecoration) {\n      const disposables: IDisposable[] = [];\n      disposables.push(marker);\n      disposables.push(findResultDecoration.onRender((e) => this._applyStyles(e, options.matchBorder, false)));\n      disposables.push(findResultDecoration.onDispose(() => disposeArray(disposables)));\n    }\n    return findResultDecoration;\n  }\n}\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WebglAddon\"] = factory();\n\telse\n\t\troot[\"WebglAddon\"] = factory();\n})(self, () => {\nreturn ","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { throwIfFalsy } from 'browser/renderer/shared/RendererUtils';\nimport { TextureAtlas } from 'browser/renderer/shared/TextureAtlas';\nimport { IRasterizedGlyph, IRenderDimensions, ITextureAtlas } from 'browser/renderer/shared/Types';\nimport { NULL_CELL_CODE } from 'common/buffer/Constants';\nimport { Disposable, toDisposable } from 'common/Lifecycle';\nimport { traceCall } from 'common/services/LogService';\nimport { Terminal } from 'xterm';\nimport { IRenderModel, IWebGL2RenderingContext, IWebGLVertexArrayObject } from './Types';\nimport { createProgram, GLTexture, PROJECTION_MATRIX } from './WebglUtils';\n\ninterface IVertices {\n  attributes: Float32Array;\n  /**\n   * These buffers are the ones used to bind to WebGL, the reason there are\n   * multiple is to allow double buffering to work as you cannot modify the\n   * buffer while it's being used by the GPU. Having multiple lets us start\n   * working on the next frame.\n   */\n  attributesBuffers: Float32Array[];\n  count: number;\n}\n\nconst enum VertexAttribLocations {\n  UNIT_QUAD = 0,\n  CELL_POSITION = 1,\n  OFFSET = 2,\n  SIZE = 3,\n  TEXPAGE = 4,\n  TEXCOORD = 5,\n  TEXSIZE = 6\n}\n\nconst vertexShaderSource = `#version 300 es\nlayout (location = ${VertexAttribLocations.UNIT_QUAD}) in vec2 a_unitquad;\nlayout (location = ${VertexAttribLocations.CELL_POSITION}) in vec2 a_cellpos;\nlayout (location = ${VertexAttribLocations.OFFSET}) in vec2 a_offset;\nlayout (location = ${VertexAttribLocations.SIZE}) in vec2 a_size;\nlayout (location = ${VertexAttribLocations.TEXPAGE}) in float a_texpage;\nlayout (location = ${VertexAttribLocations.TEXCOORD}) in vec2 a_texcoord;\nlayout (location = ${VertexAttribLocations.TEXSIZE}) in vec2 a_texsize;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec2 v_texcoord;\nflat out int v_texpage;\n\nvoid main() {\n  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_texpage = int(a_texpage);\n  v_texcoord = a_texcoord + a_unitquad * a_texsize;\n}`;\n\nfunction createFragmentShaderSource(maxFragmentShaderTextureUnits: number): string {\n  let textureConditionals = '';\n  for (let i = 1; i < maxFragmentShaderTextureUnits; i++) {\n    textureConditionals += ` else if (v_texpage == ${i}) { outColor = texture(u_texture[${i}], v_texcoord); }`;\n  }\n  return (`#version 300 es\nprecision lowp float;\n\nin vec2 v_texcoord;\nflat in int v_texpage;\n\nuniform sampler2D u_texture[${maxFragmentShaderTextureUnits}];\n\nout vec4 outColor;\n\nvoid main() {\n  if (v_texpage == 0) {\n    outColor = texture(u_texture[0], v_texcoord);\n  } ${textureConditionals}\n}`);\n}\n\nconst INDICES_PER_CELL = 11;\nconst BYTES_PER_CELL = INDICES_PER_CELL * Float32Array.BYTES_PER_ELEMENT;\nconst CELL_POSITION_INDICES = 2;\n\n// Work variables to avoid garbage collection\nlet $i = 0;\nlet $glyph: IRasterizedGlyph | undefined = undefined;\nlet $leftCellPadding = 0;\nlet $clippedPixels = 0;\n\nexport class GlyphRenderer extends Disposable {\n  private readonly _program: WebGLProgram;\n  private readonly _vertexArrayObject: IWebGLVertexArrayObject;\n  private readonly _projectionLocation: WebGLUniformLocation;\n  private readonly _resolutionLocation: WebGLUniformLocation;\n  private readonly _textureLocation: WebGLUniformLocation;\n  private readonly _atlasTextures: GLTexture[];\n  private readonly _attributesBuffer: WebGLBuffer;\n\n  private _atlas: ITextureAtlas | undefined;\n  private _activeBuffer: number = 0;\n  private readonly _vertices: IVertices = {\n    count: 0,\n    attributes: new Float32Array(0),\n    attributesBuffers: [\n      new Float32Array(0),\n      new Float32Array(0)\n    ]\n  };\n\n  constructor(\n    private readonly _terminal: Terminal,\n    private readonly _gl: IWebGL2RenderingContext,\n    private _dimensions: IRenderDimensions\n  ) {\n    super();\n\n    const gl = this._gl;\n\n    if (TextureAtlas.maxAtlasPages === undefined) {\n      // Typically 8 or 16\n      TextureAtlas.maxAtlasPages = Math.min(32, throwIfFalsy(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS) as number | null));\n      // Almost all clients will support >= 4096\n      TextureAtlas.maxTextureSize = throwIfFalsy(gl.getParameter(gl.MAX_TEXTURE_SIZE) as number | null);\n    }\n\n    this._program = throwIfFalsy(createProgram(gl, vertexShaderSource, createFragmentShaderSource(TextureAtlas.maxAtlasPages)));\n    this.register(toDisposable(() => gl.deleteProgram(this._program)));\n\n    // Uniform locations\n    this._projectionLocation = throwIfFalsy(gl.getUniformLocation(this._program, 'u_projection'));\n    this._resolutionLocation = throwIfFalsy(gl.getUniformLocation(this._program, 'u_resolution'));\n    this._textureLocation = throwIfFalsy(gl.getUniformLocation(this._program, 'u_texture'));\n\n    // Create and set the vertex array object\n    this._vertexArrayObject = gl.createVertexArray();\n    gl.bindVertexArray(this._vertexArrayObject);\n\n    // Setup a_unitquad, this defines the 4 vertices of a rectangle\n    const unitQuadVertices = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]);\n    const unitQuadVerticesBuffer = gl.createBuffer();\n    this.register(toDisposable(() => gl.deleteBuffer(unitQuadVerticesBuffer)));\n    gl.bindBuffer(gl.ARRAY_BUFFER, unitQuadVerticesBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, unitQuadVertices, gl.STATIC_DRAW);\n    gl.enableVertexAttribArray(VertexAttribLocations.UNIT_QUAD);\n    gl.vertexAttribPointer(VertexAttribLocations.UNIT_QUAD, 2, this._gl.FLOAT, false, 0, 0);\n\n    // Setup the unit quad element array buffer, this points to indices in\n    // unitQuadVertices to allow is to draw 2 triangles from the vertices via a\n    // triangle strip\n    const unitQuadElementIndices = new Uint8Array([0, 1, 2, 3]);\n    const elementIndicesBuffer = gl.createBuffer();\n    this.register(toDisposable(() => gl.deleteBuffer(elementIndicesBuffer)));\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementIndicesBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, unitQuadElementIndices, gl.STATIC_DRAW);\n\n    // Setup attributes\n    this._attributesBuffer = throwIfFalsy(gl.createBuffer());\n    this.register(toDisposable(() => gl.deleteBuffer(this._attributesBuffer)));\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._attributesBuffer);\n    gl.enableVertexAttribArray(VertexAttribLocations.OFFSET);\n    gl.vertexAttribPointer(VertexAttribLocations.OFFSET, 2, gl.FLOAT, false, BYTES_PER_CELL, 0);\n    gl.vertexAttribDivisor(VertexAttribLocations.OFFSET, 1);\n    gl.enableVertexAttribArray(VertexAttribLocations.SIZE);\n    gl.vertexAttribPointer(VertexAttribLocations.SIZE, 2, gl.FLOAT, false, BYTES_PER_CELL, 2 * Float32Array.BYTES_PER_ELEMENT);\n    gl.vertexAttribDivisor(VertexAttribLocations.SIZE, 1);\n    gl.enableVertexAttribArray(VertexAttribLocations.TEXPAGE);\n    gl.vertexAttribPointer(VertexAttribLocations.TEXPAGE, 1, gl.FLOAT, false, BYTES_PER_CELL, 4 * Float32Array.BYTES_PER_ELEMENT);\n    gl.vertexAttribDivisor(VertexAttribLocations.TEXPAGE, 1);\n    gl.enableVertexAttribArray(VertexAttribLocations.TEXCOORD);\n    gl.vertexAttribPointer(VertexAttribLocations.TEXCOORD, 2, gl.FLOAT, false, BYTES_PER_CELL, 5 * Float32Array.BYTES_PER_ELEMENT);\n    gl.vertexAttribDivisor(VertexAttribLocations.TEXCOORD, 1);\n    gl.enableVertexAttribArray(VertexAttribLocations.TEXSIZE);\n    gl.vertexAttribPointer(VertexAttribLocations.TEXSIZE, 2, gl.FLOAT, false, BYTES_PER_CELL, 7 * Float32Array.BYTES_PER_ELEMENT);\n    gl.vertexAttribDivisor(VertexAttribLocations.TEXSIZE, 1);\n    gl.enableVertexAttribArray(VertexAttribLocations.CELL_POSITION);\n    gl.vertexAttribPointer(VertexAttribLocations.CELL_POSITION, 2, gl.FLOAT, false, BYTES_PER_CELL, 9 * Float32Array.BYTES_PER_ELEMENT);\n    gl.vertexAttribDivisor(VertexAttribLocations.CELL_POSITION, 1);\n\n    // Setup static uniforms\n    gl.useProgram(this._program);\n    const textureUnits = new Int32Array(TextureAtlas.maxAtlasPages);\n    for (let i = 0; i < TextureAtlas.maxAtlasPages; i++) {\n      textureUnits[i] = i;\n    }\n    gl.uniform1iv(this._textureLocation, textureUnits);\n    gl.uniformMatrix4fv(this._projectionLocation, false, PROJECTION_MATRIX);\n\n    // Setup 1x1 red pixel textures for all potential atlas pages, if one of these invalid textures\n    // is ever drawn it will show characters as red rectangles.\n    this._atlasTextures = [];\n    for (let i = 0; i < TextureAtlas.maxAtlasPages; i++) {\n      const glTexture = new GLTexture(throwIfFalsy(gl.createTexture()));\n      this.register(toDisposable(() => gl.deleteTexture(glTexture.texture)));\n      gl.activeTexture(gl.TEXTURE0 + i);\n      gl.bindTexture(gl.TEXTURE_2D, glTexture.texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([255, 0, 0, 255]));\n      this._atlasTextures[i] = glTexture;\n    }\n\n    // Allow drawing of transparent texture\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n    // Set viewport\n    this.handleResize();\n  }\n\n  public beginFrame(): boolean {\n    return this._atlas ? this._atlas.beginFrame() : true;\n  }\n\n  @traceCall\n  public updateCell(x: number, y: number, code: number, bg: number, fg: number, ext: number, chars: string, lastBg: number): void {\n    // Since this function is called for every cell (`rows*cols`), it must be very optimized. It\n    // should not instantiate any variables unless a new glyph is drawn to the cache where the\n    // slight slowdown is acceptable for the developer ergonomics provided as it's a once of for\n    // each glyph.\n    this._updateCell(this._vertices.attributes, x, y, code, bg, fg, ext, chars, lastBg);\n  }\n\n  private _updateCell(array: Float32Array, x: number, y: number, code: number | undefined, bg: number, fg: number, ext: number, chars: string, lastBg: number): void {\n    $i = (y * this._terminal.cols + x) * INDICES_PER_CELL;\n\n    // Exit early if this is a null character, allow space character to continue as it may have\n    // underline/strikethrough styles\n    if (code === NULL_CELL_CODE || code === undefined/* This is used for the right side of wide chars */) {\n      array.fill(0, $i, $i + INDICES_PER_CELL - 1 - CELL_POSITION_INDICES);\n      return;\n    }\n\n    if (!this._atlas) {\n      return;\n    }\n\n    // Get the glyph\n    if (chars && chars.length > 1) {\n      $glyph = this._atlas.getRasterizedGlyphCombinedChar(chars, bg, fg, ext, false);\n    } else {\n      $glyph = this._atlas.getRasterizedGlyph(code, bg, fg, ext, false);\n    }\n\n    $leftCellPadding = Math.floor((this._dimensions.device.cell.width - this._dimensions.device.char.width) / 2);\n    if (bg !== lastBg && $glyph.offset.x > $leftCellPadding) {\n      $clippedPixels = $glyph.offset.x - $leftCellPadding;\n      // a_origin\n      array[$i    ] = -($glyph.offset.x - $clippedPixels) + this._dimensions.device.char.left;\n      array[$i + 1] = -$glyph.offset.y + this._dimensions.device.char.top;\n      // a_size\n      array[$i + 2] = ($glyph.size.x - $clippedPixels) / this._dimensions.device.canvas.width;\n      array[$i + 3] = $glyph.size.y / this._dimensions.device.canvas.height;\n      // a_texpage\n      array[$i + 4] = $glyph.texturePage;\n      // a_texcoord\n      array[$i + 5] = $glyph.texturePositionClipSpace.x + $clippedPixels / this._atlas.pages[$glyph.texturePage].canvas.width;\n      array[$i + 6] = $glyph.texturePositionClipSpace.y;\n      // a_texsize\n      array[$i + 7] = $glyph.sizeClipSpace.x - $clippedPixels / this._atlas.pages[$glyph.texturePage].canvas.width;\n      array[$i + 8] = $glyph.sizeClipSpace.y;\n    } else {\n      // a_origin\n      array[$i    ] = -$glyph.offset.x + this._dimensions.device.char.left;\n      array[$i + 1] = -$glyph.offset.y + this._dimensions.device.char.top;\n      // a_size\n      array[$i + 2] = $glyph.size.x / this._dimensions.device.canvas.width;\n      array[$i + 3] = $glyph.size.y / this._dimensions.device.canvas.height;\n      // a_texpage\n      array[$i + 4] = $glyph.texturePage;\n      // a_texcoord\n      array[$i + 5] = $glyph.texturePositionClipSpace.x;\n      array[$i + 6] = $glyph.texturePositionClipSpace.y;\n      // a_texsize\n      array[$i + 7] = $glyph.sizeClipSpace.x;\n      array[$i + 8] = $glyph.sizeClipSpace.y;\n    }\n    // a_cellpos only changes on resize\n  }\n\n  public clear(): void {\n    const terminal = this._terminal;\n    const newCount = terminal.cols * terminal.rows * INDICES_PER_CELL;\n\n    // Clear vertices\n    if (this._vertices.count !== newCount) {\n      this._vertices.attributes = new Float32Array(newCount);\n    } else {\n      this._vertices.attributes.fill(0);\n    }\n    let i = 0;\n    for (; i < this._vertices.attributesBuffers.length; i++) {\n      if (this._vertices.count !== newCount) {\n        this._vertices.attributesBuffers[i] = new Float32Array(newCount);\n      } else {\n        this._vertices.attributesBuffers[i].fill(0);\n      }\n    }\n    this._vertices.count = newCount;\n    i = 0;\n    for (let y = 0; y < terminal.rows; y++) {\n      for (let x = 0; x < terminal.cols; x++) {\n        this._vertices.attributes[i + 9] = x / terminal.cols;\n        this._vertices.attributes[i + 10] = y / terminal.rows;\n        i += INDICES_PER_CELL;\n      }\n    }\n  }\n\n  public handleResize(): void {\n    const gl = this._gl;\n    gl.useProgram(this._program);\n    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n    gl.uniform2f(this._resolutionLocation, gl.canvas.width, gl.canvas.height);\n    this.clear();\n  }\n\n  public render(renderModel: IRenderModel): void {\n    if (!this._atlas) {\n      return;\n    }\n\n    const gl = this._gl;\n\n    gl.useProgram(this._program);\n    gl.bindVertexArray(this._vertexArrayObject);\n\n    // Alternate buffers each frame as the active buffer gets locked while it's in use by the GPU\n    this._activeBuffer = (this._activeBuffer + 1) % 2;\n    const activeBuffer = this._vertices.attributesBuffers[this._activeBuffer];\n\n    // Copy data for each cell of each line up to its line length (the last non-whitespace cell)\n    // from the attributes buffer into activeBuffer, which is the one that gets bound to the GPU.\n    // The reasons for this are as follows:\n    // - So the active buffer can be alternated so we don't get blocked on rendering finishing\n    // - To copy either the normal attributes buffer or the selection attributes buffer when there\n    //   is a selection\n    // - So we don't send vertices for all the line-ending whitespace to the GPU\n    let bufferLength = 0;\n    for (let y = 0; y < renderModel.lineLengths.length; y++) {\n      const si = y * this._terminal.cols * INDICES_PER_CELL;\n      const sub = this._vertices.attributes.subarray(si, si + renderModel.lineLengths[y] * INDICES_PER_CELL);\n      activeBuffer.set(sub, bufferLength);\n      bufferLength += sub.length;\n    }\n\n    // Bind the attributes buffer\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._attributesBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, activeBuffer.subarray(0, bufferLength), gl.STREAM_DRAW);\n\n    // Bind the atlas page texture if they have changed\n    for (let i = 0; i < this._atlas.pages.length; i++) {\n      if (this._atlas.pages[i].version !== this._atlasTextures[i].version) {\n        this._bindAtlasPageTexture(gl, this._atlas, i);\n      }\n    }\n\n    // Draw the viewport\n    gl.drawElementsInstanced(gl.TRIANGLE_STRIP, 4, gl.UNSIGNED_BYTE, 0, bufferLength / INDICES_PER_CELL);\n  }\n\n  public setAtlas(atlas: ITextureAtlas): void {\n    this._atlas = atlas;\n    for (const glTexture of this._atlasTextures) {\n      glTexture.version = -1;\n    }\n  }\n\n  private _bindAtlasPageTexture(gl: IWebGL2RenderingContext, atlas: ITextureAtlas, i: number): void {\n    gl.activeTexture(gl.TEXTURE0 + i);\n    gl.bindTexture(gl.TEXTURE_2D, this._atlasTextures[i].texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, atlas.pages[i].canvas);\n    gl.generateMipmap(gl.TEXTURE_2D);\n    this._atlasTextures[i].version = atlas.pages[i].version;\n  }\n\n  public setDimensions(dimensions: IRenderDimensions): void {\n    this._dimensions = dimensions;\n  }\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { throwIfFalsy } from 'browser/renderer/shared/RendererUtils';\nimport { IRenderDimensions } from 'browser/renderer/shared/Types';\nimport { IThemeService } from 'browser/services/Services';\nimport { ReadonlyColorSet } from 'browser/Types';\nimport { Attributes, FgFlags } from 'common/buffer/Constants';\nimport { Disposable, toDisposable } from 'common/Lifecycle';\nimport { IColor } from 'common/Types';\nimport { Terminal } from 'xterm';\nimport { RENDER_MODEL_BG_OFFSET, RENDER_MODEL_FG_OFFSET, RENDER_MODEL_INDICIES_PER_CELL } from './RenderModel';\nimport { IRenderModel, IWebGL2RenderingContext, IWebGLVertexArrayObject } from './Types';\nimport { createProgram, expandFloat32Array, PROJECTION_MATRIX } from './WebglUtils';\n\nconst enum VertexAttribLocations {\n  POSITION = 0,\n  SIZE = 1,\n  COLOR = 2,\n  UNIT_QUAD = 3\n}\n\nconst vertexShaderSource = `#version 300 es\nlayout (location = ${VertexAttribLocations.POSITION}) in vec2 a_position;\nlayout (location = ${VertexAttribLocations.SIZE}) in vec2 a_size;\nlayout (location = ${VertexAttribLocations.COLOR}) in vec4 a_color;\nlayout (location = ${VertexAttribLocations.UNIT_QUAD}) in vec2 a_unitquad;\n\nuniform mat4 u_projection;\n\nout vec4 v_color;\n\nvoid main() {\n  vec2 zeroToOne = a_position + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_color = a_color;\n}`;\n\nconst fragmentShaderSource = `#version 300 es\nprecision lowp float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = v_color;\n}`;\n\nconst INDICES_PER_RECTANGLE = 8;\nconst BYTES_PER_RECTANGLE = INDICES_PER_RECTANGLE * Float32Array.BYTES_PER_ELEMENT;\n\nconst INITIAL_BUFFER_RECTANGLE_CAPACITY = 20 * INDICES_PER_RECTANGLE;\n\nclass Vertices {\n  public attributes: Float32Array;\n  public count: number;\n\n  constructor() {\n    this.attributes = new Float32Array(INITIAL_BUFFER_RECTANGLE_CAPACITY);\n    this.count = 0;\n  }\n}\n\n// Work variables to avoid garbage collection\nlet $rgba = 0;\nlet $x1 = 0;\nlet $y1 = 0;\nlet $r = 0;\nlet $g = 0;\nlet $b = 0;\nlet $a = 0;\n\nexport class RectangleRenderer extends Disposable {\n\n  private _program: WebGLProgram;\n  private _vertexArrayObject: IWebGLVertexArrayObject;\n  private _attributesBuffer: WebGLBuffer;\n  private _projectionLocation: WebGLUniformLocation;\n  private _bgFloat!: Float32Array;\n  private _cursorFloat!: Float32Array;\n\n  private _vertices: Vertices = new Vertices();\n  private _verticesCursor: Vertices = new Vertices();\n\n  constructor(\n    private _terminal: Terminal,\n    private _gl: IWebGL2RenderingContext,\n    private _dimensions: IRenderDimensions,\n    private readonly _themeService: IThemeService\n  ) {\n    super();\n\n    const gl = this._gl;\n\n    this._program = throwIfFalsy(createProgram(gl, vertexShaderSource, fragmentShaderSource));\n    this.register(toDisposable(() => gl.deleteProgram(this._program)));\n\n    // Uniform locations\n    this._projectionLocation = throwIfFalsy(gl.getUniformLocation(this._program, 'u_projection'));\n\n    // Create and set the vertex array object\n    this._vertexArrayObject = gl.createVertexArray();\n    gl.bindVertexArray(this._vertexArrayObject);\n\n    // Setup a_unitquad, this defines the 4 vertices of a rectangle\n    const unitQuadVertices = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]);\n    const unitQuadVerticesBuffer = gl.createBuffer();\n    this.register(toDisposable(() => gl.deleteBuffer(unitQuadVerticesBuffer)));\n    gl.bindBuffer(gl.ARRAY_BUFFER, unitQuadVerticesBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, unitQuadVertices, gl.STATIC_DRAW);\n    gl.enableVertexAttribArray(VertexAttribLocations.UNIT_QUAD);\n    gl.vertexAttribPointer(VertexAttribLocations.UNIT_QUAD, 2, this._gl.FLOAT, false, 0, 0);\n\n    // Setup the unit quad element array buffer, this points to indices in\n    // unitQuadVertices to allow is to draw 2 triangles from the vertices via a\n    // triangle strip\n    const unitQuadElementIndices = new Uint8Array([0, 1, 2, 3]);\n    const elementIndicesBuffer = gl.createBuffer();\n    this.register(toDisposable(() => gl.deleteBuffer(elementIndicesBuffer)));\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementIndicesBuffer);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, unitQuadElementIndices, gl.STATIC_DRAW);\n\n    // Setup attributes\n    this._attributesBuffer = throwIfFalsy(gl.createBuffer());\n    this.register(toDisposable(() => gl.deleteBuffer(this._attributesBuffer)));\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._attributesBuffer);\n    gl.enableVertexAttribArray(VertexAttribLocations.POSITION);\n    gl.vertexAttribPointer(VertexAttribLocations.POSITION, 2, gl.FLOAT, false, BYTES_PER_RECTANGLE, 0);\n    gl.vertexAttribDivisor(VertexAttribLocations.POSITION, 1);\n    gl.enableVertexAttribArray(VertexAttribLocations.SIZE);\n    gl.vertexAttribPointer(VertexAttribLocations.SIZE, 2, gl.FLOAT, false, BYTES_PER_RECTANGLE, 2 * Float32Array.BYTES_PER_ELEMENT);\n    gl.vertexAttribDivisor(VertexAttribLocations.SIZE, 1);\n    gl.enableVertexAttribArray(VertexAttribLocations.COLOR);\n    gl.vertexAttribPointer(VertexAttribLocations.COLOR, 4, gl.FLOAT, false, BYTES_PER_RECTANGLE, 4 * Float32Array.BYTES_PER_ELEMENT);\n    gl.vertexAttribDivisor(VertexAttribLocations.COLOR, 1);\n\n    this._updateCachedColors(_themeService.colors);\n    this.register(this._themeService.onChangeColors(e => {\n      this._updateCachedColors(e);\n      this._updateViewportRectangle();\n    }));\n  }\n\n  public renderBackgrounds(): void {\n    this._renderVertices(this._vertices);\n  }\n\n  public renderCursor(): void {\n    this._renderVertices(this._verticesCursor);\n  }\n\n  private _renderVertices(vertices: Vertices): void {\n    const gl = this._gl;\n\n    gl.useProgram(this._program);\n\n    gl.bindVertexArray(this._vertexArrayObject);\n\n    gl.uniformMatrix4fv(this._projectionLocation, false, PROJECTION_MATRIX);\n\n    // Bind attributes buffer and draw\n    gl.bindBuffer(gl.ARRAY_BUFFER, this._attributesBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, vertices.attributes, gl.DYNAMIC_DRAW);\n    gl.drawElementsInstanced(this._gl.TRIANGLE_STRIP, 4, gl.UNSIGNED_BYTE, 0, vertices.count);\n  }\n\n  public handleResize(): void {\n    this._updateViewportRectangle();\n  }\n\n  public setDimensions(dimensions: IRenderDimensions): void {\n    this._dimensions = dimensions;\n  }\n\n  private _updateCachedColors(colors: ReadonlyColorSet): void {\n    this._bgFloat = this._colorToFloat32Array(colors.background);\n    this._cursorFloat = this._colorToFloat32Array(colors.cursor);\n  }\n\n  private _updateViewportRectangle(): void {\n    // Set first rectangle that clears the screen\n    this._addRectangleFloat(\n      this._vertices.attributes,\n      0,\n      0,\n      0,\n      this._terminal.cols * this._dimensions.device.cell.width,\n      this._terminal.rows * this._dimensions.device.cell.height,\n      this._bgFloat\n    );\n  }\n\n  public updateBackgrounds(model: IRenderModel): void {\n    const terminal = this._terminal;\n    const vertices = this._vertices;\n\n    // Declare variable ahead of time to avoid garbage collection\n    let rectangleCount = 1;\n    let y: number;\n    let x: number;\n    let currentStartX: number;\n    let currentBg: number;\n    let currentFg: number;\n    let currentInverse: boolean;\n    let modelIndex: number;\n    let bg: number;\n    let fg: number;\n    let inverse: boolean;\n    let offset: number;\n\n    for (y = 0; y < terminal.rows; y++) {\n      currentStartX = -1;\n      currentBg = 0;\n      currentFg = 0;\n      currentInverse = false;\n      for (x = 0; x < terminal.cols; x++) {\n        modelIndex = ((y * terminal.cols) + x) * RENDER_MODEL_INDICIES_PER_CELL;\n        bg = model.cells[modelIndex + RENDER_MODEL_BG_OFFSET];\n        fg = model.cells[modelIndex + RENDER_MODEL_FG_OFFSET];\n        inverse = !!(fg & FgFlags.INVERSE);\n        if (bg !== currentBg || (fg !== currentFg && (currentInverse || inverse))) {\n          // A rectangle needs to be drawn if going from non-default to another color\n          if (currentBg !== 0 || (currentInverse && currentFg !== 0)) {\n            offset = rectangleCount++ * INDICES_PER_RECTANGLE;\n            this._updateRectangle(vertices, offset, currentFg, currentBg, currentStartX, x, y);\n          }\n          currentStartX = x;\n          currentBg = bg;\n          currentFg = fg;\n          currentInverse = inverse;\n        }\n      }\n      // Finish rectangle if it's still going\n      if (currentBg !== 0 || (currentInverse && currentFg !== 0)) {\n        offset = rectangleCount++ * INDICES_PER_RECTANGLE;\n        this._updateRectangle(vertices, offset, currentFg, currentBg, currentStartX, terminal.cols, y);\n      }\n    }\n    vertices.count = rectangleCount;\n  }\n\n  public updateCursor(model: IRenderModel): void {\n    const vertices = this._verticesCursor;\n    const cursor = model.cursor;\n    if (!cursor || cursor.style === 'block') {\n      vertices.count = 0;\n      return;\n    }\n\n    let offset: number;\n    let rectangleCount = 0;\n\n    if (cursor.style === 'bar' || cursor.style === 'outline') {\n      // Left edge\n      offset = rectangleCount++ * INDICES_PER_RECTANGLE;\n      this._addRectangleFloat(\n        vertices.attributes,\n        offset,\n        cursor.x * this._dimensions.device.cell.width,\n        cursor.y * this._dimensions.device.cell.height,\n        cursor.style === 'bar' ? cursor.dpr * cursor.cursorWidth : cursor.dpr,\n        this._dimensions.device.cell.height,\n        this._cursorFloat\n      );\n    }\n    if (cursor.style === 'underline' || cursor.style === 'outline') {\n      // Bottom edge\n      offset = rectangleCount++ * INDICES_PER_RECTANGLE;\n      this._addRectangleFloat(\n        vertices.attributes,\n        offset,\n        cursor.x * this._dimensions.device.cell.width,\n        (cursor.y + 1) * this._dimensions.device.cell.height - cursor.dpr,\n        cursor.width * this._dimensions.device.cell.width,\n        cursor.dpr,\n        this._cursorFloat\n      );\n    }\n    if (cursor.style === 'outline') {\n      // Top edge\n      offset = rectangleCount++ * INDICES_PER_RECTANGLE;\n      this._addRectangleFloat(\n        vertices.attributes,\n        offset,\n        cursor.x * this._dimensions.device.cell.width,\n        cursor.y * this._dimensions.device.cell.height,\n        cursor.width * this._dimensions.device.cell.width,\n        cursor.dpr,\n        this._cursorFloat\n      );\n      // Right edge\n      offset = rectangleCount++ * INDICES_PER_RECTANGLE;\n      this._addRectangleFloat(\n        vertices.attributes,\n        offset,\n        (cursor.x + cursor.width) * this._dimensions.device.cell.width - cursor.dpr,\n        cursor.y * this._dimensions.device.cell.height,\n        cursor.dpr,\n        this._dimensions.device.cell.height,\n        this._cursorFloat\n      );\n    }\n\n    vertices.count = rectangleCount;\n  }\n\n  private _updateRectangle(vertices: Vertices, offset: number, fg: number, bg: number, startX: number, endX: number, y: number): void {\n    if (fg & FgFlags.INVERSE) {\n      switch (fg & Attributes.CM_MASK) {\n        case Attributes.CM_P16:\n        case Attributes.CM_P256:\n          $rgba = this._themeService.colors.ansi[fg & Attributes.PCOLOR_MASK].rgba;\n          break;\n        case Attributes.CM_RGB:\n          $rgba = (fg & Attributes.RGB_MASK) << 8;\n          break;\n        case Attributes.CM_DEFAULT:\n        default:\n          $rgba = this._themeService.colors.foreground.rgba;\n      }\n    } else {\n      switch (bg & Attributes.CM_MASK) {\n        case Attributes.CM_P16:\n        case Attributes.CM_P256:\n          $rgba = this._themeService.colors.ansi[bg & Attributes.PCOLOR_MASK].rgba;\n          break;\n        case Attributes.CM_RGB:\n          $rgba = (bg & Attributes.RGB_MASK) << 8;\n          break;\n        case Attributes.CM_DEFAULT:\n        default:\n          $rgba = this._themeService.colors.background.rgba;\n      }\n    }\n\n    if (vertices.attributes.length < offset + 4) {\n      vertices.attributes = expandFloat32Array(vertices.attributes, this._terminal.rows * this._terminal.cols * INDICES_PER_RECTANGLE);\n    }\n    $x1 = startX * this._dimensions.device.cell.width;\n    $y1 = y * this._dimensions.device.cell.height;\n    $r = (($rgba >> 24) & 0xFF) / 255;\n    $g = (($rgba >> 16) & 0xFF) / 255;\n    $b = (($rgba >> 8 ) & 0xFF) / 255;\n    $a = 1;\n\n    this._addRectangle(vertices.attributes, offset, $x1, $y1, (endX - startX) * this._dimensions.device.cell.width, this._dimensions.device.cell.height, $r, $g, $b, $a);\n  }\n\n  private _addRectangle(array: Float32Array, offset: number, x1: number, y1: number, width: number, height: number, r: number, g: number, b: number, a: number): void {\n    array[offset    ] = x1 / this._dimensions.device.canvas.width;\n    array[offset + 1] = y1 / this._dimensions.device.canvas.height;\n    array[offset + 2] = width / this._dimensions.device.canvas.width;\n    array[offset + 3] = height / this._dimensions.device.canvas.height;\n    array[offset + 4] = r;\n    array[offset + 5] = g;\n    array[offset + 6] = b;\n    array[offset + 7] = a;\n  }\n\n  private _addRectangleFloat(array: Float32Array, offset: number, x1: number, y1: number, width: number, height: number, color: Float32Array): void {\n    array[offset    ] = x1 / this._dimensions.device.canvas.width;\n    array[offset + 1] = y1 / this._dimensions.device.canvas.height;\n    array[offset + 2] = width / this._dimensions.device.canvas.width;\n    array[offset + 3] = height / this._dimensions.device.canvas.height;\n    array[offset + 4] = color[0];\n    array[offset + 5] = color[1];\n    array[offset + 6] = color[2];\n    array[offset + 7] = color[3];\n  }\n\n  private _colorToFloat32Array(color: IColor): Float32Array {\n    return new Float32Array([\n      ((color.rgba >> 24) & 0xFF) / 255,\n      ((color.rgba >> 16) & 0xFF) / 255,\n      ((color.rgba >> 8 ) & 0xFF) / 255,\n      ((color.rgba      ) & 0xFF) / 255\n    ]);\n  }\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { ICursorRenderModel, IRenderModel } from './Types';\nimport { ISelectionRenderModel } from 'browser/renderer/shared/Types';\nimport { createSelectionRenderModel } from 'browser/renderer/shared/SelectionRenderModel';\n\nexport const RENDER_MODEL_INDICIES_PER_CELL = 4;\nexport const RENDER_MODEL_BG_OFFSET = 1;\nexport const RENDER_MODEL_FG_OFFSET = 2;\nexport const RENDER_MODEL_EXT_OFFSET = 3;\n\nexport const COMBINED_CHAR_BIT_MASK = 0x80000000;\n\nexport class RenderModel implements IRenderModel {\n  public cells: Uint32Array;\n  public lineLengths: Uint32Array;\n  public selection: ISelectionRenderModel;\n  public cursor?: ICursorRenderModel;\n\n  constructor() {\n    this.cells = new Uint32Array(0);\n    this.lineLengths = new Uint32Array(0);\n    this.selection = createSelectionRenderModel();\n  }\n\n  public resize(cols: number, rows: number): void {\n    const indexCount = cols * rows * RENDER_MODEL_INDICIES_PER_CELL;\n    if (indexCount !== this.cells.length) {\n      this.cells = new Uint32Array(indexCount);\n      this.lineLengths = new Uint32Array(rows);\n    }\n  }\n\n  public clear(): void {\n    this.cells.fill(0, 0);\n    this.lineLengths.fill(0, 0);\n  }\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { addDisposableDomListener } from 'browser/Lifecycle';\nimport { ITerminal } from 'browser/Types';\nimport { CellColorResolver } from 'browser/renderer/shared/CellColorResolver';\nimport { acquireTextureAtlas, removeTerminalFromCache } from 'browser/renderer/shared/CharAtlasCache';\nimport { CursorBlinkStateManager } from 'browser/renderer/shared/CursorBlinkStateManager';\nimport { observeDevicePixelDimensions } from 'browser/renderer/shared/DevicePixelObserver';\nimport { createRenderDimensions } from 'browser/renderer/shared/RendererUtils';\nimport { IRenderDimensions, IRenderer, IRequestRedrawEvent, ITextureAtlas } from 'browser/renderer/shared/Types';\nimport { ICharSizeService, ICharacterJoinerService, ICoreBrowserService, IThemeService } from 'browser/services/Services';\nimport { EventEmitter, forwardEvent } from 'common/EventEmitter';\nimport { Disposable, MutableDisposable, getDisposeArrayDisposable, toDisposable } from 'common/Lifecycle';\nimport { CharData, IBufferLine, ICellData } from 'common/Types';\nimport { AttributeData } from 'common/buffer/AttributeData';\nimport { CellData } from 'common/buffer/CellData';\nimport { Attributes, Content, NULL_CELL_CHAR, NULL_CELL_CODE } from 'common/buffer/Constants';\nimport { traceCall } from 'common/services/LogService';\nimport { ICoreService, IDecorationService, IOptionsService } from 'common/services/Services';\nimport { Terminal } from 'xterm';\nimport { GlyphRenderer } from './GlyphRenderer';\nimport { RectangleRenderer } from './RectangleRenderer';\nimport { COMBINED_CHAR_BIT_MASK, RENDER_MODEL_BG_OFFSET, RENDER_MODEL_EXT_OFFSET, RENDER_MODEL_FG_OFFSET, RENDER_MODEL_INDICIES_PER_CELL, RenderModel } from './RenderModel';\nimport { IWebGL2RenderingContext } from './Types';\nimport { LinkRenderLayer } from './renderLayer/LinkRenderLayer';\nimport { IRenderLayer } from './renderLayer/Types';\n\nexport class WebglRenderer extends Disposable implements IRenderer {\n  private _renderLayers: IRenderLayer[];\n  private _cursorBlinkStateManager: MutableDisposable<CursorBlinkStateManager> = new MutableDisposable();\n  private _charAtlasDisposable = this.register(new MutableDisposable());\n  private _charAtlas: ITextureAtlas | undefined;\n  private _devicePixelRatio: number;\n\n  private _model: RenderModel = new RenderModel();\n  private _workCell: CellData = new CellData();\n  private _cellColorResolver: CellColorResolver;\n\n  private _canvas: HTMLCanvasElement;\n  private _gl: IWebGL2RenderingContext;\n  private _rectangleRenderer: MutableDisposable<RectangleRenderer> = this.register(new MutableDisposable());\n  private _glyphRenderer: MutableDisposable<GlyphRenderer> = this.register(new MutableDisposable());\n\n  public readonly dimensions: IRenderDimensions;\n\n  private _core: ITerminal;\n  private _isAttached: boolean;\n  private _contextRestorationTimeout: number | undefined;\n\n  private readonly _onChangeTextureAtlas = this.register(new EventEmitter<HTMLCanvasElement>());\n  public readonly onChangeTextureAtlas = this._onChangeTextureAtlas.event;\n  private readonly _onAddTextureAtlasCanvas = this.register(new EventEmitter<HTMLCanvasElement>());\n  public readonly onAddTextureAtlasCanvas = this._onAddTextureAtlasCanvas.event;\n  private readonly _onRemoveTextureAtlasCanvas = this.register(new EventEmitter<HTMLCanvasElement>());\n  public readonly onRemoveTextureAtlasCanvas = this._onRemoveTextureAtlasCanvas.event;\n  private readonly _onRequestRedraw = this.register(new EventEmitter<IRequestRedrawEvent>());\n  public readonly onRequestRedraw = this._onRequestRedraw.event;\n  private readonly _onContextLoss = this.register(new EventEmitter<void>());\n  public readonly onContextLoss = this._onContextLoss.event;\n\n  constructor(\n    private _terminal: Terminal,\n    private readonly _characterJoinerService: ICharacterJoinerService,\n    private readonly _charSizeService: ICharSizeService,\n    private readonly _coreBrowserService: ICoreBrowserService,\n    private readonly _coreService: ICoreService,\n    private readonly _decorationService: IDecorationService,\n    private readonly _optionsService: IOptionsService,\n    private readonly _themeService: IThemeService,\n    preserveDrawingBuffer?: boolean\n  ) {\n    super();\n\n    this.register(this._themeService.onChangeColors(() => this._handleColorChange()));\n\n    this._cellColorResolver = new CellColorResolver(this._terminal, this._model.selection, this._decorationService, this._coreBrowserService, this._themeService);\n\n    this._core = (this._terminal as any)._core;\n\n    this._renderLayers = [\n      new LinkRenderLayer(this._core.screenElement!, 2, this._terminal, this._core.linkifier2, this._coreBrowserService, _optionsService, this._themeService)\n    ];\n    this.dimensions = createRenderDimensions();\n    this._devicePixelRatio = this._coreBrowserService.dpr;\n    this._updateDimensions();\n    this._updateCursorBlink();\n    this.register(_optionsService.onOptionChange(() => this._handleOptionsChanged()));\n\n    this._canvas = document.createElement('canvas');\n\n    const contextAttributes = {\n      antialias: false,\n      depth: false,\n      preserveDrawingBuffer\n    };\n    this._gl = this._canvas.getContext('webgl2', contextAttributes) as IWebGL2RenderingContext;\n    if (!this._gl) {\n      throw new Error('WebGL2 not supported ' + this._gl);\n    }\n\n    this.register(addDisposableDomListener(this._canvas, 'webglcontextlost', (e) => {\n      console.log('webglcontextlost event received');\n      // Prevent the default behavior in order to enable WebGL context restoration.\n      e.preventDefault();\n      // Wait a few seconds to see if the 'webglcontextrestored' event is fired.\n      // If not, dispatch the onContextLoss notification to observers.\n      this._contextRestorationTimeout = setTimeout(() => {\n        this._contextRestorationTimeout = undefined;\n        console.warn('webgl context not restored; firing onContextLoss');\n        this._onContextLoss.fire(e);\n      }, 3000 /* ms */);\n    }));\n    this.register(addDisposableDomListener(this._canvas, 'webglcontextrestored', (e) => {\n      console.warn('webglcontextrestored event received');\n      clearTimeout(this._contextRestorationTimeout);\n      this._contextRestorationTimeout = undefined;\n      // The texture atlas and glyph renderer must be fully reinitialized\n      // because their contents have been lost.\n      removeTerminalFromCache(this._terminal);\n      this._initializeWebGLState();\n      this._requestRedrawViewport();\n    }));\n\n    this.register(observeDevicePixelDimensions(this._canvas, this._coreBrowserService.window, (w, h) => this._setCanvasDevicePixelDimensions(w, h)));\n\n    this._core.screenElement!.appendChild(this._canvas);\n\n    [this._rectangleRenderer.value, this._glyphRenderer.value] = this._initializeWebGLState();\n\n    this._isAttached = this._coreBrowserService.window.document.body.contains(this._core.screenElement!);\n\n    this.register(toDisposable(() => {\n      for (const l of this._renderLayers) {\n        l.dispose();\n      }\n      this._canvas.parentElement?.removeChild(this._canvas);\n      removeTerminalFromCache(this._terminal);\n    }));\n  }\n\n  public get textureAtlas(): HTMLCanvasElement | undefined {\n    return this._charAtlas?.pages[0].canvas;\n  }\n\n  private _handleColorChange(): void {\n    this._refreshCharAtlas();\n\n    // Force a full refresh\n    this._clearModel(true);\n  }\n\n  public handleDevicePixelRatioChange(): void {\n    // If the device pixel ratio changed, the char atlas needs to be regenerated\n    // and the terminal needs to refreshed\n    if (this._devicePixelRatio !== this._coreBrowserService.dpr) {\n      this._devicePixelRatio = this._coreBrowserService.dpr;\n      this.handleResize(this._terminal.cols, this._terminal.rows);\n    }\n  }\n\n  public handleResize(cols: number, rows: number): void {\n    // Update character and canvas dimensions\n    this._updateDimensions();\n\n    this._model.resize(this._terminal.cols, this._terminal.rows);\n\n    // Resize all render layers\n    for (const l of this._renderLayers) {\n      l.resize(this._terminal, this.dimensions);\n    }\n\n    // Resize the canvas\n    this._canvas.width = this.dimensions.device.canvas.width;\n    this._canvas.height = this.dimensions.device.canvas.height;\n    this._canvas.style.width = `${this.dimensions.css.canvas.width}px`;\n    this._canvas.style.height = `${this.dimensions.css.canvas.height}px`;\n\n    // Resize the screen\n    this._core.screenElement!.style.width = `${this.dimensions.css.canvas.width}px`;\n    this._core.screenElement!.style.height = `${this.dimensions.css.canvas.height}px`;\n\n    this._rectangleRenderer.value?.setDimensions(this.dimensions);\n    this._rectangleRenderer.value?.handleResize();\n    this._glyphRenderer.value?.setDimensions(this.dimensions);\n    this._glyphRenderer.value?.handleResize();\n\n    this._refreshCharAtlas();\n\n    // Force a full refresh. Resizing `_glyphRenderer` should clear it already,\n    // so there is no need to clear it again here.\n    this._clearModel(false);\n  }\n\n  public handleCharSizeChanged(): void {\n    this.handleResize(this._terminal.cols, this._terminal.rows);\n  }\n\n  public handleBlur(): void {\n    for (const l of this._renderLayers) {\n      l.handleBlur(this._terminal);\n    }\n    this._cursorBlinkStateManager.value?.pause();\n    // Request a redraw for active/inactive selection background\n    this._requestRedrawViewport();\n  }\n\n  public handleFocus(): void {\n    for (const l of this._renderLayers) {\n      l.handleFocus(this._terminal);\n    }\n    this._cursorBlinkStateManager.value?.resume();\n    // Request a redraw for active/inactive selection background\n    this._requestRedrawViewport();\n  }\n\n  public handleSelectionChanged(start: [number, number] | undefined, end: [number, number] | undefined, columnSelectMode: boolean): void {\n    for (const l of this._renderLayers) {\n      l.handleSelectionChanged(this._terminal, start, end, columnSelectMode);\n    }\n    this._model.selection.update(this._terminal, start, end, columnSelectMode);\n    this._requestRedrawViewport();\n  }\n\n  public handleCursorMove(): void {\n    for (const l of this._renderLayers) {\n      l.handleCursorMove(this._terminal);\n    }\n    this._cursorBlinkStateManager.value?.restartBlinkAnimation();\n  }\n\n  private _handleOptionsChanged(): void {\n    this._updateDimensions();\n    this._refreshCharAtlas();\n    this._updateCursorBlink();\n  }\n\n  /**\n   * Initializes members dependent on WebGL context state.\n   */\n  private _initializeWebGLState(): [RectangleRenderer, GlyphRenderer] {\n    this._rectangleRenderer.value = new RectangleRenderer(this._terminal, this._gl, this.dimensions, this._themeService);\n    this._glyphRenderer.value = new GlyphRenderer(this._terminal, this._gl, this.dimensions);\n\n    // Update dimensions and acquire char atlas\n    this.handleCharSizeChanged();\n\n    return [this._rectangleRenderer.value, this._glyphRenderer.value];\n  }\n\n  /**\n   * Refreshes the char atlas, aquiring a new one if necessary.\n   */\n  private _refreshCharAtlas(): void {\n    if (this.dimensions.device.char.width <= 0 && this.dimensions.device.char.height <= 0) {\n      // Mark as not attached so char atlas gets refreshed on next render\n      this._isAttached = false;\n      return;\n    }\n\n    const atlas = acquireTextureAtlas(\n      this._terminal,\n      this._optionsService.rawOptions,\n      this._themeService.colors,\n      this.dimensions.device.cell.width,\n      this.dimensions.device.cell.height,\n      this.dimensions.device.char.width,\n      this.dimensions.device.char.height,\n      this._coreBrowserService.dpr\n    );\n    if (this._charAtlas !== atlas) {\n      this._onChangeTextureAtlas.fire(atlas.pages[0].canvas);\n      this._charAtlasDisposable.value = getDisposeArrayDisposable([\n        forwardEvent(atlas.onAddTextureAtlasCanvas, this._onAddTextureAtlasCanvas),\n        forwardEvent(atlas.onRemoveTextureAtlasCanvas, this._onRemoveTextureAtlasCanvas)\n      ]);\n    }\n    this._charAtlas = atlas;\n    this._charAtlas.warmUp();\n    this._glyphRenderer.value?.setAtlas(this._charAtlas);\n  }\n\n  /**\n   * Clear the model.\n   * @param clearGlyphRenderer Whether to also clear the glyph renderer. This\n   * should be true generally to make sure it is in the same state as the model.\n   */\n  private _clearModel(clearGlyphRenderer: boolean): void {\n    this._model.clear();\n    if (clearGlyphRenderer) {\n      this._glyphRenderer.value?.clear();\n    }\n  }\n\n  public clearTextureAtlas(): void {\n    this._charAtlas?.clearTexture();\n    this._clearModel(true);\n    this._requestRedrawViewport();\n  }\n\n  public clear(): void {\n    this._clearModel(true);\n    for (const l of this._renderLayers) {\n      l.reset(this._terminal);\n    }\n\n    this._cursorBlinkStateManager.value?.restartBlinkAnimation();\n    this._updateCursorBlink();\n  }\n\n  public registerCharacterJoiner(handler: (text: string) => [number, number][]): number {\n    return -1;\n  }\n\n  public deregisterCharacterJoiner(joinerId: number): boolean {\n    return false;\n  }\n\n  @traceCall\n  public renderRows(start: number, end: number): void {\n    if (!this._isAttached) {\n      if (this._coreBrowserService.window.document.body.contains(this._core.screenElement!) && this._charSizeService.width && this._charSizeService.height) {\n        this._updateDimensions();\n        this._refreshCharAtlas();\n        this._isAttached = true;\n      } else {\n        return;\n      }\n    }\n\n    // Update render layers\n    for (const l of this._renderLayers) {\n      l.handleGridChanged(this._terminal, start, end);\n    }\n\n    if (!this._glyphRenderer.value || !this._rectangleRenderer.value) {\n      return;\n    }\n\n    // Tell renderer the frame is beginning\n    // upon a model clear also refresh the full viewport model\n    // (also triggered by an atlas page merge, part of #4480)\n    if (this._glyphRenderer.value.beginFrame()) {\n      this._clearModel(true);\n      this._updateModel(0, this._terminal.rows - 1);\n    } else {\n      // just update changed lines to draw\n      this._updateModel(start, end);\n    }\n\n    // Render\n    this._rectangleRenderer.value.renderBackgrounds();\n    this._glyphRenderer.value.render(this._model);\n    if (!this._cursorBlinkStateManager.value || this._cursorBlinkStateManager.value.isCursorVisible) {\n      this._rectangleRenderer.value.renderCursor();\n    }\n  }\n\n  private _updateCursorBlink(): void {\n    if (this._terminal.options.cursorBlink) {\n      this._cursorBlinkStateManager.value = new CursorBlinkStateManager(() => {\n        this._requestRedrawCursor();\n      }, this._coreBrowserService);\n    } else {\n      this._cursorBlinkStateManager.clear();\n    }\n    // Request a refresh from the terminal as management of rendering is being\n    // moved back to the terminal\n    this._requestRedrawCursor();\n  }\n\n  private _updateModel(start: number, end: number): void {\n    const terminal = this._core;\n    let cell: ICellData = this._workCell;\n\n    // Declare variable ahead of time to avoid garbage collection\n    let lastBg: number;\n    let y: number;\n    let row: number;\n    let line: IBufferLine;\n    let joinedRanges: [number, number][];\n    let isJoined: boolean;\n    let lastCharX: number;\n    let range: [number, number];\n    let chars: string;\n    let code: number;\n    let i: number;\n    let x: number;\n    let j: number;\n    start = clamp(start, terminal.rows - 1, 0);\n    end = clamp(end, terminal.rows - 1, 0);\n\n    const cursorY = this._terminal.buffer.active.baseY + this._terminal.buffer.active.cursorY;\n    // in case cursor.x == cols adjust visual cursor to cols - 1\n    const cursorX = Math.min(this._terminal.buffer.active.cursorX, terminal.cols - 1);\n    let lastCursorX = -1;\n    const isCursorVisible =\n      this._coreService.isCursorInitialized &&\n      !this._coreService.isCursorHidden &&\n      (!this._cursorBlinkStateManager.value || this._cursorBlinkStateManager.value.isCursorVisible);\n    this._model.cursor = undefined;\n    let modelUpdated = false;\n\n    for (y = start; y <= end; y++) {\n      row = y + terminal.buffer.ydisp;\n      line = terminal.buffer.lines.get(row)!;\n      this._model.lineLengths[y] = 0;\n      joinedRanges = this._characterJoinerService.getJoinedCharacters(row);\n      for (x = 0; x < terminal.cols; x++) {\n        lastBg = this._cellColorResolver.result.bg;\n        line.loadCell(x, cell);\n\n        if (x === 0) {\n          lastBg = this._cellColorResolver.result.bg;\n        }\n\n        // If true, indicates that the current character(s) to draw were joined.\n        isJoined = false;\n        lastCharX = x;\n\n        // Process any joined character ranges as needed. Because of how the\n        // ranges are produced, we know that they are valid for the characters\n        // and attributes of our input.\n        if (joinedRanges.length > 0 && x === joinedRanges[0][0]) {\n          isJoined = true;\n          range = joinedRanges.shift()!;\n\n          // We already know the exact start and end column of the joined range,\n          // so we get the string and width representing it directly.\n          cell = new JoinedCellData(\n            cell,\n            line!.translateToString(true, range[0], range[1]),\n            range[1] - range[0]\n          );\n\n          // Skip over the cells occupied by this range in the loop\n          lastCharX = range[1] - 1;\n        }\n\n        chars = cell.getChars();\n        code = cell.getCode();\n        i = ((y * terminal.cols) + x) * RENDER_MODEL_INDICIES_PER_CELL;\n\n        // Load colors/resolve overrides into work colors\n        this._cellColorResolver.resolve(cell, x, row);\n\n        // Override colors for cursor cell\n        if (isCursorVisible && row === cursorY) {\n          if (x === cursorX) {\n            this._model.cursor = {\n              x: cursorX,\n              y: this._terminal.buffer.active.cursorY,\n              width: cell.getWidth(),\n              style: this._coreBrowserService.isFocused ?\n                (terminal.options.cursorStyle || 'block') : terminal.options.cursorInactiveStyle,\n              cursorWidth: terminal.options.cursorWidth,\n              dpr: this._devicePixelRatio\n            };\n            lastCursorX = cursorX + cell.getWidth() - 1;\n          }\n          if (x >= cursorX && x <= lastCursorX &&\n              ((this._coreBrowserService.isFocused &&\n              (terminal.options.cursorStyle || 'block') === 'block') ||\n              (this._coreBrowserService.isFocused === false &&\n              terminal.options.cursorInactiveStyle === 'block'))) {\n            this._cellColorResolver.result.fg =\n              Attributes.CM_RGB | (this._themeService.colors.cursorAccent.rgba >> 8 & Attributes.RGB_MASK);\n            this._cellColorResolver.result.bg =\n              Attributes.CM_RGB | (this._themeService.colors.cursor.rgba >> 8 & Attributes.RGB_MASK);\n          }\n        }\n\n        if (code !== NULL_CELL_CODE) {\n          this._model.lineLengths[y] = x + 1;\n        }\n\n        // Nothing has changed, no updates needed\n        if (this._model.cells[i] === code &&\n            this._model.cells[i + RENDER_MODEL_BG_OFFSET] === this._cellColorResolver.result.bg &&\n            this._model.cells[i + RENDER_MODEL_FG_OFFSET] === this._cellColorResolver.result.fg &&\n            this._model.cells[i + RENDER_MODEL_EXT_OFFSET] === this._cellColorResolver.result.ext) {\n          continue;\n        }\n\n        modelUpdated = true;\n\n        // Flag combined chars with a bit mask so they're easily identifiable\n        if (chars.length > 1) {\n          code |= COMBINED_CHAR_BIT_MASK;\n        }\n\n        // Cache the results in the model\n        this._model.cells[i] = code;\n        this._model.cells[i + RENDER_MODEL_BG_OFFSET] = this._cellColorResolver.result.bg;\n        this._model.cells[i + RENDER_MODEL_FG_OFFSET] = this._cellColorResolver.result.fg;\n        this._model.cells[i + RENDER_MODEL_EXT_OFFSET] = this._cellColorResolver.result.ext;\n\n        this._glyphRenderer.value!.updateCell(x, y, code, this._cellColorResolver.result.bg, this._cellColorResolver.result.fg, this._cellColorResolver.result.ext, chars, lastBg);\n\n        if (isJoined) {\n          // Restore work cell\n          cell = this._workCell;\n\n          // Null out non-first cells\n          for (x++; x < lastCharX; x++) {\n            j = ((y * terminal.cols) + x) * RENDER_MODEL_INDICIES_PER_CELL;\n            this._glyphRenderer.value!.updateCell(x, y, NULL_CELL_CODE, 0, 0, 0, NULL_CELL_CHAR, 0);\n            this._model.cells[j] = NULL_CELL_CODE;\n            this._model.cells[j + RENDER_MODEL_BG_OFFSET] = this._cellColorResolver.result.bg;\n            this._model.cells[j + RENDER_MODEL_FG_OFFSET] = this._cellColorResolver.result.fg;\n            this._model.cells[j + RENDER_MODEL_EXT_OFFSET] = this._cellColorResolver.result.ext;\n          }\n        }\n      }\n    }\n    if (modelUpdated) {\n      this._rectangleRenderer.value!.updateBackgrounds(this._model);\n    }\n    this._rectangleRenderer.value!.updateCursor(this._model);\n  }\n\n  /**\n   * Recalculates the character and canvas dimensions.\n   */\n  private _updateDimensions(): void {\n    // Perform a new measure if the CharMeasure dimensions are not yet available\n    if (!this._charSizeService.width || !this._charSizeService.height) {\n      return;\n    }\n\n    // Calculate the device character width. Width is floored as it must be drawn to an integer grid\n    // in order for the char atlas glyphs to not be blurry.\n    this.dimensions.device.char.width = Math.floor(this._charSizeService.width * this._devicePixelRatio);\n\n    // Calculate the device character height. Height is ceiled in case devicePixelRatio is a\n    // floating point number in order to ensure there is enough space to draw the character to the\n    // cell.\n    this.dimensions.device.char.height = Math.ceil(this._charSizeService.height * this._devicePixelRatio);\n\n    // Calculate the device cell height, if lineHeight is _not_ 1, the resulting value will be\n    // floored since lineHeight can never be lower then 1, this guarentees the device cell height\n    // will always be larger than device char height.\n    this.dimensions.device.cell.height = Math.floor(this.dimensions.device.char.height * this._optionsService.rawOptions.lineHeight);\n\n    // Calculate the y offset within a cell that glyph should draw at in order for it to be centered\n    // correctly within the cell.\n    this.dimensions.device.char.top = this._optionsService.rawOptions.lineHeight === 1 ? 0 : Math.round((this.dimensions.device.cell.height - this.dimensions.device.char.height) / 2);\n\n    // Calculate the device cell width, taking the letterSpacing into account.\n    this.dimensions.device.cell.width = this.dimensions.device.char.width + Math.round(this._optionsService.rawOptions.letterSpacing);\n\n    // Calculate the x offset with a cell that text should draw from in order for it to be centered\n    // correctly within the cell.\n    this.dimensions.device.char.left = Math.floor(this._optionsService.rawOptions.letterSpacing / 2);\n\n    // Recalculate the canvas dimensions, the device dimensions define the actual number of pixel in\n    // the canvas\n    this.dimensions.device.canvas.height = this._terminal.rows * this.dimensions.device.cell.height;\n    this.dimensions.device.canvas.width = this._terminal.cols * this.dimensions.device.cell.width;\n\n    // The the size of the canvas on the page. It's important that this rounds to nearest integer\n    // and not ceils as browsers often have floating point precision issues where\n    // `window.devicePixelRatio` ends up being something like `1.100000023841858` for example, when\n    // it's actually 1.1. Ceiling may causes blurriness as the backing canvas image is 1 pixel too\n    // large for the canvas element size.\n    this.dimensions.css.canvas.height = Math.round(this.dimensions.device.canvas.height / this._devicePixelRatio);\n    this.dimensions.css.canvas.width = Math.round(this.dimensions.device.canvas.width / this._devicePixelRatio);\n\n    // Get the CSS dimensions of an individual cell. This needs to be derived from the calculated\n    // device pixel canvas value above. CharMeasure.width/height by itself is insufficient when the\n    // page is not at 100% zoom level as CharMeasure is measured in CSS pixels, but the actual char\n    // size on the canvas can differ.\n    this.dimensions.css.cell.height = this.dimensions.device.cell.height / this._devicePixelRatio;\n    this.dimensions.css.cell.width = this.dimensions.device.cell.width / this._devicePixelRatio;\n  }\n\n  private _setCanvasDevicePixelDimensions(width: number, height: number): void {\n    if (this._canvas.width === width && this._canvas.height === height) {\n      return;\n    }\n    // While the actual canvas size has changed, keep device canvas dimensions as the value before\n    // the change as it's an exact multiple of the cell sizes.\n    this._canvas.width = width;\n    this._canvas.height = height;\n    this._requestRedrawViewport();\n  }\n\n  private _requestRedrawViewport(): void {\n    this._onRequestRedraw.fire({ start: 0, end: this._terminal.rows - 1 });\n  }\n\n  private _requestRedrawCursor(): void {\n    const cursorY = this._terminal.buffer.active.cursorY;\n    this._onRequestRedraw.fire({ start: cursorY, end: cursorY });\n  }\n}\n\n// TODO: Share impl with core\nexport class JoinedCellData extends AttributeData implements ICellData {\n  private _width: number;\n  // .content carries no meaning for joined CellData, simply nullify it\n  // thus we have to overload all other .content accessors\n  public content: number = 0;\n  public fg: number;\n  public bg: number;\n  public combinedData: string = '';\n\n  constructor(firstCell: ICellData, chars: string, width: number) {\n    super();\n    this.fg = firstCell.fg;\n    this.bg = firstCell.bg;\n    this.combinedData = chars;\n    this._width = width;\n  }\n\n  public isCombined(): number {\n    // always mark joined cell data as combined\n    return Content.IS_COMBINED_MASK;\n  }\n\n  public getWidth(): number {\n    return this._width;\n  }\n\n  public getChars(): string {\n    return this.combinedData;\n  }\n\n  public getCode(): number {\n    // code always gets the highest possible fake codepoint (read as -1)\n    // this is needed as code is used by caches as identifier\n    return 0x1FFFFF;\n  }\n\n  public setFromCharData(value: CharData): void {\n    throw new Error('not implemented');\n  }\n\n  public getAsCharData(): CharData {\n    return [this.fg, this.getChars(), this.getWidth(), this.getCode()];\n  }\n}\n\nfunction clamp(value: number, max: number, min: number = 0): number {\n  return Math.max(Math.min(value, max), min);\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { throwIfFalsy } from 'browser/renderer/shared/RendererUtils';\n\n/**\n * A matrix that when multiplies will translate 0-1 coordinates (left to right,\n * top to bottom) to clip space.\n */\nexport const PROJECTION_MATRIX = new Float32Array([\n  2, 0, 0, 0,\n  0, -2, 0, 0,\n  0, 0, 1, 0,\n  -1, 1, 0, 1\n]);\n\nexport function createProgram(gl: WebGLRenderingContext, vertexSource: string, fragmentSource: string): WebGLProgram | undefined {\n  const program = throwIfFalsy(gl.createProgram());\n  gl.attachShader(program, throwIfFalsy(createShader(gl, gl.VERTEX_SHADER, vertexSource)));\n  gl.attachShader(program, throwIfFalsy(createShader(gl, gl.FRAGMENT_SHADER, fragmentSource)));\n  gl.linkProgram(program);\n  const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n  if (success) {\n    return program;\n  }\n\n  console.error(gl.getProgramInfoLog(program));\n  gl.deleteProgram(program);\n}\n\nexport function createShader(gl: WebGLRenderingContext, type: number, source: string): WebGLShader | undefined {\n  const shader = throwIfFalsy(gl.createShader(type));\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  if (success) {\n    return shader;\n  }\n\n  console.error(gl.getShaderInfoLog(shader));\n  gl.deleteShader(shader);\n}\n\nexport function expandFloat32Array(source: Float32Array, max: number): Float32Array {\n  const newLength = Math.min(source.length * 2, max);\n  const newArray = new Float32Array(newLength);\n  for (let i = 0; i < source.length; i++) {\n    newArray[i] = source[i];\n  }\n  return newArray;\n}\n\nexport class GLTexture {\n  public texture: WebGLTexture;\n  public version: number;\n\n  constructor(texture: WebGLTexture) {\n    this.texture = texture;\n    this.version = -1;\n  }\n}\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { ReadonlyColorSet } from 'browser/Types';\nimport { acquireTextureAtlas } from 'browser/renderer/shared/CharAtlasCache';\nimport { TEXT_BASELINE } from 'browser/renderer/shared/Constants';\nimport { throwIfFalsy } from 'browser/renderer/shared/RendererUtils';\nimport { IRenderDimensions, ITextureAtlas } from 'browser/renderer/shared/Types';\nimport { ICoreBrowserService, IThemeService } from 'browser/services/Services';\nimport { Disposable, toDisposable } from 'common/Lifecycle';\nimport { CellData } from 'common/buffer/CellData';\nimport { IOptionsService } from 'common/services/Services';\nimport { Terminal } from 'xterm';\nimport { IRenderLayer } from './Types';\n\nexport abstract class BaseRenderLayer extends Disposable implements IRenderLayer {\n  private _canvas: HTMLCanvasElement;\n  protected _ctx!: CanvasRenderingContext2D;\n  private _deviceCharWidth: number = 0;\n  private _deviceCharHeight: number = 0;\n  private _deviceCellWidth: number = 0;\n  private _deviceCellHeight: number = 0;\n  private _deviceCharLeft: number = 0;\n  private _deviceCharTop: number = 0;\n\n  protected _charAtlas: ITextureAtlas | undefined;\n\n  constructor(\n    terminal: Terminal,\n    private _container: HTMLElement,\n    id: string,\n    zIndex: number,\n    private _alpha: boolean,\n    protected readonly _coreBrowserService: ICoreBrowserService,\n    protected readonly _optionsService: IOptionsService,\n    protected readonly _themeService: IThemeService\n  ) {\n    super();\n    this._canvas = document.createElement('canvas');\n    this._canvas.classList.add(`xterm-${id}-layer`);\n    this._canvas.style.zIndex = zIndex.toString();\n    this._initCanvas();\n    this._container.appendChild(this._canvas);\n    this.register(this._themeService.onChangeColors(e => {\n      this._refreshCharAtlas(terminal, e);\n      this.reset(terminal);\n    }));\n    this.register(toDisposable(() => {\n      this._canvas.remove();\n    }));\n  }\n\n  private _initCanvas(): void {\n    this._ctx = throwIfFalsy(this._canvas.getContext('2d', { alpha: this._alpha }));\n    // Draw the background if this is an opaque layer\n    if (!this._alpha) {\n      this._clearAll();\n    }\n  }\n\n  public handleBlur(terminal: Terminal): void {}\n  public handleFocus(terminal: Terminal): void {}\n  public handleCursorMove(terminal: Terminal): void {}\n  public handleGridChanged(terminal: Terminal, startRow: number, endRow: number): void {}\n  public handleSelectionChanged(terminal: Terminal, start: [number, number] | undefined, end: [number, number] | undefined, columnSelectMode: boolean = false): void {}\n\n  protected _setTransparency(terminal: Terminal, alpha: boolean): void {\n    // Do nothing when alpha doesn't change\n    if (alpha === this._alpha) {\n      return;\n    }\n\n    // Create new canvas and replace old one\n    const oldCanvas = this._canvas;\n    this._alpha = alpha;\n    // Cloning preserves properties\n    this._canvas = this._canvas.cloneNode() as HTMLCanvasElement;\n    this._initCanvas();\n    this._container.replaceChild(this._canvas, oldCanvas);\n\n    // Regenerate char atlas and force a full redraw\n    this._refreshCharAtlas(terminal, this._themeService.colors);\n    this.handleGridChanged(terminal, 0, terminal.rows - 1);\n  }\n\n  /**\n   * Refreshes the char atlas, aquiring a new one if necessary.\n   * @param terminal The terminal.\n   * @param colorSet The color set to use for the char atlas.\n   */\n  private _refreshCharAtlas(terminal: Terminal, colorSet: ReadonlyColorSet): void {\n    if (this._deviceCharWidth <= 0 && this._deviceCharHeight <= 0) {\n      return;\n    }\n    this._charAtlas = acquireTextureAtlas(terminal, this._optionsService.rawOptions, colorSet, this._deviceCellWidth, this._deviceCellHeight, this._deviceCharWidth, this._deviceCharHeight, this._coreBrowserService.dpr);\n    this._charAtlas.warmUp();\n  }\n\n  public resize(terminal: Terminal, dim: IRenderDimensions): void {\n    this._deviceCellWidth = dim.device.cell.width;\n    this._deviceCellHeight = dim.device.cell.height;\n    this._deviceCharWidth = dim.device.char.width;\n    this._deviceCharHeight = dim.device.char.height;\n    this._deviceCharLeft = dim.device.char.left;\n    this._deviceCharTop = dim.device.char.top;\n    this._canvas.width = dim.device.canvas.width;\n    this._canvas.height = dim.device.canvas.height;\n    this._canvas.style.width = `${dim.css.canvas.width}px`;\n    this._canvas.style.height = `${dim.css.canvas.height}px`;\n\n    // Draw the background if this is an opaque layer\n    if (!this._alpha) {\n      this._clearAll();\n    }\n\n    this._refreshCharAtlas(terminal, this._themeService.colors);\n  }\n\n  public abstract reset(terminal: Terminal): void;\n\n  /**\n   * Fills a 1px line (2px on HDPI) at the bottom of the cell. This uses the\n   * existing fillStyle on the context.\n   * @param x The column to fill.\n   * @param y The row to fill.\n   */\n  protected _fillBottomLineAtCells(x: number, y: number, width: number = 1): void {\n    this._ctx.fillRect(\n      x * this._deviceCellWidth,\n      (y + 1) * this._deviceCellHeight - this._coreBrowserService.dpr - 1 /* Ensure it's drawn within the cell */,\n      width * this._deviceCellWidth,\n      this._coreBrowserService.dpr);\n  }\n\n  /**\n   * Clears the entire canvas.\n   */\n  protected _clearAll(): void {\n    if (this._alpha) {\n      this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n    } else {\n      this._ctx.fillStyle = this._themeService.colors.background.css;\n      this._ctx.fillRect(0, 0, this._canvas.width, this._canvas.height);\n    }\n  }\n\n  /**\n   * Clears 1+ cells completely.\n   * @param x The column to start at.\n   * @param y The row to start at.\n   * @param width The number of columns to clear.\n   * @param height The number of rows to clear.\n   */\n  protected _clearCells(x: number, y: number, width: number, height: number): void {\n    if (this._alpha) {\n      this._ctx.clearRect(\n        x * this._deviceCellWidth,\n        y * this._deviceCellHeight,\n        width * this._deviceCellWidth,\n        height * this._deviceCellHeight);\n    } else {\n      this._ctx.fillStyle = this._themeService.colors.background.css;\n      this._ctx.fillRect(\n        x * this._deviceCellWidth,\n        y * this._deviceCellHeight,\n        width * this._deviceCellWidth,\n        height * this._deviceCellHeight);\n    }\n  }\n\n  /**\n   * Draws a truecolor character at the cell. The character will be clipped to\n   * ensure that it fits with the cell, including the cell to the right if it's\n   * a wide character. This uses the existing fillStyle on the context.\n   * @param terminal The terminal.\n   * @param cell The cell data for the character to draw.\n   * @param x The column to draw at.\n   * @param y The row to draw at.\n   */\n  protected _fillCharTrueColor(terminal: Terminal, cell: CellData, x: number, y: number): void {\n    this._ctx.font = this._getFont(terminal, false, false);\n    this._ctx.textBaseline = TEXT_BASELINE;\n    this._clipCell(x, y, cell.getWidth());\n    this._ctx.fillText(\n      cell.getChars(),\n      x * this._deviceCellWidth + this._deviceCharLeft,\n      y * this._deviceCellHeight + this._deviceCharTop + this._deviceCharHeight);\n  }\n\n  /**\n   * Clips a cell to ensure no pixels will be drawn outside of it.\n   * @param x The column to clip.\n   * @param y The row to clip.\n   * @param width The number of columns to clip.\n   */\n  private _clipCell(x: number, y: number, width: number): void {\n    this._ctx.beginPath();\n    this._ctx.rect(\n      x * this._deviceCellWidth,\n      y * this._deviceCellHeight,\n      width * this._deviceCellWidth,\n      this._deviceCellHeight);\n    this._ctx.clip();\n  }\n\n  /**\n   * Gets the current font.\n   * @param terminal The terminal.\n   * @param isBold If we should use the bold fontWeight.\n   */\n  protected _getFont(terminal: Terminal, isBold: boolean, isItalic: boolean): string {\n    const fontWeight = isBold ? terminal.options.fontWeightBold : terminal.options.fontWeight;\n    const fontStyle = isItalic ? 'italic' : '';\n\n    return `${fontStyle} ${fontWeight} ${terminal.options.fontSize! * this._coreBrowserService.dpr}px ${terminal.options.fontFamily}`;\n  }\n}\n\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { is256Color } from 'browser/renderer/shared/CharAtlasUtils';\nimport { INVERTED_DEFAULT_COLOR } from 'browser/renderer/shared/Constants';\nimport { IRenderDimensions } from 'browser/renderer/shared/Types';\nimport { ICoreBrowserService, IThemeService } from 'browser/services/Services';\nimport { ILinkifier2, ILinkifierEvent } from 'browser/Types';\nimport { IOptionsService } from 'common/services/Services';\nimport { Terminal } from 'xterm';\nimport { BaseRenderLayer } from './BaseRenderLayer';\n\nexport class LinkRenderLayer extends BaseRenderLayer {\n  private _state: ILinkifierEvent | undefined;\n\n  constructor(\n    container: HTMLElement,\n    zIndex: number,\n    terminal: Terminal,\n    linkifier2: ILinkifier2,\n    coreBrowserService: ICoreBrowserService,\n    optionsService: IOptionsService,\n    themeService: IThemeService\n  ) {\n    super(terminal, container, 'link', zIndex, true, coreBrowserService, optionsService, themeService);\n\n    this.register(linkifier2.onShowLinkUnderline(e => this._handleShowLinkUnderline(e)));\n    this.register(linkifier2.onHideLinkUnderline(e => this._handleHideLinkUnderline(e)));\n  }\n\n  public resize(terminal: Terminal, dim: IRenderDimensions): void {\n    super.resize(terminal, dim);\n    // Resizing the canvas discards the contents of the canvas so clear state\n    this._state = undefined;\n  }\n\n  public reset(terminal: Terminal): void {\n    this._clearCurrentLink();\n  }\n\n  private _clearCurrentLink(): void {\n    if (this._state) {\n      this._clearCells(this._state.x1, this._state.y1, this._state.cols - this._state.x1, 1);\n      const middleRowCount = this._state.y2 - this._state.y1 - 1;\n      if (middleRowCount > 0) {\n        this._clearCells(0, this._state.y1 + 1, this._state.cols, middleRowCount);\n      }\n      this._clearCells(0, this._state.y2, this._state.x2, 1);\n      this._state = undefined;\n    }\n  }\n\n  private _handleShowLinkUnderline(e: ILinkifierEvent): void {\n    if (e.fg === INVERTED_DEFAULT_COLOR) {\n      this._ctx.fillStyle = this._themeService.colors.background.css;\n    } else if (e.fg !== undefined && is256Color(e.fg)) {\n      // 256 color support\n      this._ctx.fillStyle = this._themeService.colors.ansi[e.fg!].css;\n    } else {\n      this._ctx.fillStyle = this._themeService.colors.foreground.css;\n    }\n\n    if (e.y1 === e.y2) {\n      // Single line link\n      this._fillBottomLineAtCells(e.x1, e.y1, e.x2 - e.x1);\n    } else {\n      // Multi-line link\n      this._fillBottomLineAtCells(e.x1, e.y1, e.cols - e.x1);\n      for (let y = e.y1 + 1; y < e.y2; y++) {\n        this._fillBottomLineAtCells(0, y, e.cols);\n      }\n      this._fillBottomLineAtCells(0, e.y2, e.x2);\n    }\n    this._state = e;\n  }\n\n  private _handleHideLinkUnderline(e: ILinkifierEvent): void {\n    this._clearCurrentLink();\n  }\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IDisposable } from 'common/Types';\n\n/**\n * Adds a disposable listener to a node in the DOM, returning the disposable.\n * @param node The node to add a listener to.\n * @param type The event type.\n * @param handler The handler for the listener.\n * @param options The boolean or options object to pass on to the event\n * listener.\n */\nexport function addDisposableDomListener(\n  node: Element | Window | Document,\n  type: string,\n  handler: (e: any) => void,\n  options?: boolean | AddEventListenerOptions\n): IDisposable {\n  node.addEventListener(type, handler, options);\n  let disposed = false;\n  return {\n    dispose: () => {\n      if (disposed) {\n        return;\n      }\n      disposed = true;\n      node.removeEventListener(type, handler, options);\n    }\n  };\n}\n","import { ISelectionRenderModel } from 'browser/renderer/shared/Types';\nimport { ICoreBrowserService, IThemeService } from 'browser/services/Services';\nimport { ReadonlyColorSet } from 'browser/Types';\nimport { Attributes, BgFlags, FgFlags } from 'common/buffer/Constants';\nimport { IDecorationService } from 'common/services/Services';\nimport { ICellData } from 'common/Types';\nimport { Terminal } from 'xterm';\n\n// Work variables to avoid garbage collection\nlet $fg = 0;\nlet $bg = 0;\nlet $hasFg = false;\nlet $hasBg = false;\nlet $isSelected = false;\nlet $colors: ReadonlyColorSet | undefined;\n\nexport class CellColorResolver {\n  /**\n   * The shared result of the {@link resolve} call. This is only safe to use immediately after as\n   * any other calls will share object.\n   */\n  public readonly result: { fg: number, bg: number, ext: number } = {\n    fg: 0,\n    bg: 0,\n    ext: 0\n  };\n\n  constructor(\n    private readonly _terminal: Terminal,\n    private readonly _selectionRenderModel: ISelectionRenderModel,\n    private readonly _decorationService: IDecorationService,\n    private readonly _coreBrowserService: ICoreBrowserService,\n    private readonly _themeService: IThemeService\n  ) {\n  }\n\n  /**\n   * Resolves colors for the cell, putting the result into the shared {@link result}. This resolves\n   * overrides, inverse and selection for the cell which can then be used to feed into the renderer.\n   */\n  public resolve(cell: ICellData, x: number, y: number): void {\n    this.result.bg = cell.bg;\n    this.result.fg = cell.fg;\n    this.result.ext = cell.bg & BgFlags.HAS_EXTENDED ? cell.extended.ext : 0;\n    // Get any foreground/background overrides, this happens on the model to avoid spreading\n    // override logic throughout the different sub-renderers\n\n    // Reset overrides work variables\n    $bg = 0;\n    $fg = 0;\n    $hasBg = false;\n    $hasFg = false;\n    $isSelected = false;\n    $colors = this._themeService.colors;\n\n    // Apply decorations on the bottom layer\n    this._decorationService.forEachDecorationAtCell(x, y, 'bottom', d => {\n      if (d.backgroundColorRGB) {\n        $bg = d.backgroundColorRGB.rgba >> 8 & 0xFFFFFF;\n        $hasBg = true;\n      }\n      if (d.foregroundColorRGB) {\n        $fg = d.foregroundColorRGB.rgba >> 8 & 0xFFFFFF;\n        $hasFg = true;\n      }\n    });\n\n    // Apply the selection color if needed\n    $isSelected = this._selectionRenderModel.isCellSelected(this._terminal, x, y);\n    if ($isSelected) {\n      $bg = (this._coreBrowserService.isFocused ? $colors.selectionBackgroundOpaque : $colors.selectionInactiveBackgroundOpaque).rgba >> 8 & 0xFFFFFF;\n      $hasBg = true;\n      if ($colors.selectionForeground) {\n        $fg = $colors.selectionForeground.rgba >> 8 & 0xFFFFFF;\n        $hasFg = true;\n      }\n    }\n\n    // Apply decorations on the top layer\n    this._decorationService.forEachDecorationAtCell(x, y, 'top', d => {\n      if (d.backgroundColorRGB) {\n        $bg = d.backgroundColorRGB.rgba >> 8 & 0xFFFFFF;\n        $hasBg = true;\n      }\n      if (d.foregroundColorRGB) {\n        $fg = d.foregroundColorRGB.rgba >> 8 & 0xFFFFFF;\n        $hasFg = true;\n      }\n    });\n\n    // Convert any overrides from rgba to the fg/bg packed format. This resolves the inverse flag\n    // ahead of time in order to use the correct cache key\n    if ($hasBg) {\n      if ($isSelected) {\n        // Non-RGB attributes from model + force non-dim + override + force RGB color mode\n        $bg = (cell.bg & ~Attributes.RGB_MASK & ~BgFlags.DIM) | $bg | Attributes.CM_RGB;\n      } else {\n        // Non-RGB attributes from model + override + force RGB color mode\n        $bg = (cell.bg & ~Attributes.RGB_MASK) | $bg | Attributes.CM_RGB;\n      }\n    }\n    if ($hasFg) {\n      // Non-RGB attributes from model + force disable inverse + override + force RGB color mode\n      $fg = (cell.fg & ~Attributes.RGB_MASK & ~FgFlags.INVERSE) | $fg | Attributes.CM_RGB;\n    }\n\n    // Handle case where inverse was specified by only one of bg override or fg override was set,\n    // resolving the other inverse color and setting the inverse flag if needed.\n    if (this.result.fg & FgFlags.INVERSE) {\n      if ($hasBg && !$hasFg) {\n        // Resolve bg color type (default color has a different meaning in fg vs bg)\n        if ((this.result.bg & Attributes.CM_MASK) === Attributes.CM_DEFAULT) {\n          $fg = (this.result.fg & ~(Attributes.RGB_MASK | FgFlags.INVERSE | Attributes.CM_MASK)) | (($colors.background.rgba >> 8 & 0xFFFFFF) & Attributes.RGB_MASK) | Attributes.CM_RGB;\n        } else {\n          $fg = (this.result.fg & ~(Attributes.RGB_MASK | FgFlags.INVERSE | Attributes.CM_MASK)) | this.result.bg & (Attributes.RGB_MASK | Attributes.CM_MASK);\n        }\n        $hasFg = true;\n      }\n      if (!$hasBg && $hasFg) {\n        // Resolve bg color type (default color has a different meaning in fg vs bg)\n        if ((this.result.fg & Attributes.CM_MASK) === Attributes.CM_DEFAULT) {\n          $bg = (this.result.bg & ~(Attributes.RGB_MASK | Attributes.CM_MASK)) | (($colors.foreground.rgba >> 8 & 0xFFFFFF) & Attributes.RGB_MASK) | Attributes.CM_RGB;\n        } else {\n          $bg = (this.result.bg & ~(Attributes.RGB_MASK | Attributes.CM_MASK)) | this.result.fg & (Attributes.RGB_MASK | Attributes.CM_MASK);\n        }\n        $hasBg = true;\n      }\n    }\n\n    // Release object\n    $colors = undefined;\n\n    // Use the override if it exists\n    this.result.bg = $hasBg ? $bg : this.result.bg;\n    this.result.fg = $hasFg ? $fg : this.result.fg;\n  }\n}\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { TextureAtlas } from 'browser/renderer/shared/TextureAtlas';\nimport { ITerminalOptions, Terminal } from 'xterm';\nimport { ITerminal, ReadonlyColorSet } from 'browser/Types';\nimport { ICharAtlasConfig, ITextureAtlas } from 'browser/renderer/shared/Types';\nimport { generateConfig, configEquals } from 'browser/renderer/shared/CharAtlasUtils';\n\ninterface ITextureAtlasCacheEntry {\n  atlas: ITextureAtlas;\n  config: ICharAtlasConfig;\n  // N.B. This implementation potentially holds onto copies of the terminal forever, so\n  // this may cause memory leaks.\n  ownedBy: Terminal[];\n}\n\nconst charAtlasCache: ITextureAtlasCacheEntry[] = [];\n\n/**\n * Acquires a char atlas, either generating a new one or returning an existing\n * one that is in use by another terminal.\n */\nexport function acquireTextureAtlas(\n  terminal: Terminal,\n  options: Required<ITerminalOptions>,\n  colors: ReadonlyColorSet,\n  deviceCellWidth: number,\n  deviceCellHeight: number,\n  deviceCharWidth: number,\n  deviceCharHeight: number,\n  devicePixelRatio: number\n): ITextureAtlas {\n  const newConfig = generateConfig(deviceCellWidth, deviceCellHeight, deviceCharWidth, deviceCharHeight, options, colors, devicePixelRatio);\n\n  // Check to see if the terminal already owns this config\n  for (let i = 0; i < charAtlasCache.length; i++) {\n    const entry = charAtlasCache[i];\n    const ownedByIndex = entry.ownedBy.indexOf(terminal);\n    if (ownedByIndex >= 0) {\n      if (configEquals(entry.config, newConfig)) {\n        return entry.atlas;\n      }\n      // The configs differ, release the terminal from the entry\n      if (entry.ownedBy.length === 1) {\n        entry.atlas.dispose();\n        charAtlasCache.splice(i, 1);\n      } else {\n        entry.ownedBy.splice(ownedByIndex, 1);\n      }\n      break;\n    }\n  }\n\n  // Try match a char atlas from the cache\n  for (let i = 0; i < charAtlasCache.length; i++) {\n    const entry = charAtlasCache[i];\n    if (configEquals(entry.config, newConfig)) {\n      // Add the terminal to the cache entry and return\n      entry.ownedBy.push(terminal);\n      return entry.atlas;\n    }\n  }\n\n  const core: ITerminal = (terminal as any)._core;\n  const newEntry: ITextureAtlasCacheEntry = {\n    atlas: new TextureAtlas(document, newConfig, core.unicodeService),\n    config: newConfig,\n    ownedBy: [terminal]\n  };\n  charAtlasCache.push(newEntry);\n  return newEntry.atlas;\n}\n\n/**\n * Removes a terminal reference from the cache, allowing its memory to be freed.\n * @param terminal The terminal to remove.\n */\nexport function removeTerminalFromCache(terminal: Terminal): void {\n  for (let i = 0; i < charAtlasCache.length; i++) {\n    const index = charAtlasCache[i].ownedBy.indexOf(terminal);\n    if (index !== -1) {\n      if (charAtlasCache[i].ownedBy.length === 1) {\n        // Remove the cache entry if it's the only terminal\n        charAtlasCache[i].atlas.dispose();\n        charAtlasCache.splice(i, 1);\n      } else {\n        // Remove the reference from the cache entry\n        charAtlasCache[i].ownedBy.splice(index, 1);\n      }\n      break;\n    }\n  }\n}\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { ICharAtlasConfig } from './Types';\nimport { Attributes } from 'common/buffer/Constants';\nimport { ITerminalOptions } from 'xterm';\nimport { IColorSet, ReadonlyColorSet } from 'browser/Types';\nimport { NULL_COLOR } from 'common/Color';\n\nexport function generateConfig(deviceCellWidth: number, deviceCellHeight: number, deviceCharWidth: number, deviceCharHeight: number, options: Required<ITerminalOptions>, colors: ReadonlyColorSet, devicePixelRatio: number): ICharAtlasConfig {\n  // null out some fields that don't matter\n  const clonedColors: IColorSet = {\n    foreground: colors.foreground,\n    background: colors.background,\n    cursor: NULL_COLOR,\n    cursorAccent: NULL_COLOR,\n    selectionForeground: NULL_COLOR,\n    selectionBackgroundTransparent: NULL_COLOR,\n    selectionBackgroundOpaque: NULL_COLOR,\n    selectionInactiveBackgroundTransparent: NULL_COLOR,\n    selectionInactiveBackgroundOpaque: NULL_COLOR,\n    // For the static char atlas, we only use the first 16 colors, but we need all 256 for the\n    // dynamic character atlas.\n    ansi: colors.ansi.slice(),\n    contrastCache: colors.contrastCache,\n    halfContrastCache: colors.halfContrastCache\n  };\n  return {\n    customGlyphs: options.customGlyphs,\n    devicePixelRatio,\n    letterSpacing: options.letterSpacing,\n    lineHeight: options.lineHeight,\n    deviceCellWidth: deviceCellWidth,\n    deviceCellHeight: deviceCellHeight,\n    deviceCharWidth: deviceCharWidth,\n    deviceCharHeight: deviceCharHeight,\n    fontFamily: options.fontFamily,\n    fontSize: options.fontSize,\n    fontWeight: options.fontWeight,\n    fontWeightBold: options.fontWeightBold,\n    allowTransparency: options.allowTransparency,\n    drawBoldTextInBrightColors: options.drawBoldTextInBrightColors,\n    minimumContrastRatio: options.minimumContrastRatio,\n    colors: clonedColors\n  };\n}\n\nexport function configEquals(a: ICharAtlasConfig, b: ICharAtlasConfig): boolean {\n  for (let i = 0; i < a.colors.ansi.length; i++) {\n    if (a.colors.ansi[i].rgba !== b.colors.ansi[i].rgba) {\n      return false;\n    }\n  }\n  return a.devicePixelRatio === b.devicePixelRatio &&\n      a.customGlyphs === b.customGlyphs &&\n      a.lineHeight === b.lineHeight &&\n      a.letterSpacing === b.letterSpacing &&\n      a.fontFamily === b.fontFamily &&\n      a.fontSize === b.fontSize &&\n      a.fontWeight === b.fontWeight &&\n      a.fontWeightBold === b.fontWeightBold &&\n      a.allowTransparency === b.allowTransparency &&\n      a.deviceCharWidth === b.deviceCharWidth &&\n      a.deviceCharHeight === b.deviceCharHeight &&\n      a.drawBoldTextInBrightColors === b.drawBoldTextInBrightColors &&\n      a.minimumContrastRatio === b.minimumContrastRatio &&\n      a.colors.foreground.rgba === b.colors.foreground.rgba &&\n      a.colors.background.rgba === b.colors.background.rgba;\n}\n\nexport function is256Color(colorCode: number): boolean {\n  return (colorCode & Attributes.CM_MASK) === Attributes.CM_P16 || (colorCode & Attributes.CM_MASK) === Attributes.CM_P256;\n}\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { isFirefox, isLegacyEdge } from 'common/Platform';\n\nexport const INVERTED_DEFAULT_COLOR = 257;\n\nexport const DIM_OPACITY = 0.5;\n// The text baseline is set conditionally by browser. Using 'ideographic' for Firefox or Legacy Edge\n// would result in truncated text (Issue 3353). Using 'bottom' for Chrome would result in slightly\n// unaligned Powerline fonts (PR 3356#issuecomment-850928179).\nexport const TEXT_BASELINE: CanvasTextBaseline = isFirefox || isLegacyEdge ? 'bottom' : 'ideographic';\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { ICoreBrowserService } from 'browser/services/Services';\n\n/**\n * The time between cursor blinks.\n */\nconst BLINK_INTERVAL = 600;\n\nexport class CursorBlinkStateManager {\n  public isCursorVisible: boolean;\n\n  private _animationFrame: number | undefined;\n  private _blinkStartTimeout: number | undefined;\n  private _blinkInterval: number | undefined;\n\n  /**\n   * The time at which the animation frame was restarted, this is used on the\n   * next render to restart the timers so they don't need to restart the timers\n   * multiple times over a short period.\n   */\n  private _animationTimeRestarted: number | undefined;\n\n  constructor(\n    private _renderCallback: () => void,\n    private _coreBrowserService: ICoreBrowserService\n  ) {\n    this.isCursorVisible = true;\n    if (this._coreBrowserService.isFocused) {\n      this._restartInterval();\n    }\n  }\n\n  public get isPaused(): boolean { return !(this._blinkStartTimeout || this._blinkInterval); }\n\n  public dispose(): void {\n    if (this._blinkInterval) {\n      this._coreBrowserService.window.clearInterval(this._blinkInterval);\n      this._blinkInterval = undefined;\n    }\n    if (this._blinkStartTimeout) {\n      this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout);\n      this._blinkStartTimeout = undefined;\n    }\n    if (this._animationFrame) {\n      this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame);\n      this._animationFrame = undefined;\n    }\n  }\n\n  public restartBlinkAnimation(): void {\n    if (this.isPaused) {\n      return;\n    }\n    // Save a timestamp so that the restart can be done on the next interval\n    this._animationTimeRestarted = Date.now();\n    // Force a cursor render to ensure it's visible and in the correct position\n    this.isCursorVisible = true;\n    if (!this._animationFrame) {\n      this._animationFrame = this._coreBrowserService.window.requestAnimationFrame(() => {\n        this._renderCallback();\n        this._animationFrame = undefined;\n      });\n    }\n  }\n\n  private _restartInterval(timeToStart: number = BLINK_INTERVAL): void {\n    // Clear any existing interval\n    if (this._blinkInterval) {\n      this._coreBrowserService.window.clearInterval(this._blinkInterval);\n      this._blinkInterval = undefined;\n    }\n\n    // Setup the initial timeout which will hide the cursor, this is done before\n    // the regular interval is setup in order to support restarting the blink\n    // animation in a lightweight way (without thrashing clearInterval and\n    // setInterval).\n    this._blinkStartTimeout = this._coreBrowserService.window.setTimeout(() => {\n      // Check if another animation restart was requested while this was being\n      // started\n      if (this._animationTimeRestarted) {\n        const time = BLINK_INTERVAL - (Date.now() - this._animationTimeRestarted);\n        this._animationTimeRestarted = undefined;\n        if (time > 0) {\n          this._restartInterval(time);\n          return;\n        }\n      }\n\n      // Hide the cursor\n      this.isCursorVisible = false;\n      this._animationFrame = this._coreBrowserService.window.requestAnimationFrame(() => {\n        this._renderCallback();\n        this._animationFrame = undefined;\n      });\n\n      // Setup the blink interval\n      this._blinkInterval = this._coreBrowserService.window.setInterval(() => {\n        // Adjust the animation time if it was restarted\n        if (this._animationTimeRestarted) {\n          // calc time diff\n          // Make restart interval do a setTimeout initially?\n          const time = BLINK_INTERVAL - (Date.now() - this._animationTimeRestarted);\n          this._animationTimeRestarted = undefined;\n          this._restartInterval(time);\n          return;\n        }\n\n        // Invert visibility and render\n        this.isCursorVisible = !this.isCursorVisible;\n        this._animationFrame = this._coreBrowserService.window.requestAnimationFrame(() => {\n          this._renderCallback();\n          this._animationFrame = undefined;\n        });\n      }, BLINK_INTERVAL);\n    }, timeToStart);\n  }\n\n  public pause(): void {\n    this.isCursorVisible = true;\n    if (this._blinkInterval) {\n      this._coreBrowserService.window.clearInterval(this._blinkInterval);\n      this._blinkInterval = undefined;\n    }\n    if (this._blinkStartTimeout) {\n      this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout);\n      this._blinkStartTimeout = undefined;\n    }\n    if (this._animationFrame) {\n      this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame);\n      this._animationFrame = undefined;\n    }\n  }\n\n  public resume(): void {\n    // Clear out any existing timers just in case\n    this.pause();\n\n    this._animationTimeRestarted = undefined;\n    this._restartInterval();\n    this.restartBlinkAnimation();\n  }\n}\n","/**\n * Copyright (c) 2021 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { throwIfFalsy } from 'browser/renderer/shared/RendererUtils';\n\ninterface IBlockVector {\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n}\n\nexport const blockElementDefinitions: { [index: string]: IBlockVector[] | undefined } = {\n  // Block elements (0x2580-0x2590)\n  '': [{ x: 0, y: 0, w: 8, h: 4 }], // UPPER HALF BLOCK\n  '': [{ x: 0, y: 7, w: 8, h: 1 }], // LOWER ONE EIGHTH BLOCK\n  '': [{ x: 0, y: 6, w: 8, h: 2 }], // LOWER ONE QUARTER BLOCK\n  '': [{ x: 0, y: 5, w: 8, h: 3 }], // LOWER THREE EIGHTHS BLOCK\n  '': [{ x: 0, y: 4, w: 8, h: 4 }], // LOWER HALF BLOCK\n  '': [{ x: 0, y: 3, w: 8, h: 5 }], // LOWER FIVE EIGHTHS BLOCK\n  '': [{ x: 0, y: 2, w: 8, h: 6 }], // LOWER THREE QUARTERS BLOCK\n  '': [{ x: 0, y: 1, w: 8, h: 7 }], // LOWER SEVEN EIGHTHS BLOCK\n  '': [{ x: 0, y: 0, w: 8, h: 8 }], // FULL BLOCK\n  '': [{ x: 0, y: 0, w: 7, h: 8 }], // LEFT SEVEN EIGHTHS BLOCK\n  '': [{ x: 0, y: 0, w: 6, h: 8 }], // LEFT THREE QUARTERS BLOCK\n  '': [{ x: 0, y: 0, w: 5, h: 8 }], // LEFT FIVE EIGHTHS BLOCK\n  '': [{ x: 0, y: 0, w: 4, h: 8 }], // LEFT HALF BLOCK\n  '': [{ x: 0, y: 0, w: 3, h: 8 }], // LEFT THREE EIGHTHS BLOCK\n  '': [{ x: 0, y: 0, w: 2, h: 8 }], // LEFT ONE QUARTER BLOCK\n  '': [{ x: 0, y: 0, w: 1, h: 8 }], // LEFT ONE EIGHTH BLOCK\n  '': [{ x: 4, y: 0, w: 4, h: 8 }], // RIGHT HALF BLOCK\n\n  // Block elements (0x2594-0x2595)\n  '': [{ x: 0, y: 0, w: 8, h: 1 }], // UPPER ONE EIGHTH BLOCK\n  '': [{ x: 7, y: 0, w: 1, h: 8 }], // RIGHT ONE EIGHTH BLOCK\n\n  // Terminal graphic characters (0x2596-0x259F)\n  '': [{ x: 0, y: 4, w: 4, h: 4 }],                             // QUADRANT LOWER LEFT\n  '': [{ x: 4, y: 4, w: 4, h: 4 }],                             // QUADRANT LOWER RIGHT\n  '': [{ x: 0, y: 0, w: 4, h: 4 }],                             // QUADRANT UPPER LEFT\n  '': [{ x: 0, y: 0, w: 4, h: 8 }, { x: 0, y: 4, w: 8, h: 4 }], // QUADRANT UPPER LEFT AND LOWER LEFT AND LOWER RIGHT\n  '': [{ x: 0, y: 0, w: 4, h: 4 }, { x: 4, y: 4, w: 4, h: 4 }], // QUADRANT UPPER LEFT AND LOWER RIGHT\n  '': [{ x: 0, y: 0, w: 4, h: 8 }, { x: 4, y: 0, w: 4, h: 4 }], // QUADRANT UPPER LEFT AND UPPER RIGHT AND LOWER LEFT\n  '': [{ x: 0, y: 0, w: 8, h: 4 }, { x: 4, y: 0, w: 4, h: 8 }], // QUADRANT UPPER LEFT AND UPPER RIGHT AND LOWER RIGHT\n  '': [{ x: 4, y: 0, w: 4, h: 4 }],                             // QUADRANT UPPER RIGHT\n  '': [{ x: 4, y: 0, w: 4, h: 4 }, { x: 0, y: 4, w: 4, h: 4 }], // QUADRANT UPPER RIGHT AND LOWER LEFT\n  '': [{ x: 4, y: 0, w: 4, h: 8 }, { x: 0, y: 4, w: 8, h: 4 }], // QUADRANT UPPER RIGHT AND LOWER LEFT AND LOWER RIGHT\n\n  // VERTICAL ONE EIGHTH BLOCK-2 through VERTICAL ONE EIGHTH BLOCK-7\n  '\\u{1FB70}': [{ x: 1, y: 0, w: 1, h: 8 }],\n  '\\u{1FB71}': [{ x: 2, y: 0, w: 1, h: 8 }],\n  '\\u{1FB72}': [{ x: 3, y: 0, w: 1, h: 8 }],\n  '\\u{1FB73}': [{ x: 4, y: 0, w: 1, h: 8 }],\n  '\\u{1FB74}': [{ x: 5, y: 0, w: 1, h: 8 }],\n  '\\u{1FB75}': [{ x: 6, y: 0, w: 1, h: 8 }],\n\n  // HORIZONTAL ONE EIGHTH BLOCK-2 through HORIZONTAL ONE EIGHTH BLOCK-7\n  '\\u{1FB76}': [{ x: 0, y: 1, w: 8, h: 1 }],\n  '\\u{1FB77}': [{ x: 0, y: 2, w: 8, h: 1 }],\n  '\\u{1FB78}': [{ x: 0, y: 3, w: 8, h: 1 }],\n  '\\u{1FB79}': [{ x: 0, y: 4, w: 8, h: 1 }],\n  '\\u{1FB7A}': [{ x: 0, y: 5, w: 8, h: 1 }],\n  '\\u{1FB7B}': [{ x: 0, y: 6, w: 8, h: 1 }],\n\n  // LEFT AND LOWER ONE EIGHTH BLOCK\n  '\\u{1FB7C}': [{ x: 0, y: 0, w: 1, h: 8 }, { x: 0, y: 7, w: 8, h: 1 }],\n  // LEFT AND UPPER ONE EIGHTH BLOCK\n  '\\u{1FB7D}': [{ x: 0, y: 0, w: 1, h: 8 }, { x: 0, y: 0, w: 8, h: 1 }],\n  // RIGHT AND UPPER ONE EIGHTH BLOCK\n  '\\u{1FB7E}': [{ x: 7, y: 0, w: 1, h: 8 }, { x: 0, y: 0, w: 8, h: 1 }],\n  // RIGHT AND LOWER ONE EIGHTH BLOCK\n  '\\u{1FB7F}': [{ x: 7, y: 0, w: 1, h: 8 }, { x: 0, y: 7, w: 8, h: 1 }],\n  // UPPER AND LOWER ONE EIGHTH BLOCK\n  '\\u{1FB80}': [{ x: 0, y: 0, w: 8, h: 1 }, { x: 0, y: 7, w: 8, h: 1 }],\n  // HORIZONTAL ONE EIGHTH BLOCK-1358\n  '\\u{1FB81}': [{ x: 0, y: 0, w: 8, h: 1 }, { x: 0, y: 2, w: 8, h: 1 }, { x: 0, y: 4, w: 8, h: 1 }, { x: 0, y: 7, w: 8, h: 1 }],\n\n  // UPPER ONE QUARTER BLOCK\n  '\\u{1FB82}': [{ x: 0, y: 0, w: 8, h: 2 }],\n  // UPPER THREE EIGHTHS BLOCK\n  '\\u{1FB83}': [{ x: 0, y: 0, w: 8, h: 3 }],\n  // UPPER FIVE EIGHTHS BLOCK\n  '\\u{1FB84}': [{ x: 0, y: 0, w: 8, h: 5 }],\n  // UPPER THREE QUARTERS BLOCK\n  '\\u{1FB85}': [{ x: 0, y: 0, w: 8, h: 6 }],\n  // UPPER SEVEN EIGHTHS BLOCK\n  '\\u{1FB86}': [{ x: 0, y: 0, w: 8, h: 7 }],\n\n  // RIGHT ONE QUARTER BLOCK\n  '\\u{1FB87}': [{ x: 6, y: 0, w: 2, h: 8 }],\n  // RIGHT THREE EIGHTHS B0OCK\n  '\\u{1FB88}': [{ x: 5, y: 0, w: 3, h: 8 }],\n  // RIGHT FIVE EIGHTHS BL0CK\n  '\\u{1FB89}': [{ x: 3, y: 0, w: 5, h: 8 }],\n  // RIGHT THREE QUARTERS 0LOCK\n  '\\u{1FB8A}': [{ x: 2, y: 0, w: 6, h: 8 }],\n  // RIGHT SEVEN EIGHTHS B0OCK\n  '\\u{1FB8B}': [{ x: 1, y: 0, w: 7, h: 8 }],\n\n  // CHECKER BOARD FILL\n  '\\u{1FB95}': [\n    { x: 0, y: 0, w: 2, h: 2 }, { x: 4, y: 0, w: 2, h: 2 },\n    { x: 2, y: 2, w: 2, h: 2 }, { x: 6, y: 2, w: 2, h: 2 },\n    { x: 0, y: 4, w: 2, h: 2 }, { x: 4, y: 4, w: 2, h: 2 },\n    { x: 2, y: 6, w: 2, h: 2 }, { x: 6, y: 6, w: 2, h: 2 }\n  ],\n  // INVERSE CHECKER BOARD FILL\n  '\\u{1FB96}': [\n    { x: 2, y: 0, w: 2, h: 2 }, { x: 6, y: 0, w: 2, h: 2 },\n    { x: 0, y: 2, w: 2, h: 2 }, { x: 4, y: 2, w: 2, h: 2 },\n    { x: 2, y: 4, w: 2, h: 2 }, { x: 6, y: 4, w: 2, h: 2 },\n    { x: 0, y: 6, w: 2, h: 2 }, { x: 4, y: 6, w: 2, h: 2 }\n  ],\n  // HEAVY HORIZONTAL FILL (upper middle and lower one quarter block)\n  '\\u{1FB97}': [{ x: 0, y: 2, w: 8, h: 2 }, { x: 0, y: 6, w: 8, h: 2 }]\n};\n\ntype PatternDefinition = number[][];\n\n/**\n * Defines the repeating pattern used by special characters, the pattern is made up of a 2d array of\n * pixel values to be filled (1) or not filled (0).\n */\nconst patternCharacterDefinitions: { [key: string]: PatternDefinition | undefined } = {\n  // Shade characters (0x2591-0x2593)\n  '': [ // LIGHT SHADE (25%)\n    [1, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 1, 0],\n    [0, 0, 0, 0]\n  ],\n  '': [ // MEDIUM SHADE (50%)\n    [1, 0],\n    [0, 0],\n    [0, 1],\n    [0, 0]\n  ],\n  '': [ // DARK SHADE (75%)\n    [0, 1],\n    [1, 1],\n    [1, 0],\n    [1, 1]\n  ]\n};\n\nconst enum Shapes {\n  /**  */ TOP_TO_BOTTOM = 'M.5,0 L.5,1',\n  /**  */ LEFT_TO_RIGHT = 'M0,.5 L1,.5',\n\n  /**  */ TOP_TO_RIGHT = 'M.5,0 L.5,.5 L1,.5',\n  /**  */ TOP_TO_LEFT = 'M.5,0 L.5,.5 L0,.5',\n  /**  */ LEFT_TO_BOTTOM = 'M0,.5 L.5,.5 L.5,1',\n  /**  */ RIGHT_TO_BOTTOM = 'M0.5,1 L.5,.5 L1,.5',\n\n  /**  */ MIDDLE_TO_TOP = 'M.5,.5 L.5,0',\n  /**  */ MIDDLE_TO_LEFT = 'M.5,.5 L0,.5',\n  /**  */ MIDDLE_TO_RIGHT = 'M.5,.5 L1,.5',\n  /**  */ MIDDLE_TO_BOTTOM = 'M.5,.5 L.5,1',\n\n  /**  */ T_TOP = 'M0,.5 L1,.5 M.5,.5 L.5,0',\n  /**  */ T_LEFT = 'M.5,0 L.5,1 M.5,.5 L0,.5',\n  /**  */ T_RIGHT = 'M.5,0 L.5,1 M.5,.5 L1,.5',\n  /**  */ T_BOTTOM = 'M0,.5 L1,.5 M.5,.5 L.5,1',\n\n  /**  */ CROSS = 'M0,.5 L1,.5 M.5,0 L.5,1',\n\n  /**  */ TWO_DASHES_HORIZONTAL = 'M.1,.5 L.4,.5 M.6,.5 L.9,.5', // .2 empty, .3 filled\n  /**  */ THREE_DASHES_HORIZONTAL = 'M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5', // .1333 empty, .2 filled\n  /**  */ FOUR_DASHES_HORIZONTAL = 'M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5', // .1 empty, .15 filled\n  /**  */ TWO_DASHES_VERTICAL = 'M.5,.1 L.5,.4 M.5,.6 L.5,.9',\n  /**  */ THREE_DASHES_VERTICAL = 'M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333',\n  /**  */ FOUR_DASHES_VERTICAL = 'M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95',\n}\n\nconst enum Style {\n  NORMAL = 1,\n  BOLD = 3\n}\n\n/**\n * @param xp The percentage of 15% of the x axis.\n * @param yp The percentage of 15% of the x axis on the y axis.\n */\ntype DrawFunctionDefinition = (xp: number, yp: number) => string;\n\n/**\n * This contains the definitions of all box drawing characters in the format of SVG paths (ie. the\n * svg d attribute).\n */\nexport const boxDrawingDefinitions: { [character: string]: { [fontWeight: number]: string | DrawFunctionDefinition } | undefined } = {\n  // Uniform normal and bold\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_RIGHT },\n  '': { [Style.BOLD]:   Shapes.LEFT_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_BOTTOM },\n  '': { [Style.BOLD]:   Shapes.TOP_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.RIGHT_TO_BOTTOM },\n  '': { [Style.BOLD]:   Shapes.RIGHT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_BOTTOM },\n  '': { [Style.BOLD]:   Shapes.LEFT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_RIGHT },\n  '': { [Style.BOLD]:   Shapes.TOP_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_LEFT },\n  '': { [Style.BOLD]:   Shapes.TOP_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.T_RIGHT },\n  '': { [Style.BOLD]:   Shapes.T_RIGHT },\n  '': { [Style.NORMAL]: Shapes.T_LEFT },\n  '': { [Style.BOLD]:   Shapes.T_LEFT },\n  '': { [Style.NORMAL]: Shapes.T_BOTTOM },\n  '': { [Style.BOLD]:   Shapes.T_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.T_TOP },\n  '': { [Style.BOLD]:   Shapes.T_TOP },\n  '': { [Style.NORMAL]: Shapes.CROSS },\n  '': { [Style.BOLD]:   Shapes.CROSS },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.BOLD]:   Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.BOLD]:   Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.BOLD]:   Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.BOLD]:   Shapes.MIDDLE_TO_BOTTOM },\n\n  // Double border\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 - yp} L1,${.5 - yp} M0,${.5 + yp} L1,${.5 + yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `M${.5 - xp},0 L${.5 - xp},1 M${.5 + xp},0 L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M.5,1 L.5,${.5 - yp} L1,${.5 - yp} M.5,${.5 + yp} L1,${.5 + yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `M${.5 - xp},1 L${.5 - xp},.5 L1,.5 M${.5 + xp},.5 L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M1,${.5 - yp} L${.5 - xp},${.5 - yp} L${.5 - xp},1 M1,${.5 + yp} L${.5 + xp},${.5 + yp} L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 - yp} L.5,${.5 - yp} L.5,1 M0,${.5 + yp} L.5,${.5 + yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `M${.5 + xp},1 L${.5 + xp},.5 L0,.5 M${.5 - xp},.5 L${.5 - xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 + yp} L${.5 - xp},${.5 + yp} L${.5 - xp},1 M0,${.5 - yp} L${.5 + xp},${.5 - yp} L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M.5,0 L.5,${.5 + yp} L1,${.5 + yp} M.5,${.5 - yp} L1,${.5 - yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `M1,.5 L${.5 - xp},.5 L${.5 - xp},0 M${.5 + xp},.5 L${.5 + xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `M1,${.5 - yp} L${.5 + xp},${.5 - yp} L${.5 + xp},0 M1,${.5 + yp} L${.5 - xp},${.5 + yp} L${.5 - xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 + yp} L.5,${.5 + yp} L.5,0 M0,${.5 - yp} L.5,${.5 - yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,.5 L${.5 + xp},.5 L${.5 + xp},0 M${.5 - xp},.5 L${.5 - xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 - yp} L${.5 - xp},${.5 - yp} L${.5 - xp},0 M0,${.5 + yp} L${.5 + xp},${.5 + yp} L${.5 + xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `${Shapes.TOP_TO_BOTTOM} M.5,${.5 - yp} L1,${.5 - yp} M.5,${.5 + yp} L1,${.5 + yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `M${.5 - xp},0 L${.5 - xp},1 M${.5 + xp},0 L${.5 + xp},1 M${.5 + xp},.5 L1,.5` },\n  '': { [Style.NORMAL]: (xp, yp) => `M${.5 - xp},0 L${.5 - xp},1 M1,${.5 + yp} L${.5 + xp},${.5 + yp} L${.5 + xp},1 M1,${.5 - yp} L${.5 + xp},${.5 - yp} L${.5 + xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `${Shapes.TOP_TO_BOTTOM} M0,${.5 - yp} L.5,${.5 - yp} M0,${.5 + yp} L.5,${.5 + yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,.5 L${.5 - xp},.5 M${.5 - xp},0 L${.5 - xp},1 M${.5 + xp},0 L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M${.5 + xp},0 L${.5 + xp},1 M0,${.5 + yp} L${.5 - xp},${.5 + yp} L${.5 - xp},1 M0,${.5 - yp} L${.5 - xp},${.5 - yp} L${.5 - xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 - yp} L1,${.5 - yp} M0,${.5 + yp} L1,${.5 + yp} M.5,${.5 + yp} L.5,1` },\n  '': { [Style.NORMAL]: (xp, yp) => `${Shapes.LEFT_TO_RIGHT} M${.5 - xp},.5 L${.5 - xp},1 M${.5 + xp},.5 L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 - yp} L1,${.5 - yp} M0,${.5 + yp} L${.5 - xp},${.5 + yp} L${.5 - xp},1 M1,${.5 + yp} L${.5 + xp},${.5 + yp} L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M.5,0 L.5,${.5 - yp} M0,${.5 - yp} L1,${.5 - yp} M0,${.5 + yp} L1,${.5 + yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `${Shapes.LEFT_TO_RIGHT} M${.5 - xp},.5 L${.5 - xp},0 M${.5 + xp},.5 L${.5 + xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 + yp} L1,${.5 + yp} M0,${.5 - yp} L${.5 - xp},${.5 - yp} L${.5 - xp},0 M1,${.5 - yp} L${.5 + xp},${.5 - yp} L${.5 + xp},0` },\n  '': { [Style.NORMAL]: (xp, yp) => `${Shapes.TOP_TO_BOTTOM} M0,${.5 - yp} L1,${.5 - yp} M0,${.5 + yp} L1,${.5 + yp}` },\n  '': { [Style.NORMAL]: (xp, yp) => `${Shapes.LEFT_TO_RIGHT} M${.5 - xp},0 L${.5 - xp},1 M${.5 + xp},0 L${.5 + xp},1` },\n  '': { [Style.NORMAL]: (xp, yp) => `M0,${.5 + yp} L${.5 - xp},${.5 + yp} L${.5 - xp},1 M1,${.5 + yp} L${.5 + xp},${.5 + yp} L${.5 + xp},1 M0,${.5 - yp} L${.5 - xp},${.5 - yp} L${.5 - xp},0 M1,${.5 - yp} L${.5 + xp},${.5 - yp} L${.5 + xp},0` },\n\n  // Diagonal\n  '': { [Style.NORMAL]: 'M1,0 L0,1' },\n  '': { [Style.NORMAL]: 'M0,0 L1,1' },\n  '': { [Style.NORMAL]: 'M1,0 L0,1 M0,0 L1,1' },\n\n  // Mixed weight\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT,                                [Style.BOLD]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP,                                 [Style.BOLD]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT,                               [Style.BOLD]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM,                              [Style.BOLD]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM,                              [Style.BOLD]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT,                               [Style.BOLD]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM,                              [Style.BOLD]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT,                                [Style.BOLD]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP,                                 [Style.BOLD]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT,                               [Style.BOLD]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP,                                 [Style.BOLD]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT,                                [Style.BOLD]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_BOTTOM,                                 [Style.BOLD]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.RIGHT_TO_BOTTOM,                               [Style.BOLD]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_RIGHT,                                  [Style.BOLD]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT,                               [Style.BOLD]: Shapes.TOP_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM,                              [Style.BOLD]: Shapes.TOP_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP,                                 [Style.BOLD]: Shapes.RIGHT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_BOTTOM,                                 [Style.BOLD]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_BOTTOM,                                [Style.BOLD]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_LEFT,                                   [Style.BOLD]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT,                                [Style.BOLD]: Shapes.TOP_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM,                              [Style.BOLD]: Shapes.TOP_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP,                                 [Style.BOLD]: Shapes.LEFT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.RIGHT_TO_BOTTOM,                               [Style.BOLD]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_BOTTOM,                                [Style.BOLD]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM,                              [Style.BOLD]: Shapes.LEFT_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_RIGHT,                                 [Style.BOLD]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT,                               [Style.BOLD]: Shapes.LEFT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT,                                [Style.BOLD]: Shapes.RIGHT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_RIGHT,                                  [Style.BOLD]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_LEFT,                                   [Style.BOLD]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP,                                 [Style.BOLD]: Shapes.LEFT_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_RIGHT,                                 [Style.BOLD]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT,                               [Style.BOLD]: Shapes.TOP_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT,                                [Style.BOLD]: Shapes.TOP_TO_RIGHT },\n  '': { [Style.NORMAL]: `${Shapes.TOP_TO_BOTTOM} ${Shapes.MIDDLE_TO_RIGHT}`,  [Style.BOLD]: Shapes.MIDDLE_TO_LEFT },\n  '': { [Style.NORMAL]: `${Shapes.TOP_TO_BOTTOM} ${Shapes.MIDDLE_TO_LEFT}`,   [Style.BOLD]: Shapes.MIDDLE_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_BOTTOM,                                 [Style.BOLD]: Shapes.LEFT_TO_RIGHT },\n  '': { [Style.NORMAL]: `${Shapes.LEFT_TO_RIGHT} ${Shapes.MIDDLE_TO_BOTTOM}`, [Style.BOLD]: Shapes.MIDDLE_TO_TOP },\n  '': { [Style.NORMAL]: `${Shapes.MIDDLE_TO_TOP} ${Shapes.LEFT_TO_RIGHT}`,    [Style.BOLD]: Shapes.MIDDLE_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_RIGHT,                                 [Style.BOLD]: Shapes.TOP_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.RIGHT_TO_BOTTOM,                               [Style.BOLD]: Shapes.TOP_TO_LEFT },\n  '': { [Style.NORMAL]: Shapes.LEFT_TO_BOTTOM,                                [Style.BOLD]: Shapes.TOP_TO_RIGHT },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_RIGHT,                                  [Style.BOLD]: Shapes.LEFT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.TOP_TO_LEFT,                                   [Style.BOLD]: Shapes.RIGHT_TO_BOTTOM },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_BOTTOM,                              [Style.BOLD]: `${Shapes.MIDDLE_TO_TOP} ${Shapes.LEFT_TO_RIGHT}` },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_TOP,                                 [Style.BOLD]: `${Shapes.LEFT_TO_RIGHT} ${Shapes.MIDDLE_TO_BOTTOM}` },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_RIGHT,                               [Style.BOLD]: `${Shapes.TOP_TO_BOTTOM} ${Shapes.MIDDLE_TO_LEFT}` },\n  '': { [Style.NORMAL]: Shapes.MIDDLE_TO_LEFT,                                [Style.BOLD]: `${Shapes.TOP_TO_BOTTOM} ${Shapes.MIDDLE_TO_RIGHT}` },\n\n  // Dashed\n  '': { [Style.NORMAL]: Shapes.TWO_DASHES_HORIZONTAL },\n  '': { [Style.BOLD]:   Shapes.TWO_DASHES_HORIZONTAL },\n  '': { [Style.NORMAL]: Shapes.THREE_DASHES_HORIZONTAL },\n  '': { [Style.BOLD]:   Shapes.THREE_DASHES_HORIZONTAL },\n  '': { [Style.NORMAL]: Shapes.FOUR_DASHES_HORIZONTAL },\n  '': { [Style.BOLD]:   Shapes.FOUR_DASHES_HORIZONTAL },\n  '': { [Style.NORMAL]: Shapes.TWO_DASHES_VERTICAL },\n  '': { [Style.BOLD]:   Shapes.TWO_DASHES_VERTICAL },\n  '': { [Style.NORMAL]: Shapes.THREE_DASHES_VERTICAL  },\n  '': { [Style.BOLD]:   Shapes.THREE_DASHES_VERTICAL },\n  '': { [Style.NORMAL]: Shapes.FOUR_DASHES_VERTICAL },\n  '': { [Style.BOLD]:   Shapes.FOUR_DASHES_VERTICAL },\n\n  // Curved\n  '': { [Style.NORMAL]: (xp, yp) => `M.5,1 L.5,${.5 + (yp / .15 * .5)} C.5,${.5 + (yp / .15 * .5)},.5,.5,1,.5` },\n  '': { [Style.NORMAL]: (xp, yp) => `M.5,1 L.5,${.5 + (yp / .15 * .5)} C.5,${.5 + (yp / .15 * .5)},.5,.5,0,.5` },\n  '': { [Style.NORMAL]: (xp, yp) => `M.5,0 L.5,${.5 - (yp / .15 * .5)} C.5,${.5 - (yp / .15 * .5)},.5,.5,0,.5` },\n  '': { [Style.NORMAL]: (xp, yp) => `M.5,0 L.5,${.5 - (yp / .15 * .5)} C.5,${.5 - (yp / .15 * .5)},.5,.5,1,.5` }\n};\n\ninterface IVectorShape {\n  d: string;\n  type: VectorType;\n  leftPadding?: number;\n  rightPadding?: number;\n}\n\nconst enum VectorType {\n  FILL,\n  STROKE\n}\n\n/**\n * This contains the definitions of the primarily used box drawing characters as vector shapes. The\n * reason these characters are defined specially is to avoid common problems if a user's font has\n * not been patched with powerline characters and also to get pixel perfect rendering as rendering\n * issues can occur around AA/SPAA.\n *\n * The line variants draw beyond the cell and get clipped to ensure the end of the line is not\n * visible.\n *\n * Original symbols defined in https://github.com/powerline/fontpatcher\n */\nexport const powerlineDefinitions: { [index: string]: IVectorShape } = {\n  // Right triangle solid\n  '\\u{E0B0}': { d: 'M0,0 L1,.5 L0,1', type: VectorType.FILL, rightPadding: 2 },\n  // Right triangle line\n  '\\u{E0B1}': { d: 'M-1,-.5 L1,.5 L-1,1.5', type: VectorType.STROKE, leftPadding: 1, rightPadding: 1 },\n  // Left triangle solid\n  '\\u{E0B2}': { d: 'M1,0 L0,.5 L1,1', type: VectorType.FILL, leftPadding: 2 },\n  // Left triangle line\n  '\\u{E0B3}': { d: 'M2,-.5 L0,.5 L2,1.5', type: VectorType.STROKE, leftPadding: 1, rightPadding: 1 },\n  // Right semi-circle solid\n  '\\u{E0B4}': { d: 'M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0', type: VectorType.FILL, rightPadding: 1 },\n  // Right semi-circle line\n  '\\u{E0B5}': { d: 'M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0', type: VectorType.STROKE, rightPadding: 1 },\n  // Left semi-circle solid\n  '\\u{E0B6}': { d: 'M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0', type: VectorType.FILL, leftPadding: 1 },\n  // Left semi-circle line\n  '\\u{E0B7}': { d: 'M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0', type: VectorType.STROKE, leftPadding: 1 },\n  // Lower left triangle\n  '\\u{E0B8}': { d: 'M-.5,-.5 L1.5,1.5 L-.5,1.5', type: VectorType.FILL },\n  // Backslash separator\n  '\\u{E0B9}': { d: 'M-.5,-.5 L1.5,1.5', type: VectorType.STROKE, leftPadding: 1, rightPadding: 1 },\n  // Lower right triangle\n  '\\u{E0BA}': { d: 'M1.5,-.5 L-.5,1.5 L1.5,1.5', type: VectorType.FILL },\n  // Upper left triangle\n  '\\u{E0BC}': { d: 'M1.5,-.5 L-.5,1.5 L-.5,-.5', type: VectorType.FILL },\n  // Forward slash separator\n  '\\u{E0BD}': { d: 'M1.5,-.5 L-.5,1.5', type: VectorType.STROKE, leftPadding: 1, rightPadding: 1 },\n  // Upper right triangle\n  '\\u{E0BE}': { d: 'M-.5,-.5 L1.5,1.5 L1.5,-.5', type: VectorType.FILL }\n};\n// Forward slash separator redundant\npowerlineDefinitions['\\u{E0BB}'] = powerlineDefinitions['\\u{E0BD}'];\n// Backslash separator redundant\npowerlineDefinitions['\\u{E0BF}'] = powerlineDefinitions['\\u{E0B9}'];\n\n/**\n * Try drawing a custom block element or box drawing character, returning whether it was\n * successfully drawn.\n */\nexport function tryDrawCustomChar(\n  ctx: CanvasRenderingContext2D,\n  c: string,\n  xOffset: number,\n  yOffset: number,\n  deviceCellWidth: number,\n  deviceCellHeight: number,\n  fontSize: number,\n  devicePixelRatio: number\n): boolean {\n  const blockElementDefinition = blockElementDefinitions[c];\n  if (blockElementDefinition) {\n    drawBlockElementChar(ctx, blockElementDefinition, xOffset, yOffset, deviceCellWidth, deviceCellHeight);\n    return true;\n  }\n\n  const patternDefinition = patternCharacterDefinitions[c];\n  if (patternDefinition) {\n    drawPatternChar(ctx, patternDefinition, xOffset, yOffset, deviceCellWidth, deviceCellHeight);\n    return true;\n  }\n\n  const boxDrawingDefinition = boxDrawingDefinitions[c];\n  if (boxDrawingDefinition) {\n    drawBoxDrawingChar(ctx, boxDrawingDefinition, xOffset, yOffset, deviceCellWidth, deviceCellHeight, devicePixelRatio);\n    return true;\n  }\n\n  const powerlineDefinition = powerlineDefinitions[c];\n  if (powerlineDefinition) {\n    drawPowerlineChar(ctx, powerlineDefinition, xOffset, yOffset, deviceCellWidth, deviceCellHeight, fontSize, devicePixelRatio);\n    return true;\n  }\n\n  return false;\n}\n\nfunction drawBlockElementChar(\n  ctx: CanvasRenderingContext2D,\n  charDefinition: IBlockVector[],\n  xOffset: number,\n  yOffset: number,\n  deviceCellWidth: number,\n  deviceCellHeight: number\n): void {\n  for (let i = 0; i < charDefinition.length; i++) {\n    const box = charDefinition[i];\n    const xEighth = deviceCellWidth / 8;\n    const yEighth = deviceCellHeight / 8;\n    ctx.fillRect(\n      xOffset + box.x * xEighth,\n      yOffset + box.y * yEighth,\n      box.w * xEighth,\n      box.h * yEighth\n    );\n  }\n}\n\nconst cachedPatterns: Map<PatternDefinition, Map</* fillStyle */string, CanvasPattern>> = new Map();\n\nfunction drawPatternChar(\n  ctx: CanvasRenderingContext2D,\n  charDefinition: number[][],\n  xOffset: number,\n  yOffset: number,\n  deviceCellWidth: number,\n  deviceCellHeight: number\n): void {\n  let patternSet = cachedPatterns.get(charDefinition);\n  if (!patternSet) {\n    patternSet = new Map();\n    cachedPatterns.set(charDefinition, patternSet);\n  }\n  const fillStyle = ctx.fillStyle;\n  if (typeof fillStyle !== 'string') {\n    throw new Error(`Unexpected fillStyle type \"${fillStyle}\"`);\n  }\n  let pattern = patternSet.get(fillStyle);\n  if (!pattern) {\n    const width = charDefinition[0].length;\n    const height = charDefinition.length;\n    const tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    const tmpCtx = throwIfFalsy(tmpCanvas.getContext('2d'));\n    const imageData = new ImageData(width, height);\n\n    // Extract rgba from fillStyle\n    let r: number;\n    let g: number;\n    let b: number;\n    let a: number;\n    if (fillStyle.startsWith('#')) {\n      r = parseInt(fillStyle.slice(1, 3), 16);\n      g = parseInt(fillStyle.slice(3, 5), 16);\n      b = parseInt(fillStyle.slice(5, 7), 16);\n      a = fillStyle.length > 7 && parseInt(fillStyle.slice(7, 9), 16) || 1;\n    } else if (fillStyle.startsWith('rgba')) {\n      ([r, g, b, a] = fillStyle.substring(5, fillStyle.length - 1).split(',').map(e => parseFloat(e)));\n    } else {\n      throw new Error(`Unexpected fillStyle color format \"${fillStyle}\" when drawing pattern glyph`);\n    }\n\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        imageData.data[(y * width + x) * 4    ] = r;\n        imageData.data[(y * width + x) * 4 + 1] = g;\n        imageData.data[(y * width + x) * 4 + 2] = b;\n        imageData.data[(y * width + x) * 4 + 3] = charDefinition[y][x] * (a * 255);\n      }\n    }\n    tmpCtx.putImageData(imageData, 0, 0);\n    pattern = throwIfFalsy(ctx.createPattern(tmpCanvas, null));\n    patternSet.set(fillStyle, pattern);\n  }\n  ctx.fillStyle = pattern;\n  ctx.fillRect(xOffset, yOffset, deviceCellWidth, deviceCellHeight);\n}\n\n/**\n * Draws the following box drawing characters by mapping a subset of SVG d attribute instructions to\n * canvas draw calls.\n *\n * Box styles:        \n *     \n *           \n *     \n *           \n *     \n *\n * Other:\n *        \n *          \n *    \n *\n * All box drawing characters:\n *                \n *                \n *                \n *                \n *                \n *                \n *                \n *                \n *\n * ---\n *\n * Box drawing alignment tests:                                          \n *                                                                       \n *                         \n *                     \n *                                   \n *                            \n *                                \n *                      \n *                           \n *\n * Source: https://www.w3.org/2001/06/utf-8-test/UTF-8-demo.html\n */\nfunction drawBoxDrawingChar(\n  ctx: CanvasRenderingContext2D,\n  charDefinition: { [fontWeight: number]: string | ((xp: number, yp: number) => string) },\n  xOffset: number,\n  yOffset: number,\n  deviceCellWidth: number,\n  deviceCellHeight: number,\n  devicePixelRatio: number\n): void {\n  ctx.strokeStyle = ctx.fillStyle;\n  for (const [fontWeight, instructions] of Object.entries(charDefinition)) {\n    ctx.beginPath();\n    ctx.lineWidth = devicePixelRatio * Number.parseInt(fontWeight);\n    let actualInstructions: string;\n    if (typeof instructions === 'function') {\n      const xp = .15;\n      const yp = .15 / deviceCellHeight * deviceCellWidth;\n      actualInstructions = instructions(xp, yp);\n    } else {\n      actualInstructions = instructions;\n    }\n    for (const instruction of actualInstructions.split(' ')) {\n      const type = instruction[0];\n      const f = svgToCanvasInstructionMap[type];\n      if (!f) {\n        console.error(`Could not find drawing instructions for \"${type}\"`);\n        continue;\n      }\n      const args: string[] = instruction.substring(1).split(',');\n      if (!args[0] || !args[1]) {\n        continue;\n      }\n      f(ctx, translateArgs(args, deviceCellWidth, deviceCellHeight, xOffset, yOffset, true, devicePixelRatio));\n    }\n    ctx.stroke();\n    ctx.closePath();\n  }\n}\n\nfunction drawPowerlineChar(\n  ctx: CanvasRenderingContext2D,\n  charDefinition: IVectorShape,\n  xOffset: number,\n  yOffset: number,\n  deviceCellWidth: number,\n  deviceCellHeight: number,\n  fontSize: number,\n  devicePixelRatio: number\n): void {\n  // Clip the cell to make sure drawing doesn't occur beyond bounds\n  const clipRegion = new Path2D();\n  clipRegion.rect(xOffset, yOffset, deviceCellWidth, deviceCellHeight);\n  ctx.clip(clipRegion);\n\n  ctx.beginPath();\n  // Scale the stroke with DPR and font size\n  const cssLineWidth = fontSize / 12;\n  ctx.lineWidth = devicePixelRatio * cssLineWidth;\n  for (const instruction of charDefinition.d.split(' ')) {\n    const type = instruction[0];\n    const f = svgToCanvasInstructionMap[type];\n    if (!f) {\n      console.error(`Could not find drawing instructions for \"${type}\"`);\n      continue;\n    }\n    const args: string[] = instruction.substring(1).split(',');\n    if (!args[0] || !args[1]) {\n      continue;\n    }\n    f(ctx, translateArgs(\n      args,\n      deviceCellWidth,\n      deviceCellHeight,\n      xOffset,\n      yOffset,\n      false,\n      devicePixelRatio,\n      (charDefinition.leftPadding ?? 0) * (cssLineWidth / 2),\n      (charDefinition.rightPadding ?? 0) * (cssLineWidth / 2)\n    ));\n  }\n  if (charDefinition.type === VectorType.STROKE) {\n    ctx.strokeStyle = ctx.fillStyle;\n    ctx.stroke();\n  } else {\n    ctx.fill();\n  }\n  ctx.closePath();\n}\n\nfunction clamp(value: number, max: number, min: number = 0): number {\n  return Math.max(Math.min(value, max), min);\n}\n\nconst svgToCanvasInstructionMap: { [index: string]: any } = {\n  'C': (ctx: CanvasRenderingContext2D, args: number[]) => ctx.bezierCurveTo(args[0], args[1], args[2], args[3], args[4], args[5]),\n  'L': (ctx: CanvasRenderingContext2D, args: number[]) => ctx.lineTo(args[0], args[1]),\n  'M': (ctx: CanvasRenderingContext2D, args: number[]) => ctx.moveTo(args[0], args[1])\n};\n\nfunction translateArgs(args: string[], cellWidth: number, cellHeight: number, xOffset: number, yOffset: number, doClamp: boolean, devicePixelRatio: number, leftPadding: number = 0, rightPadding: number = 0): number[] {\n  const result = args.map(e => parseFloat(e) || parseInt(e));\n\n  if (result.length < 2) {\n    throw new Error('Too few arguments for instruction');\n  }\n\n  for (let x = 0; x < result.length; x += 2) {\n    // Translate from 0-1 to 0-cellWidth\n    result[x] *= cellWidth - (leftPadding * devicePixelRatio) - (rightPadding * devicePixelRatio);\n    // Ensure coordinate doesn't escape cell bounds and round to the nearest 0.5 to ensure a crisp\n    // line at 100% devicePixelRatio\n    if (doClamp && result[x] !== 0) {\n      result[x] = clamp(Math.round(result[x] + 0.5) - 0.5, cellWidth, 0);\n    }\n    // Apply the cell's offset (ie. x*cellWidth)\n    result[x] += xOffset + (leftPadding * devicePixelRatio);\n  }\n\n  for (let y = 1; y < result.length; y += 2) {\n    // Translate from 0-1 to 0-cellHeight\n    result[y] *= cellHeight;\n    // Ensure coordinate doesn't escape cell bounds and round to the nearest 0.5 to ensure a crisp\n    // line at 100% devicePixelRatio\n    if (doClamp && result[y] !== 0) {\n      result[y] = clamp(Math.round(result[y] + 0.5) - 0.5, cellHeight, 0);\n    }\n    // Apply the cell's offset (ie. x*cellHeight)\n    result[y] += yOffset;\n  }\n\n  return result;\n}\n","/**\n * Copyright (c) 2022 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { toDisposable } from 'common/Lifecycle';\nimport { IDisposable } from 'common/Types';\n\nexport function observeDevicePixelDimensions(element: HTMLElement, parentWindow: Window & typeof globalThis, callback: (deviceWidth: number, deviceHeight: number) => void): IDisposable {\n  // Observe any resizes to the element and extract the actual pixel size of the element if the\n  // devicePixelContentBoxSize API is supported. This allows correcting rounding errors when\n  // converting between CSS pixels and device pixels which causes blurry rendering when device\n  // pixel ratio is not a round number.\n  let observer: ResizeObserver | undefined = new parentWindow.ResizeObserver((entries) => {\n    const entry = entries.find((entry) => entry.target === element);\n    if (!entry) {\n      return;\n    }\n\n    // Disconnect if devicePixelContentBoxSize isn't supported by the browser\n    if (!('devicePixelContentBoxSize' in entry)) {\n      observer?.disconnect();\n      observer = undefined;\n      return;\n    }\n\n    // Fire the callback, ignore events where the dimensions are 0x0 as the canvas is likely hidden\n    const width = entry.devicePixelContentBoxSize[0].inlineSize;\n    const height = entry.devicePixelContentBoxSize[0].blockSize;\n    if (width > 0 && height > 0) {\n      callback(width, height);\n    }\n  });\n  try {\n    observer.observe(element, { box: ['device-pixel-content-box'] } as any);\n  } catch {\n    observer.disconnect();\n    observer = undefined;\n  }\n  return toDisposable(() => observer?.disconnect());\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IDimensions, IRenderDimensions } from 'browser/renderer/shared/Types';\n\nexport function throwIfFalsy<T>(value: T | undefined | null): T {\n  if (!value) {\n    throw new Error('value must not be falsy');\n  }\n  return value;\n}\n\nexport function isPowerlineGlyph(codepoint: number): boolean {\n  // Only return true for Powerline symbols which require\n  // different padding and should be excluded from minimum contrast\n  // ratio standards\n  return 0xE0A4 <= codepoint && codepoint <= 0xE0D6;\n}\n\nexport function isRestrictedPowerlineGlyph(codepoint: number): boolean {\n  return 0xE0B0 <= codepoint && codepoint <= 0xE0B7;\n}\n\nfunction isBoxOrBlockGlyph(codepoint: number): boolean {\n  return 0x2500 <= codepoint && codepoint <= 0x259F;\n}\n\nexport function excludeFromContrastRatioDemands(codepoint: number): boolean {\n  return isPowerlineGlyph(codepoint) || isBoxOrBlockGlyph(codepoint);\n}\n\nexport function createRenderDimensions(): IRenderDimensions {\n  return {\n    css: {\n      canvas: createDimension(),\n      cell: createDimension()\n    },\n    device: {\n      canvas: createDimension(),\n      cell: createDimension(),\n      char: {\n        width: 0,\n        height: 0,\n        left: 0,\n        top: 0\n      }\n    }\n  };\n}\n\nfunction createDimension(): IDimensions {\n  return {\n    width: 0,\n    height: 0\n  };\n}\n","/**\n * Copyright (c) 2022 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { ISelectionRenderModel } from 'browser/renderer/shared/Types';\nimport { Terminal } from 'xterm';\n\nclass SelectionRenderModel implements ISelectionRenderModel {\n  public hasSelection!: boolean;\n  public columnSelectMode!: boolean;\n  public viewportStartRow!: number;\n  public viewportEndRow!: number;\n  public viewportCappedStartRow!: number;\n  public viewportCappedEndRow!: number;\n  public startCol!: number;\n  public endCol!: number;\n  public selectionStart: [number, number] | undefined;\n  public selectionEnd: [number, number] | undefined;\n\n  constructor() {\n    this.clear();\n  }\n\n  public clear(): void {\n    this.hasSelection = false;\n    this.columnSelectMode = false;\n    this.viewportStartRow = 0;\n    this.viewportEndRow = 0;\n    this.viewportCappedStartRow = 0;\n    this.viewportCappedEndRow = 0;\n    this.startCol = 0;\n    this.endCol = 0;\n    this.selectionStart = undefined;\n    this.selectionEnd = undefined;\n  }\n\n  public update(terminal: Terminal, start: [number, number] | undefined, end: [number, number] | undefined, columnSelectMode: boolean = false): void {\n    this.selectionStart = start;\n    this.selectionEnd = end;\n    // Selection does not exist\n    if (!start || !end || (start[0] === end[0] && start[1] === end[1])) {\n      this.clear();\n      return;\n    }\n\n    // Translate from buffer position to viewport position\n    const viewportStartRow = start[1] - terminal.buffer.active.viewportY;\n    const viewportEndRow = end[1] - terminal.buffer.active.viewportY;\n    const viewportCappedStartRow = Math.max(viewportStartRow, 0);\n    const viewportCappedEndRow = Math.min(viewportEndRow, terminal.rows - 1);\n\n    // No need to draw the selection\n    if (viewportCappedStartRow >= terminal.rows || viewportCappedEndRow < 0) {\n      this.clear();\n      return;\n    }\n\n    this.hasSelection = true;\n    this.columnSelectMode = columnSelectMode;\n    this.viewportStartRow = viewportStartRow;\n    this.viewportEndRow = viewportEndRow;\n    this.viewportCappedStartRow = viewportCappedStartRow;\n    this.viewportCappedEndRow = viewportCappedEndRow;\n    this.startCol = start[0];\n    this.endCol = end[0];\n  }\n\n  public isCellSelected(terminal: Terminal, x: number, y: number): boolean {\n    if (!this.hasSelection) {\n      return false;\n    }\n    y -= terminal.buffer.active.viewportY;\n    if (this.columnSelectMode) {\n      if (this.startCol <= this.endCol) {\n        return x >= this.startCol && y >= this.viewportCappedStartRow &&\n          x < this.endCol && y <= this.viewportCappedEndRow;\n      }\n      return x < this.startCol && y >= this.viewportCappedStartRow &&\n        x >= this.endCol && y <= this.viewportCappedEndRow;\n    }\n    return (y > this.viewportStartRow && y < this.viewportEndRow) ||\n      (this.viewportStartRow === this.viewportEndRow && y === this.viewportStartRow && x >= this.startCol && x < this.endCol) ||\n      (this.viewportStartRow < this.viewportEndRow && y === this.viewportEndRow && x < this.endCol) ||\n      (this.viewportStartRow < this.viewportEndRow && y === this.viewportStartRow && x >= this.startCol);\n  }\n}\n\nexport function createSelectionRenderModel(): ISelectionRenderModel {\n  return new SelectionRenderModel();\n}\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IColorContrastCache } from 'browser/Types';\nimport { DIM_OPACITY, TEXT_BASELINE } from 'browser/renderer/shared/Constants';\nimport { tryDrawCustomChar } from 'browser/renderer/shared/CustomGlyphs';\nimport { excludeFromContrastRatioDemands, isPowerlineGlyph, isRestrictedPowerlineGlyph, throwIfFalsy } from 'browser/renderer/shared/RendererUtils';\nimport { IBoundingBox, ICharAtlasConfig, IRasterizedGlyph, ITextureAtlas } from 'browser/renderer/shared/Types';\nimport { NULL_COLOR, color, rgba } from 'common/Color';\nimport { EventEmitter } from 'common/EventEmitter';\nimport { FourKeyMap } from 'common/MultiKeyMap';\nimport { IdleTaskQueue } from 'common/TaskQueue';\nimport { IColor } from 'common/Types';\nimport { AttributeData } from 'common/buffer/AttributeData';\nimport { Attributes, DEFAULT_COLOR, DEFAULT_EXT, UnderlineStyle } from 'common/buffer/Constants';\nimport { traceCall } from 'common/services/LogService';\nimport { IUnicodeService } from 'common/services/Services';\n\n/**\n * A shared object which is used to draw nothing for a particular cell.\n */\nconst NULL_RASTERIZED_GLYPH: IRasterizedGlyph = {\n  texturePage: 0,\n  texturePosition: { x: 0, y: 0 },\n  texturePositionClipSpace: { x: 0, y: 0 },\n  offset: { x: 0, y: 0 },\n  size: { x: 0, y: 0 },\n  sizeClipSpace: { x: 0, y: 0 }\n};\n\nconst TMP_CANVAS_GLYPH_PADDING = 2;\n\nconst enum Constants {\n  /**\n   * The amount of pixel padding to allow in each row. Setting this to zero would make the atlas\n   * page pack as tightly as possible, but more pages would end up being created as a result.\n   */\n  ROW_PIXEL_THRESHOLD = 2,\n  /**\n   * The maximum texture size regardless of what the actual hardware maximum turns out to be. This\n   * is enforced to ensure uploading the texture still finishes in a reasonable amount of time. A\n   * 4096 squared image takes up 16MB of GPU memory.\n   */\n  FORCED_MAX_TEXTURE_SIZE = 4096\n}\n\ninterface ICharAtlasActiveRow {\n  x: number;\n  y: number;\n  height: number;\n}\n\n// Work variables to avoid garbage collection\nlet $glyph = undefined;\n\nexport class TextureAtlas implements ITextureAtlas {\n  private _didWarmUp: boolean = false;\n\n  private _cacheMap: FourKeyMap<number, number, number, number, IRasterizedGlyph> = new FourKeyMap();\n  private _cacheMapCombined: FourKeyMap<string, number, number, number, IRasterizedGlyph> = new FourKeyMap();\n\n  // The texture that the atlas is drawn to\n  private _pages: AtlasPage[] = [];\n  public get pages(): { canvas: HTMLCanvasElement, version: number }[] { return this._pages; }\n\n  // The set of atlas pages that can be written to\n  private _activePages: AtlasPage[] = [];\n\n  private _tmpCanvas: HTMLCanvasElement;\n  // A temporary context that glyphs are drawn to before being transfered to the atlas.\n  private _tmpCtx: CanvasRenderingContext2D;\n\n  private _workBoundingBox: IBoundingBox = { top: 0, left: 0, bottom: 0, right: 0 };\n  private _workAttributeData: AttributeData = new AttributeData();\n\n  private _textureSize: number = 512;\n\n  public static maxAtlasPages: number | undefined;\n  public static maxTextureSize: number | undefined;\n\n  private readonly _onAddTextureAtlasCanvas = new EventEmitter<HTMLCanvasElement>();\n  public readonly onAddTextureAtlasCanvas = this._onAddTextureAtlasCanvas.event;\n  private readonly _onRemoveTextureAtlasCanvas = new EventEmitter<HTMLCanvasElement>();\n  public readonly onRemoveTextureAtlasCanvas = this._onRemoveTextureAtlasCanvas.event;\n\n  constructor(\n    private readonly _document: Document,\n    private readonly _config: ICharAtlasConfig,\n    private readonly _unicodeService: IUnicodeService\n  ) {\n    this._createNewPage();\n    this._tmpCanvas = createCanvas(\n      _document,\n      this._config.deviceCellWidth * 4 + TMP_CANVAS_GLYPH_PADDING * 2,\n      this._config.deviceCellHeight + TMP_CANVAS_GLYPH_PADDING * 2\n    );\n    this._tmpCtx = throwIfFalsy(this._tmpCanvas.getContext('2d', {\n      alpha: this._config.allowTransparency,\n      willReadFrequently: true\n    }));\n  }\n\n  public dispose(): void {\n    for (const page of this.pages) {\n      page.canvas.remove();\n    }\n    this._onAddTextureAtlasCanvas.dispose();\n  }\n\n  public warmUp(): void {\n    if (!this._didWarmUp) {\n      this._doWarmUp();\n      this._didWarmUp = true;\n    }\n  }\n\n  private _doWarmUp(): void {\n    // Pre-fill with ASCII 33-126, this is not urgent and done in idle callbacks\n    const queue = new IdleTaskQueue();\n    for (let i = 33; i < 126; i++) {\n      queue.enqueue(() => {\n        if (!this._cacheMap.get(i, DEFAULT_COLOR, DEFAULT_COLOR, DEFAULT_EXT)) {\n          const rasterizedGlyph = this._drawToCache(i, DEFAULT_COLOR, DEFAULT_COLOR, DEFAULT_EXT);\n          this._cacheMap.set(i, DEFAULT_COLOR, DEFAULT_COLOR, DEFAULT_EXT, rasterizedGlyph);\n        }\n      });\n    }\n  }\n\n  private _requestClearModel = false;\n  public beginFrame(): boolean {\n    return this._requestClearModel;\n  }\n\n  public clearTexture(): void {\n    if (this._pages[0].currentRow.x === 0 && this._pages[0].currentRow.y === 0) {\n      return;\n    }\n    for (const page of this._pages) {\n      page.clear();\n    }\n    this._cacheMap.clear();\n    this._cacheMapCombined.clear();\n    this._didWarmUp = false;\n  }\n\n  private _createNewPage(): AtlasPage {\n    // Try merge the set of the 4 most used pages of the largest size. This is is deferred to a\n    // microtask to ensure it does not interrupt textures that will be rendered in the current\n    // animation frame which would result in blank rendered areas. This is actually not that\n    // expensive relative to drawing the glyphs, so there is no need to wait for an idle callback.\n    if (TextureAtlas.maxAtlasPages && this._pages.length >= Math.max(4, TextureAtlas.maxAtlasPages)) {\n      // Find the set of the largest 4 images, below the maximum size, with the highest\n      // percentages used\n      const pagesBySize = this._pages.filter(e => {\n        return e.canvas.width * 2 <= (TextureAtlas.maxTextureSize || Constants.FORCED_MAX_TEXTURE_SIZE);\n      }).sort((a, b) => {\n        if (b.canvas.width !== a.canvas.width) {\n          return b.canvas.width - a.canvas.width;\n        }\n        return b.percentageUsed - a.percentageUsed;\n      });\n      let sameSizeI = -1;\n      let size = 0;\n      for (let i = 0; i < pagesBySize.length; i++) {\n        if (pagesBySize[i].canvas.width !== size) {\n          sameSizeI = i;\n          size = pagesBySize[i].canvas.width;\n        } else if (i - sameSizeI === 3) {\n          break;\n        }\n      }\n\n      // Gather details of the merge\n      const mergingPages = pagesBySize.slice(sameSizeI, sameSizeI + 4);\n      const sortedMergingPagesIndexes = mergingPages.map(e => e.glyphs[0].texturePage).sort((a, b) => a > b ? 1 : -1);\n      const mergedPageIndex = this.pages.length - mergingPages.length;\n\n      // Merge into the new page\n      const mergedPage = this._mergePages(mergingPages, mergedPageIndex);\n      mergedPage.version++;\n\n      // Delete the pages, shifting glyph texture pages as needed\n      for (let i = sortedMergingPagesIndexes.length - 1; i >= 0; i--) {\n        this._deletePage(sortedMergingPagesIndexes[i]);\n      }\n\n      // Add the new merged page to the end\n      this.pages.push(mergedPage);\n\n      // Request the model to be cleared to refresh all texture pages.\n      this._requestClearModel = true;\n      this._onAddTextureAtlasCanvas.fire(mergedPage.canvas);\n    }\n\n    // All new atlas pages are created small as they are highly dynamic\n    const newPage = new AtlasPage(this._document, this._textureSize);\n    this._pages.push(newPage);\n    this._activePages.push(newPage);\n    this._onAddTextureAtlasCanvas.fire(newPage.canvas);\n    return newPage;\n  }\n\n  private _mergePages(mergingPages: AtlasPage[], mergedPageIndex: number): AtlasPage {\n    const mergedSize = mergingPages[0].canvas.width * 2;\n    const mergedPage = new AtlasPage(this._document, mergedSize, mergingPages);\n    for (const [i, p] of mergingPages.entries()) {\n      const xOffset = i * p.canvas.width % mergedSize;\n      const yOffset = Math.floor(i / 2) * p.canvas.height;\n      mergedPage.ctx.drawImage(p.canvas, xOffset, yOffset);\n      for (const g of p.glyphs) {\n        g.texturePage = mergedPageIndex;\n        g.sizeClipSpace.x = g.size.x / mergedSize;\n        g.sizeClipSpace.y = g.size.y / mergedSize;\n        g.texturePosition.x += xOffset;\n        g.texturePosition.y += yOffset;\n        g.texturePositionClipSpace.x = g.texturePosition.x / mergedSize;\n        g.texturePositionClipSpace.y = g.texturePosition.y / mergedSize;\n      }\n\n      this._onRemoveTextureAtlasCanvas.fire(p.canvas);\n\n      // Remove the merging page from active pages if it was there\n      const index = this._activePages.indexOf(p);\n      if (index !== -1) {\n        this._activePages.splice(index, 1);\n      }\n    }\n    return mergedPage;\n  }\n\n  private _deletePage(pageIndex: number): void {\n    this._pages.splice(pageIndex, 1);\n    for (let j = pageIndex; j < this._pages.length; j++) {\n      const adjustingPage = this._pages[j];\n      for (const g of adjustingPage.glyphs) {\n        g.texturePage--;\n      }\n      adjustingPage.version++;\n    }\n  }\n\n  public getRasterizedGlyphCombinedChar(chars: string, bg: number, fg: number, ext: number, restrictToCellHeight: boolean): IRasterizedGlyph {\n    return this._getFromCacheMap(this._cacheMapCombined, chars, bg, fg, ext, restrictToCellHeight);\n  }\n\n  public getRasterizedGlyph(code: number, bg: number, fg: number, ext: number, restrictToCellHeight: boolean): IRasterizedGlyph {\n    return this._getFromCacheMap(this._cacheMap, code, bg, fg, ext, restrictToCellHeight);\n  }\n\n  /**\n   * Gets the glyphs texture coords, drawing the texture if it's not already\n   */\n  private _getFromCacheMap(\n    cacheMap: FourKeyMap<string | number, number, number, number, IRasterizedGlyph>,\n    key: string | number,\n    bg: number,\n    fg: number,\n    ext: number,\n    restrictToCellHeight: boolean = false\n  ): IRasterizedGlyph {\n    $glyph = cacheMap.get(key, bg, fg, ext);\n    if (!$glyph) {\n      $glyph = this._drawToCache(key, bg, fg, ext, restrictToCellHeight);\n      cacheMap.set(key, bg, fg, ext, $glyph);\n    }\n    return $glyph;\n  }\n\n  private _getColorFromAnsiIndex(idx: number): IColor {\n    if (idx >= this._config.colors.ansi.length) {\n      throw new Error('No color found for idx ' + idx);\n    }\n    return this._config.colors.ansi[idx];\n  }\n\n  private _getBackgroundColor(bgColorMode: number, bgColor: number, inverse: boolean, dim: boolean): IColor {\n    if (this._config.allowTransparency) {\n      // The background color might have some transparency, so we need to render it as fully\n      // transparent in the atlas. Otherwise we'd end up drawing the transparent background twice\n      // around the anti-aliased edges of the glyph, and it would look too dark.\n      return NULL_COLOR;\n    }\n\n    let result: IColor;\n    switch (bgColorMode) {\n      case Attributes.CM_P16:\n      case Attributes.CM_P256:\n        result = this._getColorFromAnsiIndex(bgColor);\n        break;\n      case Attributes.CM_RGB:\n        const arr = AttributeData.toColorRGB(bgColor);\n        // TODO: This object creation is slow\n        result = rgba.toColor(arr[0], arr[1], arr[2]);\n        break;\n      case Attributes.CM_DEFAULT:\n      default:\n        if (inverse) {\n          result = color.opaque(this._config.colors.foreground);\n        } else {\n          result = this._config.colors.background;\n        }\n        break;\n    }\n\n    return result;\n  }\n\n  private _getForegroundColor(bg: number, bgColorMode: number, bgColor: number, fg: number, fgColorMode: number, fgColor: number, inverse: boolean, dim: boolean, bold: boolean, excludeFromContrastRatioDemands: boolean): IColor {\n    const minimumContrastColor = this._getMinimumContrastColor(bg, bgColorMode, bgColor, fg, fgColorMode, fgColor, false, bold, dim, excludeFromContrastRatioDemands);\n    if (minimumContrastColor) {\n      return minimumContrastColor;\n    }\n\n    let result: IColor;\n    switch (fgColorMode) {\n      case Attributes.CM_P16:\n      case Attributes.CM_P256:\n        if (this._config.drawBoldTextInBrightColors && bold && fgColor < 8) {\n          fgColor += 8;\n        }\n        result = this._getColorFromAnsiIndex(fgColor);\n        break;\n      case Attributes.CM_RGB:\n        const arr = AttributeData.toColorRGB(fgColor);\n        result = rgba.toColor(arr[0], arr[1], arr[2]);\n        break;\n      case Attributes.CM_DEFAULT:\n      default:\n        if (inverse) {\n          result = this._config.colors.background;\n        } else {\n          result = this._config.colors.foreground;\n        }\n    }\n\n    // Always use an opaque color regardless of allowTransparency\n    if (this._config.allowTransparency) {\n      result = color.opaque(result);\n    }\n\n    // Apply dim to the color, opacity is fine to use for the foreground color\n    if (dim) {\n      result = color.multiplyOpacity(result, DIM_OPACITY);\n    }\n\n    return result;\n  }\n\n  private _resolveBackgroundRgba(bgColorMode: number, bgColor: number, inverse: boolean): number {\n    switch (bgColorMode) {\n      case Attributes.CM_P16:\n      case Attributes.CM_P256:\n        return this._getColorFromAnsiIndex(bgColor).rgba;\n      case Attributes.CM_RGB:\n        return bgColor << 8;\n      case Attributes.CM_DEFAULT:\n      default:\n        if (inverse) {\n          return this._config.colors.foreground.rgba;\n        }\n        return this._config.colors.background.rgba;\n    }\n  }\n\n  private _resolveForegroundRgba(fgColorMode: number, fgColor: number, inverse: boolean, bold: boolean): number {\n    switch (fgColorMode) {\n      case Attributes.CM_P16:\n      case Attributes.CM_P256:\n        if (this._config.drawBoldTextInBrightColors && bold && fgColor < 8) {\n          fgColor += 8;\n        }\n        return this._getColorFromAnsiIndex(fgColor).rgba;\n      case Attributes.CM_RGB:\n        return fgColor << 8;\n      case Attributes.CM_DEFAULT:\n      default:\n        if (inverse) {\n          return this._config.colors.background.rgba;\n        }\n        return this._config.colors.foreground.rgba;\n    }\n  }\n\n  private _getMinimumContrastColor(bg: number, bgColorMode: number, bgColor: number, fg: number, fgColorMode: number, fgColor: number, inverse: boolean, bold: boolean, dim: boolean, excludeFromContrastRatioDemands: boolean): IColor | undefined {\n    if (this._config.minimumContrastRatio === 1 || excludeFromContrastRatioDemands) {\n      return undefined;\n    }\n\n    // Try get from cache first\n    const cache = this._getContrastCache(dim);\n    const adjustedColor = cache.getColor(bg, fg);\n    if (adjustedColor !== undefined) {\n      return adjustedColor || undefined;\n    }\n\n    const bgRgba = this._resolveBackgroundRgba(bgColorMode, bgColor, inverse);\n    const fgRgba = this._resolveForegroundRgba(fgColorMode, fgColor, inverse, bold);\n    // Dim cells only require half the contrast, otherwise they wouldn't be distinguishable from\n    // non-dim cells\n    const result = rgba.ensureContrastRatio(bgRgba, fgRgba, this._config.minimumContrastRatio / (dim ? 2 : 1));\n\n    if (!result) {\n      cache.setColor(bg, fg, null);\n      return undefined;\n    }\n\n    const color = rgba.toColor(\n      (result >> 24) & 0xFF,\n      (result >> 16) & 0xFF,\n      (result >> 8) & 0xFF\n    );\n    cache.setColor(bg, fg, color);\n\n    return color;\n  }\n\n  private _getContrastCache(dim: boolean): IColorContrastCache {\n    if (dim) {\n      return this._config.colors.halfContrastCache;\n    }\n    return this._config.colors.contrastCache;\n  }\n\n  @traceCall\n  private _drawToCache(codeOrChars: number | string, bg: number, fg: number, ext: number, restrictToCellHeight: boolean = false): IRasterizedGlyph {\n    const chars = typeof codeOrChars === 'number' ? String.fromCharCode(codeOrChars) : codeOrChars;\n\n    // Uncomment for debugging\n    // console.log(`draw to cache \"${chars}\"`, bg, fg, ext);\n\n    // Allow 1 cell width per character, with a minimum of 2 (CJK), plus some padding. This is used\n    // to draw the glyph to the canvas as well as to restrict the bounding box search to ensure\n    // giant ligatures (eg. =====>) don't impact overall performance.\n    const allowedWidth = Math.min(this._config.deviceCellWidth * Math.max(chars.length, 2) + TMP_CANVAS_GLYPH_PADDING * 2, this._textureSize);\n    if (this._tmpCanvas.width < allowedWidth) {\n      this._tmpCanvas.width = allowedWidth;\n    }\n    // Include line height when drawing glyphs\n    const allowedHeight = Math.min(this._config.deviceCellHeight + TMP_CANVAS_GLYPH_PADDING * 4, this._textureSize);\n    if (this._tmpCanvas.height < allowedHeight) {\n      this._tmpCanvas.height = allowedHeight;\n    }\n    this._tmpCtx.save();\n\n    this._workAttributeData.fg = fg;\n    this._workAttributeData.bg = bg;\n    this._workAttributeData.extended.ext = ext;\n\n    const invisible = !!this._workAttributeData.isInvisible();\n    if (invisible) {\n      return NULL_RASTERIZED_GLYPH;\n    }\n\n    const bold = !!this._workAttributeData.isBold();\n    const inverse = !!this._workAttributeData.isInverse();\n    const dim = !!this._workAttributeData.isDim();\n    const italic = !!this._workAttributeData.isItalic();\n    const underline = !!this._workAttributeData.isUnderline();\n    const strikethrough = !!this._workAttributeData.isStrikethrough();\n    const overline = !!this._workAttributeData.isOverline();\n    let fgColor = this._workAttributeData.getFgColor();\n    let fgColorMode = this._workAttributeData.getFgColorMode();\n    let bgColor = this._workAttributeData.getBgColor();\n    let bgColorMode = this._workAttributeData.getBgColorMode();\n    if (inverse) {\n      const temp = fgColor;\n      fgColor = bgColor;\n      bgColor = temp;\n      const temp2 = fgColorMode;\n      fgColorMode = bgColorMode;\n      bgColorMode = temp2;\n    }\n\n    // draw the background\n    const backgroundColor = this._getBackgroundColor(bgColorMode, bgColor, inverse, dim);\n    // Use a 'copy' composite operation to clear any existing glyph out of _tmpCtxWithAlpha,\n    // regardless of transparency in backgroundColor\n    this._tmpCtx.globalCompositeOperation = 'copy';\n    this._tmpCtx.fillStyle = backgroundColor.css;\n    this._tmpCtx.fillRect(0, 0, this._tmpCanvas.width, this._tmpCanvas.height);\n    this._tmpCtx.globalCompositeOperation = 'source-over';\n\n    // draw the foreground/glyph\n    const fontWeight = bold ? this._config.fontWeightBold : this._config.fontWeight;\n    const fontStyle = italic ? 'italic' : '';\n    this._tmpCtx.font =\n      `${fontStyle} ${fontWeight} ${this._config.fontSize * this._config.devicePixelRatio}px ${this._config.fontFamily}`;\n    this._tmpCtx.textBaseline = TEXT_BASELINE;\n\n    const powerlineGlyph = chars.length === 1 && isPowerlineGlyph(chars.charCodeAt(0));\n    const restrictedPowerlineGlyph = chars.length === 1 && isRestrictedPowerlineGlyph(chars.charCodeAt(0));\n    const foregroundColor = this._getForegroundColor(bg, bgColorMode, bgColor, fg, fgColorMode, fgColor, inverse, dim, bold, excludeFromContrastRatioDemands(chars.charCodeAt(0)));\n    this._tmpCtx.fillStyle = foregroundColor.css;\n\n    // For powerline glyphs left/top padding is excluded (https://github.com/microsoft/vscode/issues/120129)\n    const padding = restrictedPowerlineGlyph ? 0 : TMP_CANVAS_GLYPH_PADDING * 2;\n\n    // Draw custom characters if applicable\n    let customGlyph = false;\n    if (this._config.customGlyphs !== false) {\n      customGlyph = tryDrawCustomChar(this._tmpCtx, chars, padding, padding, this._config.deviceCellWidth, this._config.deviceCellHeight, this._config.fontSize, this._config.devicePixelRatio);\n    }\n\n    // Whether to clear pixels based on a threshold difference between the glyph color and the\n    // background color. This should be disabled when the glyph contains multiple colors such as\n    // underline colors to prevent important colors could get cleared.\n    let enableClearThresholdCheck = !powerlineGlyph;\n\n    let chWidth: number;\n    if (typeof codeOrChars === 'number') {\n      chWidth = this._unicodeService.wcwidth(codeOrChars);\n    } else {\n      chWidth = this._unicodeService.getStringCellWidth(codeOrChars);\n    }\n\n    // Draw underline\n    if (underline) {\n      this._tmpCtx.save();\n      const lineWidth = Math.max(1, Math.floor(this._config.fontSize * this._config.devicePixelRatio / 15));\n      // When the line width is odd, draw at a 0.5 position\n      const yOffset = lineWidth % 2 === 1 ? 0.5 : 0;\n      this._tmpCtx.lineWidth = lineWidth;\n\n      // Underline color\n      if (this._workAttributeData.isUnderlineColorDefault()) {\n        this._tmpCtx.strokeStyle = this._tmpCtx.fillStyle;\n      } else if (this._workAttributeData.isUnderlineColorRGB()) {\n        enableClearThresholdCheck = false;\n        this._tmpCtx.strokeStyle = `rgb(${AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(',')})`;\n      } else {\n        enableClearThresholdCheck = false;\n        let fg = this._workAttributeData.getUnderlineColor();\n        if (this._config.drawBoldTextInBrightColors && this._workAttributeData.isBold() && fg < 8) {\n          fg += 8;\n        }\n        this._tmpCtx.strokeStyle = this._getColorFromAnsiIndex(fg).css;\n      }\n\n      // Underline style/stroke\n      this._tmpCtx.beginPath();\n      const xLeft = padding;\n      const yTop = Math.ceil(padding + this._config.deviceCharHeight) - yOffset - (restrictToCellHeight ? lineWidth * 2 : 0);\n      const yMid = yTop + lineWidth;\n      const yBot = yTop + lineWidth * 2;\n\n      for (let i = 0; i < chWidth; i++) {\n        this._tmpCtx.save();\n        const xChLeft = xLeft + i * this._config.deviceCellWidth;\n        const xChRight = xLeft + (i + 1) * this._config.deviceCellWidth;\n        const xChMid = xChLeft + this._config.deviceCellWidth / 2;\n        switch (this._workAttributeData.extended.underlineStyle) {\n          case UnderlineStyle.DOUBLE:\n            this._tmpCtx.moveTo(xChLeft, yTop);\n            this._tmpCtx.lineTo(xChRight, yTop);\n            this._tmpCtx.moveTo(xChLeft, yBot);\n            this._tmpCtx.lineTo(xChRight, yBot);\n            break;\n          case UnderlineStyle.CURLY:\n            // Choose the bezier top and bottom based on the device pixel ratio, the curly line is\n            // made taller when the line width is  as otherwise it's not very clear otherwise.\n            const yCurlyBot = lineWidth <= 1 ? yBot : Math.ceil(padding + this._config.deviceCharHeight - lineWidth / 2) - yOffset;\n            const yCurlyTop = lineWidth <= 1 ? yTop : Math.ceil(padding + this._config.deviceCharHeight + lineWidth / 2) - yOffset;\n            // Clip the left and right edges of the underline such that it can be drawn just outside\n            // the edge of the cell to ensure a continuous stroke when there are multiple underlined\n            // glyphs adjacent to one another.\n            const clipRegion = new Path2D();\n            clipRegion.rect(xChLeft, yTop, this._config.deviceCellWidth, yBot - yTop);\n            this._tmpCtx.clip(clipRegion);\n            // Start 1/2 cell before and end 1/2 cells after to ensure a smooth curve with other\n            // cells\n            this._tmpCtx.moveTo(xChLeft - this._config.deviceCellWidth / 2, yMid);\n            this._tmpCtx.bezierCurveTo(\n              xChLeft - this._config.deviceCellWidth / 2, yCurlyTop,\n              xChLeft, yCurlyTop,\n              xChLeft, yMid\n            );\n            this._tmpCtx.bezierCurveTo(\n              xChLeft, yCurlyBot,\n              xChMid, yCurlyBot,\n              xChMid, yMid\n            );\n            this._tmpCtx.bezierCurveTo(\n              xChMid, yCurlyTop,\n              xChRight, yCurlyTop,\n              xChRight, yMid\n            );\n            this._tmpCtx.bezierCurveTo(\n              xChRight, yCurlyBot,\n              xChRight + this._config.deviceCellWidth / 2, yCurlyBot,\n              xChRight + this._config.deviceCellWidth / 2, yMid\n            );\n            break;\n          case UnderlineStyle.DOTTED:\n            this._tmpCtx.setLineDash([Math.round(lineWidth), Math.round(lineWidth)]);\n            this._tmpCtx.moveTo(xChLeft, yTop);\n            this._tmpCtx.lineTo(xChRight, yTop);\n            break;\n          case UnderlineStyle.DASHED:\n            this._tmpCtx.setLineDash([this._config.devicePixelRatio * 4, this._config.devicePixelRatio * 3]);\n            this._tmpCtx.moveTo(xChLeft, yTop);\n            this._tmpCtx.lineTo(xChRight, yTop);\n            break;\n          case UnderlineStyle.SINGLE:\n          default:\n            this._tmpCtx.moveTo(xChLeft, yTop);\n            this._tmpCtx.lineTo(xChRight, yTop);\n            break;\n        }\n        this._tmpCtx.stroke();\n        this._tmpCtx.restore();\n      }\n      this._tmpCtx.restore();\n\n      // Draw stroke in the background color for non custom characters in order to give an outline\n      // between the text and the underline. Only do this when font size is >= 12 as the underline\n      // looks odd when the font size is too small\n      if (!customGlyph && this._config.fontSize >= 12) {\n        // This only works when transparency is disabled because it's not clear how to clear stroked\n        // text\n        if (!this._config.allowTransparency && chars !== ' ') {\n          // Measure the text, only draw the stroke if there is a descent beyond an alphabetic text\n          // baseline\n          this._tmpCtx.save();\n          this._tmpCtx.textBaseline = 'alphabetic';\n          const metrics = this._tmpCtx.measureText(chars);\n          this._tmpCtx.restore();\n          if ('actualBoundingBoxDescent' in metrics && metrics.actualBoundingBoxDescent > 0) {\n            // This translates to 1/2 the line width in either direction\n            this._tmpCtx.save();\n            // Clip the region to only draw in valid pixels near the underline to avoid a slight\n            // outline around the whole glyph, as well as additional pixels in the glyph at the top\n            // which would increase GPU memory demands\n            const clipRegion = new Path2D();\n            clipRegion.rect(xLeft, yTop - Math.ceil(lineWidth / 2), this._config.deviceCellWidth * chWidth, yBot - yTop + Math.ceil(lineWidth / 2));\n            this._tmpCtx.clip(clipRegion);\n            this._tmpCtx.lineWidth = this._config.devicePixelRatio * 3;\n            this._tmpCtx.strokeStyle = backgroundColor.css;\n            this._tmpCtx.strokeText(chars, padding, padding + this._config.deviceCharHeight);\n            this._tmpCtx.restore();\n          }\n        }\n      }\n    }\n\n    // Overline\n    if (overline) {\n      const lineWidth = Math.max(1, Math.floor(this._config.fontSize * this._config.devicePixelRatio / 15));\n      const yOffset = lineWidth % 2 === 1 ? 0.5 : 0;\n      this._tmpCtx.lineWidth = lineWidth;\n      this._tmpCtx.strokeStyle = this._tmpCtx.fillStyle;\n      this._tmpCtx.beginPath();\n      this._tmpCtx.moveTo(padding, padding + yOffset);\n      this._tmpCtx.lineTo(padding + this._config.deviceCharWidth * chWidth, padding + yOffset);\n      this._tmpCtx.stroke();\n    }\n\n    // Draw the character\n    if (!customGlyph) {\n      this._tmpCtx.fillText(chars, padding, padding + this._config.deviceCharHeight);\n    }\n\n    // If this character is underscore and beyond the cell bounds, shift it up until it is visible\n    // even on the bottom row, try for a maximum of 5 pixels.\n    if (chars === '_' && !this._config.allowTransparency) {\n      let isBeyondCellBounds = clearColor(this._tmpCtx.getImageData(padding, padding, this._config.deviceCellWidth, this._config.deviceCellHeight), backgroundColor, foregroundColor, enableClearThresholdCheck);\n      if (isBeyondCellBounds) {\n        for (let offset = 1; offset <= 5; offset++) {\n          this._tmpCtx.save();\n          this._tmpCtx.fillStyle = backgroundColor.css;\n          this._tmpCtx.fillRect(0, 0, this._tmpCanvas.width, this._tmpCanvas.height);\n          this._tmpCtx.restore();\n          this._tmpCtx.fillText(chars, padding, padding + this._config.deviceCharHeight - offset);\n          isBeyondCellBounds = clearColor(this._tmpCtx.getImageData(padding, padding, this._config.deviceCellWidth, this._config.deviceCellHeight), backgroundColor, foregroundColor, enableClearThresholdCheck);\n          if (!isBeyondCellBounds) {\n            break;\n          }\n        }\n      }\n    }\n\n    // Draw strokethrough\n    if (strikethrough) {\n      const lineWidth = Math.max(1, Math.floor(this._config.fontSize * this._config.devicePixelRatio / 10));\n      const yOffset = this._tmpCtx.lineWidth % 2 === 1 ? 0.5 : 0; // When the width is odd, draw at 0.5 position\n      this._tmpCtx.lineWidth = lineWidth;\n      this._tmpCtx.strokeStyle = this._tmpCtx.fillStyle;\n      this._tmpCtx.beginPath();\n      this._tmpCtx.moveTo(padding, padding + Math.floor(this._config.deviceCharHeight / 2) - yOffset);\n      this._tmpCtx.lineTo(padding + this._config.deviceCharWidth * chWidth, padding + Math.floor(this._config.deviceCharHeight / 2) - yOffset);\n      this._tmpCtx.stroke();\n    }\n\n    this._tmpCtx.restore();\n\n    // clear the background from the character to avoid issues with drawing over the previous\n    // character if it extends past it's bounds\n    const imageData = this._tmpCtx.getImageData(\n      0, 0, this._tmpCanvas.width, this._tmpCanvas.height\n    );\n\n    // Clear out the background color and determine if the glyph is empty.\n    let isEmpty: boolean;\n    if (!this._config.allowTransparency) {\n      isEmpty = clearColor(imageData, backgroundColor, foregroundColor, enableClearThresholdCheck);\n    } else {\n      isEmpty = checkCompletelyTransparent(imageData);\n    }\n\n    // Handle empty glyphs\n    if (isEmpty) {\n      return NULL_RASTERIZED_GLYPH;\n    }\n\n    const rasterizedGlyph = this._findGlyphBoundingBox(imageData, this._workBoundingBox, allowedWidth, restrictedPowerlineGlyph, customGlyph, padding);\n\n    // Find the best atlas row to use\n    let activePage: AtlasPage;\n    let activeRow: ICharAtlasActiveRow;\n    while (true) {\n      // If there are no active pages (the last smallest 4 were merged), create a new one\n      if (this._activePages.length === 0) {\n        const newPage = this._createNewPage();\n        activePage = newPage;\n        activeRow = newPage.currentRow;\n        activeRow.height = rasterizedGlyph.size.y;\n        break;\n      }\n\n      // Get the best current row from all active pages\n      activePage = this._activePages[this._activePages.length - 1];\n      activeRow = activePage.currentRow;\n      for (const p of this._activePages) {\n        if (rasterizedGlyph.size.y <= p.currentRow.height) {\n          activePage = p;\n          activeRow = p.currentRow;\n        }\n      }\n\n      // TODO: This algorithm could be simplified:\n      // - Search for the page with ROW_PIXEL_THRESHOLD in mind\n      // - Keep track of current/fixed rows in a Map\n\n      // Replace the best current row with a fixed row if there is one at least as good as the\n      // current row. Search in reverse to prioritize filling in older pages.\n      for (let i = this._activePages.length - 1; i >= 0; i--) {\n        for (const row of this._activePages[i].fixedRows) {\n          if (row.height <= activeRow.height && rasterizedGlyph.size.y <= row.height) {\n            activePage = this._activePages[i];\n            activeRow = row;\n          }\n        }\n      }\n\n      // Create a new page if too much vertical space would be wasted or there is not enough room\n      // left in the page. The previous active row will become fixed in the process as it now has a\n      // fixed height\n      if (activeRow.y + rasterizedGlyph.size.y >= activePage.canvas.height || activeRow.height > rasterizedGlyph.size.y + Constants.ROW_PIXEL_THRESHOLD) {\n        // Create the new fixed height row, creating a new page if there isn't enough room on the\n        // current page\n        let wasPageAndRowFound = false;\n        if (activePage.currentRow.y + activePage.currentRow.height + rasterizedGlyph.size.y >= activePage.canvas.height) {\n          // Find the first page with room to create the new row on\n          let candidatePage: AtlasPage | undefined;\n          for (const p of this._activePages) {\n            if (p.currentRow.y + p.currentRow.height + rasterizedGlyph.size.y < p.canvas.height) {\n              candidatePage = p;\n              break;\n            }\n          }\n          if (candidatePage) {\n            activePage = candidatePage;\n          } else {\n            // Before creating a new atlas page that would trigger a page merge, check if the\n            // current active row is sufficient when ignoring the ROW_PIXEL_THRESHOLD. This will\n            // improve texture utilization by using the available space before the page is merged\n            // and becomes static.\n            if (\n              TextureAtlas.maxAtlasPages &&\n              this._pages.length >= TextureAtlas.maxAtlasPages &&\n              activeRow.y + rasterizedGlyph.size.y <= activePage.canvas.height &&\n              activeRow.height >= rasterizedGlyph.size.y &&\n              activeRow.x + rasterizedGlyph.size.x <= activePage.canvas.width\n            ) {\n              // activePage and activeRow is already valid\n              wasPageAndRowFound = true;\n            } else {\n              // Create a new page if there is no room\n              const newPage = this._createNewPage();\n              activePage = newPage;\n              activeRow = newPage.currentRow;\n              activeRow.height = rasterizedGlyph.size.y;\n              wasPageAndRowFound = true;\n            }\n          }\n        }\n        if (!wasPageAndRowFound) {\n          // Fix the current row as the new row is being added below\n          if (activePage.currentRow.height > 0) {\n            activePage.fixedRows.push(activePage.currentRow);\n          }\n          activeRow = {\n            x: 0,\n            y: activePage.currentRow.y + activePage.currentRow.height,\n            height: rasterizedGlyph.size.y\n          };\n          activePage.fixedRows.push(activeRow);\n\n          // Create the new current row below the new fixed height row\n          activePage.currentRow = {\n            x: 0,\n            y: activeRow.y + activeRow.height,\n            height: 0\n          };\n        }\n        // TODO: Remove pages from _activePages when all rows are filled\n      }\n\n      // Exit the loop if there is enough room in the row\n      if (activeRow.x + rasterizedGlyph.size.x <= activePage.canvas.width) {\n        break;\n      }\n\n      // If there is not enough room in the current row, finish it and try again\n      if (activeRow === activePage.currentRow) {\n        activeRow.x = 0;\n        activeRow.y += activeRow.height;\n        activeRow.height = 0;\n      } else {\n        activePage.fixedRows.splice(activePage.fixedRows.indexOf(activeRow), 1);\n      }\n    }\n\n    // Record texture position\n    rasterizedGlyph.texturePage = this._pages.indexOf(activePage);\n    rasterizedGlyph.texturePosition.x = activeRow.x;\n    rasterizedGlyph.texturePosition.y = activeRow.y;\n    rasterizedGlyph.texturePositionClipSpace.x = activeRow.x / activePage.canvas.width;\n    rasterizedGlyph.texturePositionClipSpace.y = activeRow.y / activePage.canvas.height;\n\n    // Fix the clipspace position as pages may be of differing size\n    rasterizedGlyph.sizeClipSpace.x /= activePage.canvas.width;\n    rasterizedGlyph.sizeClipSpace.y /= activePage.canvas.height;\n\n    // Update atlas current row, for fixed rows the glyph height will never be larger than the row\n    // height\n    activeRow.height = Math.max(activeRow.height, rasterizedGlyph.size.y);\n    activeRow.x += rasterizedGlyph.size.x;\n\n    // putImageData doesn't do any blending, so it will overwrite any existing cache entry for us\n    activePage.ctx.putImageData(\n      imageData,\n      rasterizedGlyph.texturePosition.x - this._workBoundingBox.left,\n      rasterizedGlyph.texturePosition.y - this._workBoundingBox.top,\n      this._workBoundingBox.left,\n      this._workBoundingBox.top,\n      rasterizedGlyph.size.x,\n      rasterizedGlyph.size.y\n    );\n    activePage.addGlyph(rasterizedGlyph);\n    activePage.version++;\n\n    return rasterizedGlyph;\n  }\n\n  /**\n   * Given an ImageData object, find the bounding box of the non-transparent\n   * portion of the texture and return an IRasterizedGlyph with these\n   * dimensions.\n   * @param imageData The image data to read.\n   * @param boundingBox An IBoundingBox to put the clipped bounding box values.\n   */\n  private _findGlyphBoundingBox(imageData: ImageData, boundingBox: IBoundingBox, allowedWidth: number, restrictedGlyph: boolean, customGlyph: boolean, padding: number): IRasterizedGlyph {\n    boundingBox.top = 0;\n    const height = restrictedGlyph ? this._config.deviceCellHeight : this._tmpCanvas.height;\n    const width = restrictedGlyph ? this._config.deviceCellWidth : allowedWidth;\n    let found = false;\n    for (let y = 0; y < height; y++) {\n      for (let x = 0; x < width; x++) {\n        const alphaOffset = y * this._tmpCanvas.width * 4 + x * 4 + 3;\n        if (imageData.data[alphaOffset] !== 0) {\n          boundingBox.top = y;\n          found = true;\n          break;\n        }\n      }\n      if (found) {\n        break;\n      }\n    }\n    boundingBox.left = 0;\n    found = false;\n    for (let x = 0; x < padding + width; x++) {\n      for (let y = 0; y < height; y++) {\n        const alphaOffset = y * this._tmpCanvas.width * 4 + x * 4 + 3;\n        if (imageData.data[alphaOffset] !== 0) {\n          boundingBox.left = x;\n          found = true;\n          break;\n        }\n      }\n      if (found) {\n        break;\n      }\n    }\n    boundingBox.right = width;\n    found = false;\n    for (let x = padding + width - 1; x >= padding; x--) {\n      for (let y = 0; y < height; y++) {\n        const alphaOffset = y * this._tmpCanvas.width * 4 + x * 4 + 3;\n        if (imageData.data[alphaOffset] !== 0) {\n          boundingBox.right = x;\n          found = true;\n          break;\n        }\n      }\n      if (found) {\n        break;\n      }\n    }\n    boundingBox.bottom = height;\n    found = false;\n    for (let y = height - 1; y >= 0; y--) {\n      for (let x = 0; x < width; x++) {\n        const alphaOffset = y * this._tmpCanvas.width * 4 + x * 4 + 3;\n        if (imageData.data[alphaOffset] !== 0) {\n          boundingBox.bottom = y;\n          found = true;\n          break;\n        }\n      }\n      if (found) {\n        break;\n      }\n    }\n    return {\n      texturePage: 0,\n      texturePosition: { x: 0, y: 0 },\n      texturePositionClipSpace: { x: 0, y: 0 },\n      size: {\n        x: boundingBox.right - boundingBox.left + 1,\n        y: boundingBox.bottom - boundingBox.top + 1\n      },\n      sizeClipSpace: {\n        x: (boundingBox.right - boundingBox.left + 1),\n        y: (boundingBox.bottom - boundingBox.top + 1)\n      },\n      offset: {\n        x: -boundingBox.left + padding + ((restrictedGlyph || customGlyph) ? Math.floor((this._config.deviceCellWidth - this._config.deviceCharWidth) / 2) : 0),\n        y: -boundingBox.top + padding + ((restrictedGlyph || customGlyph) ? this._config.lineHeight === 1 ? 0 : Math.round((this._config.deviceCellHeight - this._config.deviceCharHeight) / 2) : 0)\n      }\n    };\n  }\n}\n\nclass AtlasPage {\n  public readonly canvas: HTMLCanvasElement;\n  public readonly ctx: CanvasRenderingContext2D;\n\n  private _usedPixels: number = 0;\n  public get percentageUsed(): number { return this._usedPixels / (this.canvas.width * this.canvas.height); }\n\n  private readonly _glyphs: IRasterizedGlyph[] = [];\n  public get glyphs(): ReadonlyArray<IRasterizedGlyph> { return this._glyphs; }\n  public addGlyph(glyph: IRasterizedGlyph): void {\n    this._glyphs.push(glyph);\n    this._usedPixels += glyph.size.x * glyph.size.y;\n  }\n\n  /**\n   * Used to check whether the canvas of the atlas page has changed.\n   */\n  public version = 0;\n\n  // Texture atlas current positioning data. The texture packing strategy used is to fill from\n  // left-to-right and top-to-bottom. When the glyph being written is less than half of the current\n  // row's height, the following happens:\n  //\n  // - The current row becomes the fixed height row A\n  // - A new fixed height row B the exact size of the glyph is created below the current row\n  // - A new dynamic height current row is created below B\n  //\n  // This strategy does a good job preventing space being wasted for very short glyphs such as\n  // underscores, hyphens etc. or those with underlines rendered.\n  public currentRow: ICharAtlasActiveRow = {\n    x: 0,\n    y: 0,\n    height: 0\n  };\n  public readonly fixedRows: ICharAtlasActiveRow[] = [];\n\n  constructor(\n    document: Document,\n    size: number,\n    sourcePages?: AtlasPage[]\n  ) {\n    if (sourcePages) {\n      for (const p of sourcePages) {\n        this._glyphs.push(...p.glyphs);\n        this._usedPixels += p._usedPixels;\n      }\n    }\n    this.canvas = createCanvas(document, size, size);\n    // The canvas needs alpha because we use clearColor to convert the background color to alpha.\n    // It might also contain some characters with transparent backgrounds if allowTransparency is\n    // set.\n    this.ctx = throwIfFalsy(this.canvas.getContext('2d', { alpha: true }));\n  }\n\n  public clear(): void {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.currentRow.x = 0;\n    this.currentRow.y = 0;\n    this.currentRow.height = 0;\n    this.fixedRows.length = 0;\n    this.version++;\n  }\n}\n\n/**\n * Makes a particular rgb color and colors that are nearly the same in an ImageData completely\n * transparent.\n * @returns True if the result is \"empty\", meaning all pixels are fully transparent.\n */\nfunction clearColor(imageData: ImageData, bg: IColor, fg: IColor, enableThresholdCheck: boolean): boolean {\n  // Get color channels\n  const r = bg.rgba >>> 24;\n  const g = bg.rgba >>> 16 & 0xFF;\n  const b = bg.rgba >>> 8 & 0xFF;\n  const fgR = fg.rgba >>> 24;\n  const fgG = fg.rgba >>> 16 & 0xFF;\n  const fgB = fg.rgba >>> 8 & 0xFF;\n\n  // Calculate a threshold that when below a color will be treated as transpart when the sum of\n  // channel value differs. This helps improve rendering when glyphs overlap with others. This\n  // threshold is calculated relative to the difference between the background and foreground to\n  // ensure important details of the glyph are always shown, even when the contrast ratio is low.\n  // The number 12 is largely arbitrary to ensure the pixels that escape the cell in the test case\n  // were covered (fg=#8ae234, bg=#c4a000).\n  const threshold = Math.floor((Math.abs(r - fgR) + Math.abs(g - fgG) + Math.abs(b - fgB)) / 12);\n\n  // Set alpha channel of relevent pixels to 0\n  let isEmpty = true;\n  for (let offset = 0; offset < imageData.data.length; offset += 4) {\n    // Check exact match\n    if (imageData.data[offset] === r &&\n        imageData.data[offset + 1] === g &&\n        imageData.data[offset + 2] === b) {\n      imageData.data[offset + 3] = 0;\n    } else {\n      // Check the threshold based difference\n      if (enableThresholdCheck &&\n          (Math.abs(imageData.data[offset] - r) +\n          Math.abs(imageData.data[offset + 1] - g) +\n          Math.abs(imageData.data[offset + 2] - b)) < threshold) {\n        imageData.data[offset + 3] = 0;\n      } else {\n        isEmpty = false;\n      }\n    }\n  }\n\n  return isEmpty;\n}\n\nfunction checkCompletelyTransparent(imageData: ImageData): boolean {\n  for (let offset = 0; offset < imageData.data.length; offset += 4) {\n    if (imageData.data[offset + 3] > 0) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction createCanvas(document: Document, width: number, height: number): HTMLCanvasElement {\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  return canvas;\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { isNode } from 'common/Platform';\nimport { IColor, IColorRGB } from 'common/Types';\n\nlet $r = 0;\nlet $g = 0;\nlet $b = 0;\nlet $a = 0;\n\nexport const NULL_COLOR: IColor = {\n  css: '#00000000',\n  rgba: 0\n};\n\n/**\n * Helper functions where the source type is \"channels\" (individual color channels as numbers).\n */\nexport namespace channels {\n  export function toCss(r: number, g: number, b: number, a?: number): string {\n    if (a !== undefined) {\n      return `#${toPaddedHex(r)}${toPaddedHex(g)}${toPaddedHex(b)}${toPaddedHex(a)}`;\n    }\n    return `#${toPaddedHex(r)}${toPaddedHex(g)}${toPaddedHex(b)}`;\n  }\n\n  export function toRgba(r: number, g: number, b: number, a: number = 0xFF): number {\n    // Note: The aggregated number is RGBA32 (BE), thus needs to be converted to ABGR32\n    // on LE systems, before it can be used for direct 32-bit buffer writes.\n    // >>> 0 forces an unsigned int\n    return (r << 24 | g << 16 | b << 8 | a) >>> 0;\n  }\n}\n\n/**\n * Helper functions where the source type is `IColor`.\n */\nexport namespace color {\n  export function blend(bg: IColor, fg: IColor): IColor {\n    $a = (fg.rgba & 0xFF) / 255;\n    if ($a === 1) {\n      return {\n        css: fg.css,\n        rgba: fg.rgba\n      };\n    }\n    const fgR = (fg.rgba >> 24) & 0xFF;\n    const fgG = (fg.rgba >> 16) & 0xFF;\n    const fgB = (fg.rgba >> 8) & 0xFF;\n    const bgR = (bg.rgba >> 24) & 0xFF;\n    const bgG = (bg.rgba >> 16) & 0xFF;\n    const bgB = (bg.rgba >> 8) & 0xFF;\n    $r = bgR + Math.round((fgR - bgR) * $a);\n    $g = bgG + Math.round((fgG - bgG) * $a);\n    $b = bgB + Math.round((fgB - bgB) * $a);\n    const css = channels.toCss($r, $g, $b);\n    const rgba = channels.toRgba($r, $g, $b);\n    return { css, rgba };\n  }\n\n  export function isOpaque(color: IColor): boolean {\n    return (color.rgba & 0xFF) === 0xFF;\n  }\n\n  export function ensureContrastRatio(bg: IColor, fg: IColor, ratio: number): IColor | undefined {\n    const result = rgba.ensureContrastRatio(bg.rgba, fg.rgba, ratio);\n    if (!result) {\n      return undefined;\n    }\n    return rgba.toColor(\n      (result >> 24 & 0xFF),\n      (result >> 16 & 0xFF),\n      (result >> 8  & 0xFF)\n    );\n  }\n\n  export function opaque(color: IColor): IColor {\n    const rgbaColor = (color.rgba | 0xFF) >>> 0;\n    [$r, $g, $b] = rgba.toChannels(rgbaColor);\n    return {\n      css: channels.toCss($r, $g, $b),\n      rgba: rgbaColor\n    };\n  }\n\n  export function opacity(color: IColor, opacity: number): IColor {\n    $a = Math.round(opacity * 0xFF);\n    [$r, $g, $b] = rgba.toChannels(color.rgba);\n    return {\n      css: channels.toCss($r, $g, $b, $a),\n      rgba: channels.toRgba($r, $g, $b, $a)\n    };\n  }\n\n  export function multiplyOpacity(color: IColor, factor: number): IColor {\n    $a = color.rgba & 0xFF;\n    return opacity(color, ($a * factor) / 0xFF);\n  }\n\n  export function toColorRGB(color: IColor): IColorRGB {\n    return [(color.rgba >> 24) & 0xFF, (color.rgba >> 16) & 0xFF, (color.rgba >> 8) & 0xFF];\n  }\n}\n\n/**\n * Helper functions where the source type is \"css\" (string: '#rgb', '#rgba', '#rrggbb',\n * '#rrggbbaa').\n */\nexport namespace css {\n  let $ctx: CanvasRenderingContext2D | undefined;\n  let $litmusColor: CanvasGradient | undefined;\n  if (!isNode) {\n    const canvas = document.createElement('canvas');\n    canvas.width = 1;\n    canvas.height = 1;\n    const ctx = canvas.getContext('2d', {\n      willReadFrequently: true\n    });\n    if (ctx) {\n      $ctx = ctx;\n      $ctx.globalCompositeOperation = 'copy';\n      $litmusColor = $ctx.createLinearGradient(0, 0, 1, 1);\n    }\n  }\n\n  /**\n   * Converts a css string to an IColor, this should handle all valid CSS color strings and will\n   * throw if it's invalid. The ideal format to use is `#rrggbb[aa]` as it's the fastest to parse.\n   *\n   * Only `#rgb[a]`, `#rrggbb[aa]`, `rgb()` and `rgba()` formats are supported when run in a Node\n   * environment.\n   */\n  export function toColor(css: string): IColor {\n    // Formats: #rgb[a] and #rrggbb[aa]\n    if (css.match(/#[\\da-f]{3,8}/i)) {\n      switch (css.length) {\n        case 4: { // #rgb\n          $r = parseInt(css.slice(1, 2).repeat(2), 16);\n          $g = parseInt(css.slice(2, 3).repeat(2), 16);\n          $b = parseInt(css.slice(3, 4).repeat(2), 16);\n          return rgba.toColor($r, $g, $b);\n        }\n        case 5: { // #rgba\n          $r = parseInt(css.slice(1, 2).repeat(2), 16);\n          $g = parseInt(css.slice(2, 3).repeat(2), 16);\n          $b = parseInt(css.slice(3, 4).repeat(2), 16);\n          $a = parseInt(css.slice(4, 5).repeat(2), 16);\n          return rgba.toColor($r, $g, $b, $a);\n        }\n        case 7: // #rrggbb\n          return {\n            css,\n            rgba: (parseInt(css.slice(1), 16) << 8 | 0xFF) >>> 0\n          };\n        case 9: // #rrggbbaa\n          return {\n            css,\n            rgba: parseInt(css.slice(1), 16) >>> 0\n          };\n      }\n    }\n\n    // Formats: rgb() or rgba()\n    const rgbaMatch = css.match(/rgba?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*(,\\s*(0|1|\\d?\\.(\\d+))\\s*)?\\)/);\n    if (rgbaMatch) {\n      $r = parseInt(rgbaMatch[1]);\n      $g = parseInt(rgbaMatch[2]);\n      $b = parseInt(rgbaMatch[3]);\n      $a = Math.round((rgbaMatch[5] === undefined ? 1 : parseFloat(rgbaMatch[5])) * 0xFF);\n      return rgba.toColor($r, $g, $b, $a);\n    }\n\n    // Validate the context is available for canvas-based color parsing\n    if (!$ctx || !$litmusColor) {\n      throw new Error('css.toColor: Unsupported css format');\n    }\n\n    // Validate the color using canvas fillStyle\n    // See https://html.spec.whatwg.org/multipage/canvas.html#fill-and-stroke-styles\n    $ctx.fillStyle = $litmusColor;\n    $ctx.fillStyle = css;\n    if (typeof $ctx.fillStyle !== 'string') {\n      throw new Error('css.toColor: Unsupported css format');\n    }\n\n    $ctx.fillRect(0, 0, 1, 1);\n    [$r, $g, $b, $a] = $ctx.getImageData(0, 0, 1, 1).data;\n\n    // Validate the color is non-transparent as color hue gets lost when drawn to the canvas\n    if ($a !== 0xFF) {\n      throw new Error('css.toColor: Unsupported css format');\n    }\n\n    // Extract the color from the canvas' fillStyle property which exposes the color value in rgba()\n    // format\n    // See https://html.spec.whatwg.org/multipage/canvas.html#serialisation-of-a-color\n    return {\n      rgba: channels.toRgba($r, $g, $b, $a),\n      css\n    };\n  }\n}\n\n/**\n * Helper functions where the source type is \"rgb\" (number: 0xrrggbb).\n */\nexport namespace rgb {\n  /**\n   * Gets the relative luminance of an RGB color, this is useful in determining the contrast ratio\n   * between two colors.\n   * @param rgb The color to use.\n   * @see https://www.w3.org/TR/WCAG20/#relativeluminancedef\n   */\n  export function relativeLuminance(rgb: number): number {\n    return relativeLuminance2(\n      (rgb >> 16) & 0xFF,\n      (rgb >> 8 ) & 0xFF,\n      (rgb      ) & 0xFF);\n  }\n\n  /**\n   * Gets the relative luminance of an RGB color, this is useful in determining the contrast ratio\n   * between two colors.\n   * @param r The red channel (0x00 to 0xFF).\n   * @param g The green channel (0x00 to 0xFF).\n   * @param b The blue channel (0x00 to 0xFF).\n   * @see https://www.w3.org/TR/WCAG20/#relativeluminancedef\n   */\n  export function relativeLuminance2(r: number, g: number, b: number): number {\n    const rs = r / 255;\n    const gs = g / 255;\n    const bs = b / 255;\n    const rr = rs <= 0.03928 ? rs / 12.92 : Math.pow((rs + 0.055) / 1.055, 2.4);\n    const rg = gs <= 0.03928 ? gs / 12.92 : Math.pow((gs + 0.055) / 1.055, 2.4);\n    const rb = bs <= 0.03928 ? bs / 12.92 : Math.pow((bs + 0.055) / 1.055, 2.4);\n    return rr * 0.2126 + rg * 0.7152 + rb * 0.0722;\n  }\n}\n\n/**\n * Helper functions where the source type is \"rgba\" (number: 0xrrggbbaa).\n */\nexport namespace rgba {\n  /**\n   * Given a foreground color and a background color, either increase or reduce the luminance of the\n   * foreground color until the specified contrast ratio is met. If pure white or black is hit\n   * without the contrast ratio being met, go the other direction using the background color as the\n   * foreground color and take either the first or second result depending on which has the higher\n   * contrast ratio.\n   *\n   * `undefined` will be returned if the contrast ratio is already met.\n   *\n   * @param bgRgba The background color in rgba format.\n   * @param fgRgba The foreground color in rgba format.\n   * @param ratio The contrast ratio to achieve.\n   */\n  export function ensureContrastRatio(bgRgba: number, fgRgba: number, ratio: number): number | undefined {\n    const bgL = rgb.relativeLuminance(bgRgba >> 8);\n    const fgL = rgb.relativeLuminance(fgRgba >> 8);\n    const cr = contrastRatio(bgL, fgL);\n    if (cr < ratio) {\n      if (fgL < bgL) {\n        const resultA = reduceLuminance(bgRgba, fgRgba, ratio);\n        const resultARatio = contrastRatio(bgL, rgb.relativeLuminance(resultA >> 8));\n        if (resultARatio < ratio) {\n          const resultB = increaseLuminance(bgRgba, fgRgba, ratio);\n          const resultBRatio = contrastRatio(bgL, rgb.relativeLuminance(resultB >> 8));\n          return resultARatio > resultBRatio ? resultA : resultB;\n        }\n        return resultA;\n      }\n      const resultA = increaseLuminance(bgRgba, fgRgba, ratio);\n      const resultARatio = contrastRatio(bgL, rgb.relativeLuminance(resultA >> 8));\n      if (resultARatio < ratio) {\n        const resultB = reduceLuminance(bgRgba, fgRgba, ratio);\n        const resultBRatio = contrastRatio(bgL, rgb.relativeLuminance(resultB >> 8));\n        return resultARatio > resultBRatio ? resultA : resultB;\n      }\n      return resultA;\n    }\n    return undefined;\n  }\n\n  export function reduceLuminance(bgRgba: number, fgRgba: number, ratio: number): number {\n    // This is a naive but fast approach to reducing luminance as converting to\n    // HSL and back is expensive\n    const bgR = (bgRgba >> 24) & 0xFF;\n    const bgG = (bgRgba >> 16) & 0xFF;\n    const bgB = (bgRgba >>  8) & 0xFF;\n    let fgR = (fgRgba >> 24) & 0xFF;\n    let fgG = (fgRgba >> 16) & 0xFF;\n    let fgB = (fgRgba >>  8) & 0xFF;\n    let cr = contrastRatio(rgb.relativeLuminance2(fgR, fgG, fgB), rgb.relativeLuminance2(bgR, bgG, bgB));\n    while (cr < ratio && (fgR > 0 || fgG > 0 || fgB > 0)) {\n      // Reduce by 10% until the ratio is hit\n      fgR -= Math.max(0, Math.ceil(fgR * 0.1));\n      fgG -= Math.max(0, Math.ceil(fgG * 0.1));\n      fgB -= Math.max(0, Math.ceil(fgB * 0.1));\n      cr = contrastRatio(rgb.relativeLuminance2(fgR, fgG, fgB), rgb.relativeLuminance2(bgR, bgG, bgB));\n    }\n    return (fgR << 24 | fgG << 16 | fgB << 8 | 0xFF) >>> 0;\n  }\n\n  export function increaseLuminance(bgRgba: number, fgRgba: number, ratio: number): number {\n    // This is a naive but fast approach to increasing luminance as converting to\n    // HSL and back is expensive\n    const bgR = (bgRgba >> 24) & 0xFF;\n    const bgG = (bgRgba >> 16) & 0xFF;\n    const bgB = (bgRgba >>  8) & 0xFF;\n    let fgR = (fgRgba >> 24) & 0xFF;\n    let fgG = (fgRgba >> 16) & 0xFF;\n    let fgB = (fgRgba >>  8) & 0xFF;\n    let cr = contrastRatio(rgb.relativeLuminance2(fgR, fgG, fgB), rgb.relativeLuminance2(bgR, bgG, bgB));\n    while (cr < ratio && (fgR < 0xFF || fgG < 0xFF || fgB < 0xFF)) {\n      // Increase by 10% until the ratio is hit\n      fgR = Math.min(0xFF, fgR + Math.ceil((255 - fgR) * 0.1));\n      fgG = Math.min(0xFF, fgG + Math.ceil((255 - fgG) * 0.1));\n      fgB = Math.min(0xFF, fgB + Math.ceil((255 - fgB) * 0.1));\n      cr = contrastRatio(rgb.relativeLuminance2(fgR, fgG, fgB), rgb.relativeLuminance2(bgR, bgG, bgB));\n    }\n    return (fgR << 24 | fgG << 16 | fgB << 8 | 0xFF) >>> 0;\n  }\n\n  // FIXME: Move this to channels NS?\n  export function toChannels(value: number): [number, number, number, number] {\n    return [(value >> 24) & 0xFF, (value >> 16) & 0xFF, (value >> 8) & 0xFF, value & 0xFF];\n  }\n\n  export function toColor(r: number, g: number, b: number, a?: number): IColor {\n    return {\n      css: channels.toCss(r, g, b, a),\n      rgba: channels.toRgba(r, g, b, a)\n    };\n  }\n}\n\nexport function toPaddedHex(c: number): string {\n  const s = c.toString(16);\n  return s.length < 2 ? '0' + s : s;\n}\n\n/**\n * Gets the contrast ratio between two relative luminance values.\n * @param l1 The first relative luminance.\n * @param l2 The first relative luminance.\n * @see https://www.w3.org/TR/WCAG20/#contrast-ratiodef\n */\nexport function contrastRatio(l1: number, l2: number): number {\n  if (l1 < l2) {\n    return (l2 + 0.05) / (l1 + 0.05);\n  }\n  return (l1 + 0.05) / (l2 + 0.05);\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IDisposable } from 'common/Types';\n\ninterface IListener<T, U = void> {\n  (arg1: T, arg2: U): void;\n}\n\nexport interface IEvent<T, U = void> {\n  (listener: (arg1: T, arg2: U) => any): IDisposable;\n}\n\nexport interface IEventEmitter<T, U = void> {\n  event: IEvent<T, U>;\n  fire(arg1: T, arg2: U): void;\n  dispose(): void;\n}\n\nexport class EventEmitter<T, U = void> implements IEventEmitter<T, U> {\n  private _listeners: IListener<T, U>[] = [];\n  private _event?: IEvent<T, U>;\n  private _disposed: boolean = false;\n\n  public get event(): IEvent<T, U> {\n    if (!this._event) {\n      this._event = (listener: (arg1: T, arg2: U) => any) => {\n        this._listeners.push(listener);\n        const disposable = {\n          dispose: () => {\n            if (!this._disposed) {\n              for (let i = 0; i < this._listeners.length; i++) {\n                if (this._listeners[i] === listener) {\n                  this._listeners.splice(i, 1);\n                  return;\n                }\n              }\n            }\n          }\n        };\n        return disposable;\n      };\n    }\n    return this._event;\n  }\n\n  public fire(arg1: T, arg2: U): void {\n    const queue: IListener<T, U>[] = [];\n    for (let i = 0; i < this._listeners.length; i++) {\n      queue.push(this._listeners[i]);\n    }\n    for (let i = 0; i < queue.length; i++) {\n      queue[i].call(undefined, arg1, arg2);\n    }\n  }\n\n  public dispose(): void {\n    this.clearListeners();\n    this._disposed = true;\n  }\n\n  public clearListeners(): void {\n    if (this._listeners) {\n      this._listeners.length = 0;\n    }\n  }\n}\n\nexport function forwardEvent<T>(from: IEvent<T>, to: IEventEmitter<T>): IDisposable {\n  return from(e => to.fire(e));\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IDisposable } from 'common/Types';\n\n/**\n * A base class that can be extended to provide convenience methods for managing the lifecycle of an\n * object and its components.\n */\nexport abstract class Disposable implements IDisposable {\n  protected _disposables: IDisposable[] = [];\n  protected _isDisposed: boolean = false;\n\n  /**\n   * Disposes the object, triggering the `dispose` method on all registered IDisposables.\n   */\n  public dispose(): void {\n    this._isDisposed = true;\n    for (const d of this._disposables) {\n      d.dispose();\n    }\n    this._disposables.length = 0;\n  }\n\n  /**\n   * Registers a disposable object.\n   * @param d The disposable to register.\n   * @returns The disposable.\n   */\n  public register<T extends IDisposable>(d: T): T {\n    this._disposables.push(d);\n    return d;\n  }\n\n  /**\n   * Unregisters a disposable object if it has been registered, if not do\n   * nothing.\n   * @param d The disposable to unregister.\n   */\n  public unregister<T extends IDisposable>(d: T): void {\n    const index = this._disposables.indexOf(d);\n    if (index !== -1) {\n      this._disposables.splice(index, 1);\n    }\n  }\n}\n\nexport class MutableDisposable<T extends IDisposable> implements IDisposable {\n  private _value?: T;\n  private _isDisposed = false;\n\n  /**\n   * Gets the value if it exists.\n   */\n  public get value(): T | undefined {\n    return this._isDisposed ? undefined : this._value;\n  }\n\n  /**\n   * Sets the value, disposing of the old value if it exists.\n   */\n  public set value(value: T | undefined) {\n    if (this._isDisposed || value === this._value) {\n      return;\n    }\n    this._value?.dispose();\n    this._value = value;\n  }\n\n  /**\n   * Resets the stored value and disposes of the previously stored value.\n   */\n  public clear(): void {\n    this.value = undefined;\n  }\n\n  public dispose(): void {\n    this._isDisposed = true;\n    this._value?.dispose();\n    this._value = undefined;\n  }\n}\n\n/**\n * Wrap a function in a disposable.\n */\nexport function toDisposable(f: () => void): IDisposable {\n  return { dispose: f };\n}\n\n/**\n * Dispose of all disposables in an array and set its length to 0.\n */\nexport function disposeArray(disposables: IDisposable[]): void {\n  for (const d of disposables) {\n    d.dispose();\n  }\n  disposables.length = 0;\n}\n\n/**\n * Creates a disposable that will dispose of an array of disposables when disposed.\n */\nexport function getDisposeArrayDisposable(array: IDisposable[]): IDisposable {\n  return { dispose: () => disposeArray(array) };\n}\n","/**\n * Copyright (c) 2022 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nexport class TwoKeyMap<TFirst extends string | number, TSecond extends string | number, TValue> {\n  private _data: { [bg: string | number]: { [fg: string | number]: TValue | undefined } | undefined } = {};\n\n  public set(first: TFirst, second: TSecond, value: TValue): void {\n    if (!this._data[first]) {\n      this._data[first] = {};\n    }\n    this._data[first as string | number]![second] = value;\n  }\n\n  public get(first: TFirst, second: TSecond): TValue | undefined {\n    return this._data[first as string | number] ? this._data[first as string | number]![second] : undefined;\n  }\n\n  public clear(): void {\n    this._data = {};\n  }\n}\n\nexport class FourKeyMap<TFirst extends string | number, TSecond extends string | number, TThird extends string | number, TFourth extends string | number, TValue> {\n  private _data: TwoKeyMap<TFirst, TSecond, TwoKeyMap<TThird, TFourth, TValue>> = new TwoKeyMap();\n\n  public set(first: TFirst, second: TSecond, third: TThird, fourth: TFourth, value: TValue): void {\n    if (!this._data.get(first, second)) {\n      this._data.set(first, second, new TwoKeyMap());\n    }\n    this._data.get(first, second)!.set(third, fourth, value);\n  }\n\n  public get(first: TFirst, second: TSecond, third: TThird, fourth: TFourth): TValue | undefined {\n    return this._data.get(first, second)?.get(third, fourth);\n  }\n\n  public clear(): void {\n    this._data.clear();\n  }\n}\n","/**\n * Copyright (c) 2016 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\ninterface INavigator {\n  userAgent: string;\n  language: string;\n  platform: string;\n}\n\n// We're declaring a navigator global here as we expect it in all runtimes (node and browser), but\n// we want this module to live in common.\ndeclare const navigator: INavigator;\n\nexport const isNode = (typeof navigator === 'undefined') ? true : false;\nconst userAgent = (isNode) ? 'node' : navigator.userAgent;\nconst platform = (isNode) ? 'node' : navigator.platform;\n\nexport const isFirefox = userAgent.includes('Firefox');\nexport const isLegacyEdge = userAgent.includes('Edge');\nexport const isSafari = /^((?!chrome|android).)*safari/i.test(userAgent);\nexport function getSafariVersion(): number {\n  if (!isSafari) {\n    return 0;\n  }\n  const majorVersion = userAgent.match(/Version\\/(\\d+)/);\n  if (majorVersion === null || majorVersion.length < 2) {\n    return 0;\n  }\n  return parseInt(majorVersion[1]);\n}\n\n// Find the users platform. We use this to interpret the meta key\n// and ISO third level shifts.\n// http://stackoverflow.com/q/19877924/577598\nexport const isMac = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'].includes(platform);\nexport const isIpad = platform === 'iPad';\nexport const isIphone = platform === 'iPhone';\nexport const isWindows = ['Windows', 'Win16', 'Win32', 'WinCE'].includes(platform);\nexport const isLinux = platform.indexOf('Linux') >= 0;\n// Note that when this is true, isLinux will also be true.\nexport const isChromeOS = /\\bCrOS\\b/.test(userAgent);\n","/**\n * Copyright (c) 2022 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { isNode } from 'common/Platform';\n\ninterface ITaskQueue {\n  /**\n   * Adds a task to the queue which will run in a future idle callback.\n   * To avoid perceivable stalls on the mainthread, tasks with heavy workload\n   * should split their work into smaller pieces and return `true` to get\n   * called again until the work is done (on falsy return value).\n   */\n  enqueue(task: () => boolean | void): void;\n\n  /**\n   * Flushes the queue, running all remaining tasks synchronously.\n   */\n  flush(): void;\n\n  /**\n   * Clears any remaining tasks from the queue, these will not be run.\n   */\n  clear(): void;\n}\n\ninterface ITaskDeadline {\n  timeRemaining(): number;\n}\ntype CallbackWithDeadline = (deadline: ITaskDeadline) => void;\n\nabstract class TaskQueue implements ITaskQueue {\n  private _tasks: (() => boolean | void)[] = [];\n  private _idleCallback?: number;\n  private _i = 0;\n\n  protected abstract _requestCallback(callback: CallbackWithDeadline): number;\n  protected abstract _cancelCallback(identifier: number): void;\n\n  public enqueue(task: () => boolean | void): void {\n    this._tasks.push(task);\n    this._start();\n  }\n\n  public flush(): void {\n    while (this._i < this._tasks.length) {\n      if (!this._tasks[this._i]()) {\n        this._i++;\n      }\n    }\n    this.clear();\n  }\n\n  public clear(): void {\n    if (this._idleCallback) {\n      this._cancelCallback(this._idleCallback);\n      this._idleCallback = undefined;\n    }\n    this._i = 0;\n    this._tasks.length = 0;\n  }\n\n  private _start(): void {\n    if (!this._idleCallback) {\n      this._idleCallback = this._requestCallback(this._process.bind(this));\n    }\n  }\n\n  private _process(deadline: ITaskDeadline): void {\n    this._idleCallback = undefined;\n    let taskDuration = 0;\n    let longestTask = 0;\n    let lastDeadlineRemaining = deadline.timeRemaining();\n    let deadlineRemaining = 0;\n    while (this._i < this._tasks.length) {\n      taskDuration = Date.now();\n      if (!this._tasks[this._i]()) {\n        this._i++;\n      }\n      // other than performance.now, Date.now might not be stable (changes on wall clock changes),\n      // this is not an issue here as a clock change during a short running task is very unlikely\n      // in case it still happened and leads to negative duration, simply assume 1 msec\n      taskDuration = Math.max(1, Date.now() - taskDuration);\n      longestTask = Math.max(taskDuration, longestTask);\n      // Guess the following task will take a similar time to the longest task in this batch, allow\n      // additional room to try avoid exceeding the deadline\n      deadlineRemaining = deadline.timeRemaining();\n      if (longestTask * 1.5 > deadlineRemaining) {\n        // Warn when the time exceeding the deadline is over 20ms, if this happens in practice the\n        // task should be split into sub-tasks to ensure the UI remains responsive.\n        if (lastDeadlineRemaining - taskDuration < -20) {\n          console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(lastDeadlineRemaining - taskDuration))}ms`);\n        }\n        this._start();\n        return;\n      }\n      lastDeadlineRemaining = deadlineRemaining;\n    }\n    this.clear();\n  }\n}\n\n/**\n * A queue of that runs tasks over several tasks via setTimeout, trying to maintain above 60 frames\n * per second. The tasks will run in the order they are enqueued, but they will run some time later,\n * and care should be taken to ensure they're non-urgent and will not introduce race conditions.\n */\nexport class PriorityTaskQueue extends TaskQueue {\n  protected _requestCallback(callback: CallbackWithDeadline): number {\n    return setTimeout(() => callback(this._createDeadline(16)));\n  }\n\n  protected _cancelCallback(identifier: number): void {\n    clearTimeout(identifier);\n  }\n\n  private _createDeadline(duration: number): ITaskDeadline {\n    const end = Date.now() + duration;\n    return {\n      timeRemaining: () => Math.max(0, end - Date.now())\n    };\n  }\n}\n\nclass IdleTaskQueueInternal extends TaskQueue {\n  protected _requestCallback(callback: IdleRequestCallback): number {\n    return requestIdleCallback(callback);\n  }\n\n  protected _cancelCallback(identifier: number): void {\n    cancelIdleCallback(identifier);\n  }\n}\n\n/**\n * A queue of that runs tasks over several idle callbacks, trying to respect the idle callback's\n * deadline given by the environment. The tasks will run in the order they are enqueued, but they\n * will run some time later, and care should be taken to ensure they're non-urgent and will not\n * introduce race conditions.\n *\n * This reverts to a {@link PriorityTaskQueue} if the environment does not support idle callbacks.\n */\n// eslint-disable-next-line @typescript-eslint/naming-convention\nexport const IdleTaskQueue = (!isNode && 'requestIdleCallback' in window) ? IdleTaskQueueInternal : PriorityTaskQueue;\n\n/**\n * An object that tracks a single debounced task that will run on the next idle frame. When called\n * multiple times, only the last set task will run.\n */\nexport class DebouncedIdleTask {\n  private _queue: ITaskQueue;\n\n  constructor() {\n    this._queue = new IdleTaskQueue();\n  }\n\n  public set(task: () => boolean | void): void {\n    this._queue.clear();\n    this._queue.enqueue(task);\n  }\n\n  public flush(): void {\n    this._queue.flush();\n  }\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IAttributeData, IColorRGB, IExtendedAttrs } from 'common/Types';\nimport { Attributes, FgFlags, BgFlags, UnderlineStyle, ExtFlags } from 'common/buffer/Constants';\n\nexport class AttributeData implements IAttributeData {\n  public static toColorRGB(value: number): IColorRGB {\n    return [\n      value >>> Attributes.RED_SHIFT & 255,\n      value >>> Attributes.GREEN_SHIFT & 255,\n      value & 255\n    ];\n  }\n\n  public static fromColorRGB(value: IColorRGB): number {\n    return (value[0] & 255) << Attributes.RED_SHIFT | (value[1] & 255) << Attributes.GREEN_SHIFT | value[2] & 255;\n  }\n\n  public clone(): IAttributeData {\n    const newObj = new AttributeData();\n    newObj.fg = this.fg;\n    newObj.bg = this.bg;\n    newObj.extended = this.extended.clone();\n    return newObj;\n  }\n\n  // data\n  public fg = 0;\n  public bg = 0;\n  public extended: IExtendedAttrs = new ExtendedAttrs();\n\n  // flags\n  public isInverse(): number       { return this.fg & FgFlags.INVERSE; }\n  public isBold(): number          { return this.fg & FgFlags.BOLD; }\n  public isUnderline(): number     {\n    if (this.hasExtendedAttrs() && this.extended.underlineStyle !== UnderlineStyle.NONE) {\n      return 1;\n    }\n    return this.fg & FgFlags.UNDERLINE;\n  }\n  public isBlink(): number         { return this.fg & FgFlags.BLINK; }\n  public isInvisible(): number     { return this.fg & FgFlags.INVISIBLE; }\n  public isItalic(): number        { return this.bg & BgFlags.ITALIC; }\n  public isDim(): number           { return this.bg & BgFlags.DIM; }\n  public isStrikethrough(): number { return this.fg & FgFlags.STRIKETHROUGH; }\n  public isProtected(): number     { return this.bg & BgFlags.PROTECTED; }\n  public isOverline(): number      { return this.bg & BgFlags.OVERLINE; }\n\n  // color modes\n  public getFgColorMode(): number { return this.fg & Attributes.CM_MASK; }\n  public getBgColorMode(): number { return this.bg & Attributes.CM_MASK; }\n  public isFgRGB(): boolean       { return (this.fg & Attributes.CM_MASK) === Attributes.CM_RGB; }\n  public isBgRGB(): boolean       { return (this.bg & Attributes.CM_MASK) === Attributes.CM_RGB; }\n  public isFgPalette(): boolean   { return (this.fg & Attributes.CM_MASK) === Attributes.CM_P16 || (this.fg & Attributes.CM_MASK) === Attributes.CM_P256; }\n  public isBgPalette(): boolean   { return (this.bg & Attributes.CM_MASK) === Attributes.CM_P16 || (this.bg & Attributes.CM_MASK) === Attributes.CM_P256; }\n  public isFgDefault(): boolean   { return (this.fg & Attributes.CM_MASK) === 0; }\n  public isBgDefault(): boolean   { return (this.bg & Attributes.CM_MASK) === 0; }\n  public isAttributeDefault(): boolean { return this.fg === 0 && this.bg === 0; }\n\n  // colors\n  public getFgColor(): number {\n    switch (this.fg & Attributes.CM_MASK) {\n      case Attributes.CM_P16:\n      case Attributes.CM_P256:  return this.fg & Attributes.PCOLOR_MASK;\n      case Attributes.CM_RGB:   return this.fg & Attributes.RGB_MASK;\n      default:                  return -1;  // CM_DEFAULT defaults to -1\n    }\n  }\n  public getBgColor(): number {\n    switch (this.bg & Attributes.CM_MASK) {\n      case Attributes.CM_P16:\n      case Attributes.CM_P256:  return this.bg & Attributes.PCOLOR_MASK;\n      case Attributes.CM_RGB:   return this.bg & Attributes.RGB_MASK;\n      default:                  return -1;  // CM_DEFAULT defaults to -1\n    }\n  }\n\n  // extended attrs\n  public hasExtendedAttrs(): number {\n    return this.bg & BgFlags.HAS_EXTENDED;\n  }\n  public updateExtended(): void {\n    if (this.extended.isEmpty()) {\n      this.bg &= ~BgFlags.HAS_EXTENDED;\n    } else {\n      this.bg |= BgFlags.HAS_EXTENDED;\n    }\n  }\n  public getUnderlineColor(): number {\n    if ((this.bg & BgFlags.HAS_EXTENDED) && ~this.extended.underlineColor) {\n      switch (this.extended.underlineColor & Attributes.CM_MASK) {\n        case Attributes.CM_P16:\n        case Attributes.CM_P256:  return this.extended.underlineColor & Attributes.PCOLOR_MASK;\n        case Attributes.CM_RGB:   return this.extended.underlineColor & Attributes.RGB_MASK;\n        default:                  return this.getFgColor();\n      }\n    }\n    return this.getFgColor();\n  }\n  public getUnderlineColorMode(): number {\n    return (this.bg & BgFlags.HAS_EXTENDED) && ~this.extended.underlineColor\n      ? this.extended.underlineColor & Attributes.CM_MASK\n      : this.getFgColorMode();\n  }\n  public isUnderlineColorRGB(): boolean {\n    return (this.bg & BgFlags.HAS_EXTENDED) && ~this.extended.underlineColor\n      ? (this.extended.underlineColor & Attributes.CM_MASK) === Attributes.CM_RGB\n      : this.isFgRGB();\n  }\n  public isUnderlineColorPalette(): boolean {\n    return (this.bg & BgFlags.HAS_EXTENDED) && ~this.extended.underlineColor\n      ? (this.extended.underlineColor & Attributes.CM_MASK) === Attributes.CM_P16\n          || (this.extended.underlineColor & Attributes.CM_MASK) === Attributes.CM_P256\n      : this.isFgPalette();\n  }\n  public isUnderlineColorDefault(): boolean {\n    return (this.bg & BgFlags.HAS_EXTENDED) && ~this.extended.underlineColor\n      ? (this.extended.underlineColor & Attributes.CM_MASK) === 0\n      : this.isFgDefault();\n  }\n  public getUnderlineStyle(): UnderlineStyle {\n    return this.fg & FgFlags.UNDERLINE\n      ? (this.bg & BgFlags.HAS_EXTENDED ? this.extended.underlineStyle : UnderlineStyle.SINGLE)\n      : UnderlineStyle.NONE;\n  }\n}\n\n\n/**\n * Extended attributes for a cell.\n * Holds information about different underline styles and color.\n */\nexport class ExtendedAttrs implements IExtendedAttrs {\n  private _ext: number = 0;\n  public get ext(): number {\n    if (this._urlId) {\n      return (\n        (this._ext & ~ExtFlags.UNDERLINE_STYLE) |\n        (this.underlineStyle << 26)\n      );\n    }\n    return this._ext;\n  }\n  public set ext(value: number) { this._ext = value; }\n\n  public get underlineStyle(): UnderlineStyle {\n    // Always return the URL style if it has one\n    if (this._urlId) {\n      return UnderlineStyle.DASHED;\n    }\n    return (this._ext & ExtFlags.UNDERLINE_STYLE) >> 26;\n  }\n  public set underlineStyle(value: UnderlineStyle) {\n    this._ext &= ~ExtFlags.UNDERLINE_STYLE;\n    this._ext |= (value << 26) & ExtFlags.UNDERLINE_STYLE;\n  }\n\n  public get underlineColor(): number {\n    return this._ext & (Attributes.CM_MASK | Attributes.RGB_MASK);\n  }\n  public set underlineColor(value: number) {\n    this._ext &= ~(Attributes.CM_MASK | Attributes.RGB_MASK);\n    this._ext |= value & (Attributes.CM_MASK | Attributes.RGB_MASK);\n  }\n\n  private _urlId: number = 0;\n  public get urlId(): number {\n    return this._urlId;\n  }\n  public set urlId(value: number) {\n    this._urlId = value;\n  }\n\n  constructor(\n    ext: number = 0,\n    urlId: number = 0\n  ) {\n    this._ext = ext;\n    this._urlId = urlId;\n  }\n\n  public clone(): IExtendedAttrs {\n    return new ExtendedAttrs(this._ext, this._urlId);\n  }\n\n  /**\n   * Convenient method to indicate whether the object holds no additional information,\n   * that needs to be persistant in the buffer.\n   */\n  public isEmpty(): boolean {\n    return this.underlineStyle === UnderlineStyle.NONE && this._urlId === 0;\n  }\n}\n","/**\n * Copyright (c) 2018 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { CharData, ICellData, IExtendedAttrs } from 'common/Types';\nimport { stringFromCodePoint } from 'common/input/TextDecoder';\nimport { CHAR_DATA_CHAR_INDEX, CHAR_DATA_WIDTH_INDEX, CHAR_DATA_ATTR_INDEX, Content } from 'common/buffer/Constants';\nimport { AttributeData, ExtendedAttrs } from 'common/buffer/AttributeData';\n\n/**\n * CellData - represents a single Cell in the terminal buffer.\n */\nexport class CellData extends AttributeData implements ICellData {\n  /** Helper to create CellData from CharData. */\n  public static fromCharData(value: CharData): CellData {\n    const obj = new CellData();\n    obj.setFromCharData(value);\n    return obj;\n  }\n  /** Primitives from terminal buffer. */\n  public content = 0;\n  public fg = 0;\n  public bg = 0;\n  public extended: IExtendedAttrs = new ExtendedAttrs();\n  public combinedData = '';\n  /** Whether cell contains a combined string. */\n  public isCombined(): number {\n    return this.content & Content.IS_COMBINED_MASK;\n  }\n  /** Width of the cell. */\n  public getWidth(): number {\n    return this.content >> Content.WIDTH_SHIFT;\n  }\n  /** JS string of the content. */\n  public getChars(): string {\n    if (this.content & Content.IS_COMBINED_MASK) {\n      return this.combinedData;\n    }\n    if (this.content & Content.CODEPOINT_MASK) {\n      return stringFromCodePoint(this.content & Content.CODEPOINT_MASK);\n    }\n    return '';\n  }\n  /**\n   * Codepoint of cell\n   * Note this returns the UTF32 codepoint of single chars,\n   * if content is a combined string it returns the codepoint\n   * of the last char in string to be in line with code in CharData.\n   */\n  public getCode(): number {\n    return (this.isCombined())\n      ? this.combinedData.charCodeAt(this.combinedData.length - 1)\n      : this.content & Content.CODEPOINT_MASK;\n  }\n  /** Set data from CharData */\n  public setFromCharData(value: CharData): void {\n    this.fg = value[CHAR_DATA_ATTR_INDEX];\n    this.bg = 0;\n    let combined = false;\n    // surrogates and combined strings need special treatment\n    if (value[CHAR_DATA_CHAR_INDEX].length > 2) {\n      combined = true;\n    }\n    else if (value[CHAR_DATA_CHAR_INDEX].length === 2) {\n      const code = value[CHAR_DATA_CHAR_INDEX].charCodeAt(0);\n      // if the 2-char string is a surrogate create single codepoint\n      // everything else is combined\n      if (0xD800 <= code && code <= 0xDBFF) {\n        const second = value[CHAR_DATA_CHAR_INDEX].charCodeAt(1);\n        if (0xDC00 <= second && second <= 0xDFFF) {\n          this.content = ((code - 0xD800) * 0x400 + second - 0xDC00 + 0x10000) | (value[CHAR_DATA_WIDTH_INDEX] << Content.WIDTH_SHIFT);\n        }\n        else {\n          combined = true;\n        }\n      }\n      else {\n        combined = true;\n      }\n    }\n    else {\n      this.content = value[CHAR_DATA_CHAR_INDEX].charCodeAt(0) | (value[CHAR_DATA_WIDTH_INDEX] << Content.WIDTH_SHIFT);\n    }\n    if (combined) {\n      this.combinedData = value[CHAR_DATA_CHAR_INDEX];\n      this.content = Content.IS_COMBINED_MASK | (value[CHAR_DATA_WIDTH_INDEX] << Content.WIDTH_SHIFT);\n    }\n  }\n  /** Get data as CharData. */\n  public getAsCharData(): CharData {\n    return [this.fg, this.getChars(), this.getWidth(), this.getCode()];\n  }\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nexport const DEFAULT_COLOR = 0;\nexport const DEFAULT_ATTR = (0 << 18) | (DEFAULT_COLOR << 9) | (256 << 0);\nexport const DEFAULT_EXT = 0;\n\nexport const CHAR_DATA_ATTR_INDEX = 0;\nexport const CHAR_DATA_CHAR_INDEX = 1;\nexport const CHAR_DATA_WIDTH_INDEX = 2;\nexport const CHAR_DATA_CODE_INDEX = 3;\n\n/**\n * Null cell - a real empty cell (containing nothing).\n * Note that code should always be 0 for a null cell as\n * several test condition of the buffer line rely on this.\n */\nexport const NULL_CELL_CHAR = '';\nexport const NULL_CELL_WIDTH = 1;\nexport const NULL_CELL_CODE = 0;\n\n/**\n * Whitespace cell.\n * This is meant as a replacement for empty cells when needed\n * during rendering lines to preserve correct aligment.\n */\nexport const WHITESPACE_CELL_CHAR = ' ';\nexport const WHITESPACE_CELL_WIDTH = 1;\nexport const WHITESPACE_CELL_CODE = 32;\n\n/**\n * Bitmasks for accessing data in `content`.\n */\nexport const enum Content {\n  /**\n   * bit 1..21    codepoint, max allowed in UTF32 is 0x10FFFF (21 bits taken)\n   *              read:   `codepoint = content & Content.codepointMask;`\n   *              write:  `content |= codepoint & Content.codepointMask;`\n   *                      shortcut if precondition `codepoint <= 0x10FFFF` is met:\n   *                      `content |= codepoint;`\n   */\n  CODEPOINT_MASK = 0x1FFFFF,\n\n  /**\n   * bit 22       flag indication whether a cell contains combined content\n   *              read:   `isCombined = content & Content.isCombined;`\n   *              set:    `content |= Content.isCombined;`\n   *              clear:  `content &= ~Content.isCombined;`\n   */\n  IS_COMBINED_MASK = 0x200000,  // 1 << 21\n\n  /**\n   * bit 1..22    mask to check whether a cell contains any string data\n   *              we need to check for codepoint and isCombined bits to see\n   *              whether a cell contains anything\n   *              read:   `isEmpty = !(content & Content.hasContent)`\n   */\n  HAS_CONTENT_MASK = 0x3FFFFF,\n\n  /**\n   * bit 23..24   wcwidth value of cell, takes 2 bits (ranges from 0..2)\n   *              read:   `width = (content & Content.widthMask) >> Content.widthShift;`\n   *                      `hasWidth = content & Content.widthMask;`\n   *                      as long as wcwidth is highest value in `content`:\n   *                      `width = content >> Content.widthShift;`\n   *              write:  `content |= (width << Content.widthShift) & Content.widthMask;`\n   *                      shortcut if precondition `0 <= width <= 3` is met:\n   *                      `content |= width << Content.widthShift;`\n   */\n  WIDTH_MASK = 0xC00000,   // 3 << 22\n  WIDTH_SHIFT = 22\n}\n\nexport const enum Attributes {\n  /**\n   * bit 1..8     blue in RGB, color in P256 and P16\n   */\n  BLUE_MASK = 0xFF,\n  BLUE_SHIFT = 0,\n  PCOLOR_MASK = 0xFF,\n  PCOLOR_SHIFT = 0,\n\n  /**\n   * bit 9..16    green in RGB\n   */\n  GREEN_MASK = 0xFF00,\n  GREEN_SHIFT = 8,\n\n  /**\n   * bit 17..24   red in RGB\n   */\n  RED_MASK = 0xFF0000,\n  RED_SHIFT = 16,\n\n  /**\n   * bit 25..26   color mode: DEFAULT (0) | P16 (1) | P256 (2) | RGB (3)\n   */\n  CM_MASK = 0x3000000,\n  CM_DEFAULT = 0,\n  CM_P16 = 0x1000000,\n  CM_P256 = 0x2000000,\n  CM_RGB = 0x3000000,\n\n  /**\n   * bit 1..24  RGB room\n   */\n  RGB_MASK = 0xFFFFFF\n}\n\nexport const enum FgFlags {\n  /**\n   * bit 27..32\n   */\n  INVERSE = 0x4000000,\n  BOLD = 0x8000000,\n  UNDERLINE = 0x10000000,\n  BLINK = 0x20000000,\n  INVISIBLE = 0x40000000,\n  STRIKETHROUGH = 0x80000000,\n}\n\nexport const enum BgFlags {\n  /**\n   * bit 27..32 (upper 2 unused)\n   */\n  ITALIC = 0x4000000,\n  DIM = 0x8000000,\n  HAS_EXTENDED = 0x10000000,\n  PROTECTED = 0x20000000,\n  OVERLINE = 0x40000000\n}\n\nexport const enum ExtFlags {\n  /**\n   * bit 27..32 (upper 3 unused)\n   */\n  UNDERLINE_STYLE = 0x1C000000\n}\n\nexport const enum UnderlineStyle {\n  NONE = 0,\n  SINGLE = 1,\n  DOUBLE = 2,\n  CURLY = 3,\n  DOTTED = 4,\n  DASHED = 5\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\n/**\n * Polyfill - Convert UTF32 codepoint into JS string.\n * Note: The built-in String.fromCodePoint happens to be much slower\n *       due to additional sanity checks. We can avoid them since\n *       we always operate on legal UTF32 (granted by the input decoders)\n *       and use this faster version instead.\n */\nexport function stringFromCodePoint(codePoint: number): string {\n  if (codePoint > 0xFFFF) {\n    codePoint -= 0x10000;\n    return String.fromCharCode((codePoint >> 10) + 0xD800) + String.fromCharCode((codePoint % 0x400) + 0xDC00);\n  }\n  return String.fromCharCode(codePoint);\n}\n\n/**\n * Convert UTF32 char codes into JS string.\n * Basically the same as `stringFromCodePoint` but for multiple codepoints\n * in a loop (which is a lot faster).\n */\nexport function utf32ToString(data: Uint32Array, start: number = 0, end: number = data.length): string {\n  let result = '';\n  for (let i = start; i < end; ++i) {\n    let codepoint = data[i];\n    if (codepoint > 0xFFFF) {\n      // JS strings are encoded as UTF16, thus a non BMP codepoint gets converted into a surrogate\n      // pair conversion rules:\n      //  - subtract 0x10000 from code point, leaving a 20 bit number\n      //  - add high 10 bits to 0xD800  --> first surrogate\n      //  - add low 10 bits to 0xDC00   --> second surrogate\n      codepoint -= 0x10000;\n      result += String.fromCharCode((codepoint >> 10) + 0xD800) + String.fromCharCode((codepoint % 0x400) + 0xDC00);\n    } else {\n      result += String.fromCharCode(codepoint);\n    }\n  }\n  return result;\n}\n\n/**\n * StringToUtf32 - decodes UTF16 sequences into UTF32 codepoints.\n * To keep the decoder in line with JS strings it handles single surrogates as UCS2.\n */\nexport class StringToUtf32 {\n  private _interim: number = 0;\n\n  /**\n   * Clears interim and resets decoder to clean state.\n   */\n  public clear(): void {\n    this._interim = 0;\n  }\n\n  /**\n   * Decode JS string to UTF32 codepoints.\n   * The methods assumes stream input and will store partly transmitted\n   * surrogate pairs and decode them with the next data chunk.\n   * Note: The method does no bound checks for target, therefore make sure\n   * the provided input data does not exceed the size of `target`.\n   * Returns the number of written codepoints in `target`.\n   */\n  public decode(input: string, target: Uint32Array): number {\n    const length = input.length;\n\n    if (!length) {\n      return 0;\n    }\n\n    let size = 0;\n    let startPos = 0;\n\n    // handle leftover surrogate high\n    if (this._interim) {\n      const second = input.charCodeAt(startPos++);\n      if (0xDC00 <= second && second <= 0xDFFF) {\n        target[size++] = (this._interim - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n      } else {\n        // illegal codepoint (USC2 handling)\n        target[size++] = this._interim;\n        target[size++] = second;\n      }\n      this._interim = 0;\n    }\n\n    for (let i = startPos; i < length; ++i) {\n      const code = input.charCodeAt(i);\n      // surrogate pair first\n      if (0xD800 <= code && code <= 0xDBFF) {\n        if (++i >= length) {\n          this._interim = code;\n          return size;\n        }\n        const second = input.charCodeAt(i);\n        if (0xDC00 <= second && second <= 0xDFFF) {\n          target[size++] = (code - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n        } else {\n          // illegal codepoint (USC2 handling)\n          target[size++] = code;\n          target[size++] = second;\n        }\n        continue;\n      }\n      if (code === 0xFEFF) {\n        // BOM\n        continue;\n      }\n      target[size++] = code;\n    }\n    return size;\n  }\n}\n\n/**\n * Utf8Decoder - decodes UTF8 byte sequences into UTF32 codepoints.\n */\nexport class Utf8ToUtf32 {\n  public interim: Uint8Array = new Uint8Array(3);\n\n  /**\n   * Clears interim bytes and resets decoder to clean state.\n   */\n  public clear(): void {\n    this.interim.fill(0);\n  }\n\n  /**\n   * Decodes UTF8 byte sequences in `input` to UTF32 codepoints in `target`.\n   * The methods assumes stream input and will store partly transmitted bytes\n   * and decode them with the next data chunk.\n   * Note: The method does no bound checks for target, therefore make sure\n   * the provided data chunk does not exceed the size of `target`.\n   * Returns the number of written codepoints in `target`.\n   */\n  public decode(input: Uint8Array, target: Uint32Array): number {\n    const length = input.length;\n\n    if (!length) {\n      return 0;\n    }\n\n    let size = 0;\n    let byte1: number;\n    let byte2: number;\n    let byte3: number;\n    let byte4: number;\n    let codepoint = 0;\n    let startPos = 0;\n\n    // handle leftover bytes\n    if (this.interim[0]) {\n      let discardInterim = false;\n      let cp = this.interim[0];\n      cp &= ((((cp & 0xE0) === 0xC0)) ? 0x1F : (((cp & 0xF0) === 0xE0)) ? 0x0F : 0x07);\n      let pos = 0;\n      let tmp: number;\n      while ((tmp = this.interim[++pos] & 0x3F) && pos < 4) {\n        cp <<= 6;\n        cp |= tmp;\n      }\n      // missing bytes - read ahead from input\n      const type = (((this.interim[0] & 0xE0) === 0xC0)) ? 2 : (((this.interim[0] & 0xF0) === 0xE0)) ? 3 : 4;\n      const missing = type - pos;\n      while (startPos < missing) {\n        if (startPos >= length) {\n          return 0;\n        }\n        tmp = input[startPos++];\n        if ((tmp & 0xC0) !== 0x80) {\n          // wrong continuation, discard interim bytes completely\n          startPos--;\n          discardInterim = true;\n          break;\n        } else {\n          // need to save so we can continue short inputs in next call\n          this.interim[pos++] = tmp;\n          cp <<= 6;\n          cp |= tmp & 0x3F;\n        }\n      }\n      if (!discardInterim) {\n        // final test is type dependent\n        if (type === 2) {\n          if (cp < 0x80) {\n            // wrong starter byte\n            startPos--;\n          } else {\n            target[size++] = cp;\n          }\n        } else if (type === 3) {\n          if (cp < 0x0800 || (cp >= 0xD800 && cp <= 0xDFFF) || cp === 0xFEFF) {\n            // illegal codepoint or BOM\n          } else {\n            target[size++] = cp;\n          }\n        } else {\n          if (cp < 0x010000 || cp > 0x10FFFF) {\n            // illegal codepoint\n          } else {\n            target[size++] = cp;\n          }\n        }\n      }\n      this.interim.fill(0);\n    }\n\n    // loop through input\n    const fourStop = length - 4;\n    let i = startPos;\n    while (i < length) {\n      /**\n       * ASCII shortcut with loop unrolled to 4 consecutive ASCII chars.\n       * This is a compromise between speed gain for ASCII\n       * and penalty for non ASCII:\n       * For best ASCII performance the char should be stored directly into target,\n       * but even a single attempt to write to target and compare afterwards\n       * penalizes non ASCII really bad (-50%), thus we load the char into byteX first,\n       * which reduces ASCII performance by ~15%.\n       * This trial for ASCII reduces non ASCII performance by ~10% which seems acceptible\n       * compared to the gains.\n       * Note that this optimization only takes place for 4 consecutive ASCII chars,\n       * for any shorter it bails out. Worst case - all 4 bytes being read but\n       * thrown away due to the last being a non ASCII char (-10% performance).\n       */\n      while (i < fourStop\n        && !((byte1 = input[i]) & 0x80)\n        && !((byte2 = input[i + 1]) & 0x80)\n        && !((byte3 = input[i + 2]) & 0x80)\n        && !((byte4 = input[i + 3]) & 0x80))\n      {\n        target[size++] = byte1;\n        target[size++] = byte2;\n        target[size++] = byte3;\n        target[size++] = byte4;\n        i += 4;\n      }\n\n      // reread byte1\n      byte1 = input[i++];\n\n      // 1 byte\n      if (byte1 < 0x80) {\n        target[size++] = byte1;\n\n        // 2 bytes\n      } else if ((byte1 & 0xE0) === 0xC0) {\n        if (i >= length) {\n          this.interim[0] = byte1;\n          return size;\n        }\n        byte2 = input[i++];\n        if ((byte2 & 0xC0) !== 0x80) {\n          // wrong continuation\n          i--;\n          continue;\n        }\n        codepoint = (byte1 & 0x1F) << 6 | (byte2 & 0x3F);\n        if (codepoint < 0x80) {\n          // wrong starter byte\n          i--;\n          continue;\n        }\n        target[size++] = codepoint;\n\n        // 3 bytes\n      } else if ((byte1 & 0xF0) === 0xE0) {\n        if (i >= length) {\n          this.interim[0] = byte1;\n          return size;\n        }\n        byte2 = input[i++];\n        if ((byte2 & 0xC0) !== 0x80) {\n          // wrong continuation\n          i--;\n          continue;\n        }\n        if (i >= length) {\n          this.interim[0] = byte1;\n          this.interim[1] = byte2;\n          return size;\n        }\n        byte3 = input[i++];\n        if ((byte3 & 0xC0) !== 0x80) {\n          // wrong continuation\n          i--;\n          continue;\n        }\n        codepoint = (byte1 & 0x0F) << 12 | (byte2 & 0x3F) << 6 | (byte3 & 0x3F);\n        if (codepoint < 0x0800 || (codepoint >= 0xD800 && codepoint <= 0xDFFF) || codepoint === 0xFEFF) {\n          // illegal codepoint or BOM, no i-- here\n          continue;\n        }\n        target[size++] = codepoint;\n\n        // 4 bytes\n      } else if ((byte1 & 0xF8) === 0xF0) {\n        if (i >= length) {\n          this.interim[0] = byte1;\n          return size;\n        }\n        byte2 = input[i++];\n        if ((byte2 & 0xC0) !== 0x80) {\n          // wrong continuation\n          i--;\n          continue;\n        }\n        if (i >= length) {\n          this.interim[0] = byte1;\n          this.interim[1] = byte2;\n          return size;\n        }\n        byte3 = input[i++];\n        if ((byte3 & 0xC0) !== 0x80) {\n          // wrong continuation\n          i--;\n          continue;\n        }\n        if (i >= length) {\n          this.interim[0] = byte1;\n          this.interim[1] = byte2;\n          this.interim[2] = byte3;\n          return size;\n        }\n        byte4 = input[i++];\n        if ((byte4 & 0xC0) !== 0x80) {\n          // wrong continuation\n          i--;\n          continue;\n        }\n        codepoint = (byte1 & 0x07) << 18 | (byte2 & 0x3F) << 12 | (byte3 & 0x3F) << 6 | (byte4 & 0x3F);\n        if (codepoint < 0x010000 || codepoint > 0x10FFFF) {\n          // illegal codepoint, no i-- here\n          continue;\n        }\n        target[size++] = codepoint;\n      } else {\n        // illegal byte, just skip\n      }\n    }\n    return size;\n  }\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { Disposable } from 'common/Lifecycle';\nimport { ILogService, IOptionsService, LogLevelEnum } from 'common/services/Services';\n\ntype LogType = (message?: any, ...optionalParams: any[]) => void;\n\ninterface IConsole {\n  log: LogType;\n  error: LogType;\n  info: LogType;\n  trace: LogType;\n  warn: LogType;\n}\n\n// console is available on both node.js and browser contexts but the common\n// module doesn't depend on them so we need to explicitly declare it.\ndeclare const console: IConsole;\n\nconst optionsKeyToLogLevel: { [key: string]: LogLevelEnum } = {\n  trace: LogLevelEnum.TRACE,\n  debug: LogLevelEnum.DEBUG,\n  info: LogLevelEnum.INFO,\n  warn: LogLevelEnum.WARN,\n  error: LogLevelEnum.ERROR,\n  off: LogLevelEnum.OFF\n};\n\nconst LOG_PREFIX = 'xterm.js: ';\n\nexport class LogService extends Disposable implements ILogService {\n  public serviceBrand: any;\n\n  private _logLevel: LogLevelEnum = LogLevelEnum.OFF;\n  public get logLevel(): LogLevelEnum { return this._logLevel; }\n\n  constructor(\n    @IOptionsService private readonly _optionsService: IOptionsService\n  ) {\n    super();\n    this._updateLogLevel();\n    this.register(this._optionsService.onSpecificOptionChange('logLevel', () => this._updateLogLevel()));\n\n    // For trace logging, assume the latest created log service is valid\n    traceLogger = this;\n  }\n\n  private _updateLogLevel(): void {\n    this._logLevel = optionsKeyToLogLevel[this._optionsService.rawOptions.logLevel];\n  }\n\n  private _evalLazyOptionalParams(optionalParams: any[]): void {\n    for (let i = 0; i < optionalParams.length; i++) {\n      if (typeof optionalParams[i] === 'function') {\n        optionalParams[i] = optionalParams[i]();\n      }\n    }\n  }\n\n  private _log(type: LogType, message: string, optionalParams: any[]): void {\n    this._evalLazyOptionalParams(optionalParams);\n    type.call(console, (this._optionsService.options.logger ? '' : LOG_PREFIX) + message, ...optionalParams);\n  }\n\n  public trace(message: string, ...optionalParams: any[]): void {\n    if (this._logLevel <= LogLevelEnum.TRACE) {\n      this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger) ?? console.log, message, optionalParams);\n    }\n  }\n\n  public debug(message: string, ...optionalParams: any[]): void {\n    if (this._logLevel <= LogLevelEnum.DEBUG) {\n      this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger) ?? console.log, message, optionalParams);\n    }\n  }\n\n  public info(message: string, ...optionalParams: any[]): void {\n    if (this._logLevel <= LogLevelEnum.INFO) {\n      this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger) ?? console.info, message, optionalParams);\n    }\n  }\n\n  public warn(message: string, ...optionalParams: any[]): void {\n    if (this._logLevel <= LogLevelEnum.WARN) {\n      this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger) ?? console.warn, message, optionalParams);\n    }\n  }\n\n  public error(message: string, ...optionalParams: any[]): void {\n    if (this._logLevel <= LogLevelEnum.ERROR) {\n      this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger) ?? console.error, message, optionalParams);\n    }\n  }\n}\n\nlet traceLogger: ILogService;\nexport function setTraceLogger(logger: ILogService): void {\n  traceLogger = logger;\n}\n\n/**\n * A decorator that can be used to automatically log trace calls to the decorated function.\n */\nexport function traceCall(_target: any, key: string, descriptor: any): any {\n  if (typeof descriptor.value !== 'function') {\n    throw new Error('not supported');\n  }\n  const fnKey = 'value';\n  const fn = descriptor.value;\n  descriptor[fnKey] = function (...args: any[]) {\n    // Early exit\n    if (traceLogger.logLevel !== LogLevelEnum.TRACE) {\n      return fn.apply(this, args);\n    }\n\n    traceLogger.trace(`GlyphRenderer#${fn.name}(${args.map(e => JSON.stringify(e)).join(', ')})`);\n    const result = fn.apply(this, args);\n    traceLogger.trace(`GlyphRenderer#${fn.name} return`, result);\n    return result;\n  };\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n *\n * This was heavily inspired from microsoft/vscode's dependency injection system (MIT).\n */\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IServiceIdentifier } from 'common/services/Services';\n\nconst DI_TARGET = 'di$target';\nconst DI_DEPENDENCIES = 'di$dependencies';\n\nexport const serviceRegistry: Map<string, IServiceIdentifier<any>> = new Map();\n\nexport function getServiceDependencies(ctor: any): { id: IServiceIdentifier<any>, index: number, optional: boolean }[] {\n  return ctor[DI_DEPENDENCIES] || [];\n}\n\nexport function createDecorator<T>(id: string): IServiceIdentifier<T> {\n  if (serviceRegistry.has(id)) {\n    return serviceRegistry.get(id)!;\n  }\n\n  const decorator: any = function (target: Function, key: string, index: number): any {\n    if (arguments.length !== 3) {\n      throw new Error('@IServiceName-decorator can only be used to decorate a parameter');\n    }\n\n    storeServiceDependency(decorator, target, index);\n  };\n\n  decorator.toString = () => id;\n\n  serviceRegistry.set(id, decorator);\n  return decorator;\n}\n\nfunction storeServiceDependency(id: Function, target: Function, index: number): void {\n  if ((target as any)[DI_TARGET] === target) {\n    (target as any)[DI_DEPENDENCIES].push({ id, index });\n  } else {\n    (target as any)[DI_DEPENDENCIES] = [{ id, index }];\n    (target as any)[DI_TARGET] = target;\n  }\n}\n","/**\n * Copyright (c) 2019 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { IEvent, IEventEmitter } from 'common/EventEmitter';\nimport { IBuffer, IBufferSet } from 'common/buffer/Types';\nimport { IDecPrivateModes, ICoreMouseEvent, CoreMouseEncoding, ICoreMouseProtocol, CoreMouseEventType, ICharset, IWindowOptions, IModes, IAttributeData, ScrollSource, IDisposable, IColor, CursorStyle, CursorInactiveStyle, IOscLinkData } from 'common/Types';\nimport { createDecorator } from 'common/services/ServiceRegistry';\nimport { IDecorationOptions, IDecoration, ILinkHandler, IWindowsPty, ILogger } from 'xterm';\n\nexport const IBufferService = createDecorator<IBufferService>('BufferService');\nexport interface IBufferService {\n  serviceBrand: undefined;\n\n  readonly cols: number;\n  readonly rows: number;\n  readonly buffer: IBuffer;\n  readonly buffers: IBufferSet;\n  isUserScrolling: boolean;\n  onResize: IEvent<{ cols: number, rows: number }>;\n  onScroll: IEvent<number>;\n  scroll(eraseAttr: IAttributeData, isWrapped?: boolean): void;\n  scrollLines(disp: number, suppressScrollEvent?: boolean, source?: ScrollSource): void;\n  resize(cols: number, rows: number): void;\n  reset(): void;\n}\n\nexport const ICoreMouseService = createDecorator<ICoreMouseService>('CoreMouseService');\nexport interface ICoreMouseService {\n  activeProtocol: string;\n  activeEncoding: string;\n  areMouseEventsActive: boolean;\n  addProtocol(name: string, protocol: ICoreMouseProtocol): void;\n  addEncoding(name: string, encoding: CoreMouseEncoding): void;\n  reset(): void;\n\n  /**\n   * Triggers a mouse event to be sent.\n   *\n   * Returns true if the event passed all protocol restrictions and a report\n   * was sent, otherwise false. The return value may be used to decide whether\n   * the default event action in the bowser component should be omitted.\n   *\n   * Note: The method will change values of the given event object\n   * to fullfill protocol and encoding restrictions.\n   */\n  triggerMouseEvent(event: ICoreMouseEvent): boolean;\n\n  /**\n   * Event to announce changes in mouse tracking.\n   */\n  onProtocolChange: IEvent<CoreMouseEventType>;\n\n  /**\n   * Human readable version of mouse events.\n   */\n  explainEvents(events: CoreMouseEventType): { [event: string]: boolean };\n}\n\nexport const ICoreService = createDecorator<ICoreService>('CoreService');\nexport interface ICoreService {\n  serviceBrand: undefined;\n\n  /**\n   * Initially the cursor will not be visible until the first time the terminal\n   * is focused.\n   */\n  isCursorInitialized: boolean;\n  isCursorHidden: boolean;\n\n  readonly modes: IModes;\n  readonly decPrivateModes: IDecPrivateModes;\n\n  readonly onData: IEvent<string>;\n  readonly onUserInput: IEvent<void>;\n  readonly onBinary: IEvent<string>;\n  readonly onRequestScrollToBottom: IEvent<void>;\n\n  reset(): void;\n\n  /**\n   * Triggers the onData event in the public API.\n   * @param data The data that is being emitted.\n   * @param wasUserInput Whether the data originated from the user (as opposed to\n   * resulting from parsing incoming data). When true this will also:\n   * - Scroll to the bottom of the buffer if option scrollOnUserInput is true.\n   * - Fire the `onUserInput` event (so selection can be cleared).\n   */\n  triggerDataEvent(data: string, wasUserInput?: boolean): void;\n\n  /**\n   * Triggers the onBinary event in the public API.\n   * @param data The data that is being emitted.\n   */\n  triggerBinaryEvent(data: string): void;\n}\n\nexport const ICharsetService = createDecorator<ICharsetService>('CharsetService');\nexport interface ICharsetService {\n  serviceBrand: undefined;\n\n  charset: ICharset | undefined;\n  readonly glevel: number;\n\n  reset(): void;\n\n  /**\n   * Set the G level of the terminal.\n   * @param g\n   */\n  setgLevel(g: number): void;\n\n  /**\n   * Set the charset for the given G level of the terminal.\n   * @param g\n   * @param charset\n   */\n  setgCharset(g: number, charset: ICharset | undefined): void;\n}\n\nexport interface IServiceIdentifier<T> {\n  (...args: any[]): void;\n  type: T;\n}\n\nexport interface IBrandedService {\n  serviceBrand: undefined;\n}\n\ntype GetLeadingNonServiceArgs<TArgs extends any[]> = TArgs extends [] ? []\n  : TArgs extends [...infer TFirst, infer TLast] ? TLast extends IBrandedService ? GetLeadingNonServiceArgs<TFirst> : TArgs\n    : never;\n\nexport const IInstantiationService = createDecorator<IInstantiationService>('InstantiationService');\nexport interface IInstantiationService {\n  serviceBrand: undefined;\n\n  setService<T>(id: IServiceIdentifier<T>, instance: T): void;\n  getService<T>(id: IServiceIdentifier<T>): T | undefined;\n  createInstance<Ctor extends new (...args: any[]) => any, R extends InstanceType<Ctor>>(t: Ctor, ...args: GetLeadingNonServiceArgs<ConstructorParameters<Ctor>>): R;\n}\n\nexport enum LogLevelEnum {\n  TRACE = 0,\n  DEBUG = 1,\n  INFO = 2,\n  WARN = 3,\n  ERROR = 4,\n  OFF = 5\n}\n\nexport const ILogService = createDecorator<ILogService>('LogService');\nexport interface ILogService {\n  serviceBrand: undefined;\n\n  readonly logLevel: LogLevelEnum;\n\n  trace(message: any, ...optionalParams: any[]): void;\n  debug(message: any, ...optionalParams: any[]): void;\n  info(message: any, ...optionalParams: any[]): void;\n  warn(message: any, ...optionalParams: any[]): void;\n  error(message: any, ...optionalParams: any[]): void;\n}\n\nexport const IOptionsService = createDecorator<IOptionsService>('OptionsService');\nexport interface IOptionsService {\n  serviceBrand: undefined;\n\n  /**\n   * Read only access to the raw options object, this is an internal-only fast path for accessing\n   * single options without any validation as we trust TypeScript to enforce correct usage\n   * internally.\n   */\n  readonly rawOptions: Required<ITerminalOptions>;\n\n  /**\n   * Options as exposed through the public API, this property uses getters and setters with\n   * validation which makes it safer but slower. {@link rawOptions} should be used for pretty much\n   * all internal usage for performance reasons.\n   */\n  readonly options: Required<ITerminalOptions>;\n\n  /**\n   * Adds an event listener for when any option changes.\n   */\n  readonly onOptionChange: IEvent<keyof ITerminalOptions>;\n\n  /**\n   * Adds an event listener for when a specific option changes, this is a convenience method that is\n   * preferred over {@link onOptionChange} when only a single option is being listened to.\n   */\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  onSpecificOptionChange<T extends keyof ITerminalOptions>(key: T, listener: (arg1: Required<ITerminalOptions>[T]) => any): IDisposable;\n\n  /**\n   * Adds an event listener for when a set of specific options change, this is a convenience method\n   * that is preferred over {@link onOptionChange} when multiple options are being listened to and\n   * handled the same way.\n   */\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  onMultipleOptionChange(keys: (keyof ITerminalOptions)[], listener: () => any): IDisposable;\n}\n\nexport type FontWeight = 'normal' | 'bold' | '100' | '200' | '300' | '400' | '500' | '600' | '700' | '800' | '900' | number;\nexport type LogLevel = 'trace' | 'debug' | 'info' | 'warn' | 'error' | 'off';\n\nexport interface ITerminalOptions {\n  allowProposedApi?: boolean;\n  allowTransparency?: boolean;\n  altClickMovesCursor?: boolean;\n  cols?: number;\n  convertEol?: boolean;\n  cursorBlink?: boolean;\n  cursorStyle?: CursorStyle;\n  cursorWidth?: number;\n  cursorInactiveStyle?: CursorInactiveStyle;\n  customGlyphs?: boolean;\n  disableStdin?: boolean;\n  drawBoldTextInBrightColors?: boolean;\n  fastScrollModifier?: 'none' | 'alt' | 'ctrl' | 'shift';\n  fastScrollSensitivity?: number;\n  fontSize?: number;\n  fontFamily?: string;\n  fontWeight?: FontWeight;\n  fontWeightBold?: FontWeight;\n  ignoreBracketedPasteMode?: boolean;\n  letterSpacing?: number;\n  lineHeight?: number;\n  linkHandler?: ILinkHandler | null;\n  logLevel?: LogLevel;\n  logger?: ILogger | null;\n  macOptionIsMeta?: boolean;\n  macOptionClickForcesSelection?: boolean;\n  minimumContrastRatio?: number;\n  rightClickSelectsWord?: boolean;\n  rows?: number;\n  screenReaderMode?: boolean;\n  scrollback?: number;\n  scrollOnUserInput?: boolean;\n  scrollSensitivity?: number;\n  smoothScrollDuration?: number;\n  tabStopWidth?: number;\n  theme?: ITheme;\n  windowsMode?: boolean;\n  windowsPty?: IWindowsPty;\n  windowOptions?: IWindowOptions;\n  wordSeparator?: string;\n  overviewRulerWidth?: number;\n\n  [key: string]: any;\n  cancelEvents: boolean;\n  termName: string;\n}\n\nexport interface ITheme {\n  foreground?: string;\n  background?: string;\n  cursor?: string;\n  cursorAccent?: string;\n  selectionForeground?: string;\n  selectionBackground?: string;\n  selectionInactiveBackground?: string;\n  black?: string;\n  red?: string;\n  green?: string;\n  yellow?: string;\n  blue?: string;\n  magenta?: string;\n  cyan?: string;\n  white?: string;\n  brightBlack?: string;\n  brightRed?: string;\n  brightGreen?: string;\n  brightYellow?: string;\n  brightBlue?: string;\n  brightMagenta?: string;\n  brightCyan?: string;\n  brightWhite?: string;\n  extendedAnsi?: string[];\n}\n\nexport const IOscLinkService = createDecorator<IOscLinkService>('OscLinkService');\nexport interface IOscLinkService {\n  serviceBrand: undefined;\n  /**\n   * Registers a link to the service, returning the link ID. The link data is managed by this\n   * service and will be freed when this current cursor position is trimmed off the buffer.\n   */\n  registerLink(linkData: IOscLinkData): number;\n  /**\n   * Adds a line to a link if needed.\n   */\n  addLineToLink(linkId: number, y: number): void;\n  /** Get the link data associated with a link ID. */\n  getLinkData(linkId: number): IOscLinkData | undefined;\n}\n\nexport const IUnicodeService = createDecorator<IUnicodeService>('UnicodeService');\nexport interface IUnicodeService {\n  serviceBrand: undefined;\n  /** Register an Unicode version provider. */\n  register(provider: IUnicodeVersionProvider): void;\n  /** Registered Unicode versions. */\n  readonly versions: string[];\n  /** Currently active version. */\n  activeVersion: string;\n  /** Event triggered, when activate version changed. */\n  readonly onChange: IEvent<string>;\n\n  /**\n   * Unicode version dependent\n   */\n  wcwidth(codepoint: number): number;\n  getStringCellWidth(s: string): number;\n}\n\nexport interface IUnicodeVersionProvider {\n  readonly version: string;\n  wcwidth(ucs: number): 0 | 1 | 2;\n}\n\nexport const IDecorationService = createDecorator<IDecorationService>('DecorationService');\nexport interface IDecorationService extends IDisposable {\n  serviceBrand: undefined;\n  readonly decorations: IterableIterator<IInternalDecoration>;\n  readonly onDecorationRegistered: IEvent<IInternalDecoration>;\n  readonly onDecorationRemoved: IEvent<IInternalDecoration>;\n  registerDecoration(decorationOptions: IDecorationOptions): IDecoration | undefined;\n  reset(): void;\n  /**\n   * Trigger a callback over the decoration at a cell (in no particular order). This uses a callback\n   * instead of an iterator as it's typically used in hot code paths.\n   */\n  forEachDecorationAtCell(x: number, line: number, layer: 'bottom' | 'top' | undefined, callback: (decoration: IInternalDecoration) => void): void;\n}\nexport interface IInternalDecoration extends IDecoration {\n  readonly options: IDecorationOptions;\n  readonly backgroundColorRGB: IColor | undefined;\n  readonly foregroundColorRGB: IColor | undefined;\n  readonly onRenderEmitter: IEventEmitter<HTMLElement>;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * Copyright (c) 2017 The xterm.js authors. All rights reserved.\n * @license MIT\n */\n\nimport { ICharacterJoinerService, ICharSizeService, ICoreBrowserService, IRenderService, IThemeService } from 'browser/services/Services';\nimport { ITerminal } from 'browser/Types';\nimport { EventEmitter, forwardEvent } from 'common/EventEmitter';\nimport { Disposable, toDisposable } from 'common/Lifecycle';\nimport { getSafariVersion, isSafari } from 'common/Platform';\nimport { ICoreService, IDecorationService, ILogService, IOptionsService } from 'common/services/Services';\nimport { ITerminalAddon, Terminal } from 'xterm';\nimport { WebglRenderer } from './WebglRenderer';\nimport { setTraceLogger } from 'common/services/LogService';\n\nexport class WebglAddon extends Disposable implements ITerminalAddon {\n  private _terminal?: Terminal;\n  private _renderer?: WebglRenderer;\n\n  private readonly _onChangeTextureAtlas = this.register(new EventEmitter<HTMLCanvasElement>());\n  public readonly onChangeTextureAtlas = this._onChangeTextureAtlas.event;\n  private readonly _onAddTextureAtlasCanvas = this.register(new EventEmitter<HTMLCanvasElement>());\n  public readonly onAddTextureAtlasCanvas = this._onAddTextureAtlasCanvas.event;\n  private readonly _onRemoveTextureAtlasCanvas = this.register(new EventEmitter<HTMLCanvasElement>());\n  public readonly onRemoveTextureAtlasCanvas = this._onRemoveTextureAtlasCanvas.event;\n  private readonly _onContextLoss = this.register(new EventEmitter<void>());\n  public readonly onContextLoss = this._onContextLoss.event;\n\n  constructor(\n    private _preserveDrawingBuffer?: boolean\n  ) {\n    if (isSafari && getSafariVersion() < 16) {\n      throw new Error('Webgl2 is only supported on Safari 16 and above');\n    }\n    super();\n  }\n\n  public activate(terminal: Terminal): void {\n    const core = (terminal as any)._core as ITerminal;\n    if (!terminal.element) {\n      this.register(core.onWillOpen(() => this.activate(terminal)));\n      return;\n    }\n\n    this._terminal = terminal;\n    const coreService: ICoreService = core.coreService;\n    const optionsService: IOptionsService = core.optionsService;\n\n    const unsafeCore = core as any;\n    const renderService: IRenderService = unsafeCore._renderService;\n    const characterJoinerService: ICharacterJoinerService = unsafeCore._characterJoinerService;\n    const charSizeService: ICharSizeService = unsafeCore._charSizeService;\n    const coreBrowserService: ICoreBrowserService = unsafeCore._coreBrowserService;\n    const decorationService: IDecorationService = unsafeCore._decorationService;\n    const logService: ILogService = unsafeCore._logService;\n    const themeService: IThemeService = unsafeCore._themeService;\n\n    // Set trace logger just in case it hasn't been yet which could happen when the addon is\n    // bundled separately to the core module\n    setTraceLogger(logService);\n\n    this._renderer = this.register(new WebglRenderer(\n      terminal,\n      characterJoinerService,\n      charSizeService,\n      coreBrowserService,\n      coreService,\n      decorationService,\n      optionsService,\n      themeService,\n      this._preserveDrawingBuffer\n    ));\n    this.register(forwardEvent(this._renderer.onContextLoss, this._onContextLoss));\n    this.register(forwardEvent(this._renderer.onChangeTextureAtlas, this._onChangeTextureAtlas));\n    this.register(forwardEvent(this._renderer.onAddTextureAtlasCanvas, this._onAddTextureAtlasCanvas));\n    this.register(forwardEvent(this._renderer.onRemoveTextureAtlasCanvas, this._onRemoveTextureAtlasCanvas));\n    renderService.setRenderer(this._renderer);\n\n    this.register(toDisposable(() => {\n      const renderService: IRenderService = (this._terminal as any)._core._renderService;\n      renderService.setRenderer((this._terminal as any)._core._createRenderer());\n      renderService.handleResize(terminal.cols, terminal.rows);\n    }));\n  }\n\n  public get textureAtlas(): HTMLCanvasElement | undefined {\n    return this._renderer?.textureAtlas;\n  }\n\n  public clearTextureAtlas(): void {\n    this._renderer?.clearTextureAtlas();\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","self","_listeners","_disposed","event","this","_event","listener","push","dispose","i","length","splice","fire","arg1","arg2","queue","call","undefined","clearListeners","from","to","e","disposeArray","disposables","d","_disposables","_isDisposed","register","unregister","index","indexOf","value","_value","clear","f","array","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","NON_WORD_CHARACTERS","SearchAddon","Disposable","constructor","options","super","_highlightedLines","Set","_highlightDecorations","_selectedDecoration","MutableDisposable","_linesCacheTimeoutId","_onDidChangeResults","EventEmitter","onDidChangeResults","_highlightLimit","highlightLimit","activate","terminal","_terminal","onWriteParsed","_updateMatches","onResize","toDisposable","clearDecorations","_highlightTimeout","window","clearTimeout","_cachedSearchTerm","_lastSearchOptions","decorations","setTimeout","term","findPrevious","incremental","noScroll","retainCachedSearchTerm","findNext","searchOptions","Error","_highlightAllMatches","found","_findNextAndSelect","_fireResults","searchResultsWithHighlight","prevResult","result","_find","row","col","cols","match","decoration","_createResultDecoration","add","marker","line","startRow","startCol","clearSelection","_initLinesCache","searchPosition","_findInLine","y","buffer","active","baseY","rows","prevSelectedPos","getSelectionPosition","end","x","start","_selectResult","_findPreviousAndSelect","resultIndex","selectedMatch","size","resultCount","isReverseSearch","Math","max","_linesCache","Array","_cursorMoveListener","onCursorMove","_destroyLinesCache","_resizeListener","_isWholeWord","searchIndex","includes","firstLine","getLine","isWrapped","cache","_translateBufferLineToStringWithWrap","stringLine","offsets","offset","_bufferColsToStringOffset","searchTerm","caseSensitive","toLowerCase","searchStringLine","regex","searchRegex","RegExp","foundTerm","exec","slice","lastIndex","lastIndexOf","wholeWord","startRowOffset","endRowOffset","startColOffset","endColOffset","startColIndex","_stringLengthToBufferSize","cell","getCell","char","getChars","nextCell","getWidth","lineIndex","getCode","trimRight","strings","lineOffsets","nextLine","lineWrapsToNext","string","translateToString","lastCell","join","select","registerMarker","cursorY","registerDecoration","width","backgroundColor","activeMatchBackground","layer","overviewRulerOptions","color","activeMatchColorOverviewRuler","onRender","_applyStyles","activeMatchBorder","onDispose","viewportY","scroll","floor","scrollLines","element","borderColor","isActiveResult","classList","contains","style","outline","findResultDecoration","matchBackground","has","matchOverviewRuler","position","matchBorder","INDICES_PER_CELL","BYTES_PER_CELL","Float32Array","BYTES_PER_ELEMENT","$glyph","$i","$leftCellPadding","$clippedPixels","GlyphRenderer","_gl","_dimensions","_activeBuffer","_vertices","count","attributes","attributesBuffers","gl","TextureAtlas","maxAtlasPages","min","throwIfFalsy","getParameter","MAX_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","_program","createProgram","maxFragmentShaderTextureUnits","textureConditionals","createFragmentShaderSource","deleteProgram","_projectionLocation","getUniformLocation","_resolutionLocation","_textureLocation","_vertexArrayObject","createVertexArray","bindVertexArray","unitQuadVertices","unitQuadVerticesBuffer","createBuffer","deleteBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","FLOAT","unitQuadElementIndices","Uint8Array","elementIndicesBuffer","ELEMENT_ARRAY_BUFFER","_attributesBuffer","vertexAttribDivisor","useProgram","textureUnits","Int32Array","uniform1iv","uniformMatrix4fv","PROJECTION_MATRIX","_atlasTextures","glTexture","GLTexture","createTexture","deleteTexture","texture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","enable","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","handleResize","beginFrame","_atlas","updateCell","code","bg","fg","ext","chars","lastBg","_updateCell","NULL_CELL_CODE","getRasterizedGlyphCombinedChar","getRasterizedGlyph","device","left","top","canvas","height","texturePage","texturePositionClipSpace","pages","sizeClipSpace","fill","newCount","viewport","uniform2f","render","renderModel","activeBuffer","bufferLength","lineLengths","si","sub","subarray","set","STREAM_DRAW","version","_bindAtlasPageTexture","drawElementsInstanced","TRIANGLE_STRIP","setAtlas","atlas","generateMipmap","setDimensions","dimensions","traceCall","BYTES_PER_RECTANGLE","Vertices","$rgba","$x1","$y1","$r","$g","$b","$a","RectangleRenderer","_themeService","_verticesCursor","_updateCachedColors","colors","onChangeColors","_updateViewportRectangle","renderBackgrounds","_renderVertices","renderCursor","vertices","DYNAMIC_DRAW","_bgFloat","_colorToFloat32Array","background","_cursorFloat","cursor","_addRectangleFloat","updateBackgrounds","model","currentStartX","currentBg","currentFg","currentInverse","modelIndex","inverse","rectangleCount","RENDER_MODEL_INDICIES_PER_CELL","cells","RENDER_MODEL_BG_OFFSET","RENDER_MODEL_FG_OFFSET","_updateRectangle","updateCursor","dpr","cursorWidth","startX","endX","ansi","rgba","foreground","expandFloat32Array","_addRectangle","x1","y1","r","g","b","a","RENDER_MODEL_EXT_OFFSET","COMBINED_CHAR_BIT_MASK","Uint32Array","selection","createSelectionRenderModel","resize","indexCount","WebglRenderer","_characterJoinerService","_charSizeService","_coreBrowserService","_coreService","_decorationService","_optionsService","preserveDrawingBuffer","_cursorBlinkStateManager","_charAtlasDisposable","_model","RenderModel","_workCell","CellData","_rectangleRenderer","_glyphRenderer","_onChangeTextureAtlas","onChangeTextureAtlas","_onAddTextureAtlasCanvas","onAddTextureAtlasCanvas","_onRemoveTextureAtlasCanvas","onRemoveTextureAtlasCanvas","_onRequestRedraw","onRequestRedraw","_onContextLoss","onContextLoss","_handleColorChange","_cellColorResolver","CellColorResolver","_core","_renderLayers","LinkRenderLayer","screenElement","linkifier2","createRenderDimensions","_devicePixelRatio","_updateDimensions","_updateCursorBlink","onOptionChange","_handleOptionsChanged","_canvas","document","createElement","contextAttributes","antialias","depth","getContext","addDisposableDomListener","console","log","preventDefault","_contextRestorationTimeout","warn","removeTerminalFromCache","_initializeWebGLState","_requestRedrawViewport","observeDevicePixelDimensions","w","h","_setCanvasDevicePixelDimensions","appendChild","_isAttached","body","l","parentElement","removeChild","textureAtlas","_charAtlas","_refreshCharAtlas","_clearModel","handleDevicePixelRatioChange","css","handleCharSizeChanged","handleBlur","pause","handleFocus","resume","handleSelectionChanged","columnSelectMode","update","handleCursorMove","restartBlinkAnimation","acquireTextureAtlas","rawOptions","getDisposeArrayDisposable","forwardEvent","warmUp","clearGlyphRenderer","clearTextureAtlas","clearTexture","reset","registerCharacterJoiner","handler","deregisterCharacterJoiner","joinerId","renderRows","handleGridChanged","_updateModel","isCursorVisible","cursorBlink","CursorBlinkStateManager","_requestRedrawCursor","joinedRanges","isJoined","lastCharX","range","j","clamp","cursorX","lastCursorX","isCursorInitialized","isCursorHidden","modelUpdated","ydisp","lines","get","getJoinedCharacters","loadCell","shift","JoinedCellData","resolve","isFocused","cursorStyle","cursorInactiveStyle","cursorAccent","NULL_CELL_CHAR","ceil","lineHeight","round","letterSpacing","AttributeData","firstCell","content","combinedData","_width","isCombined","setFromCharData","getAsCharData","createShader","type","source","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","error","getShaderInfoLog","deleteShader","vertexSource","fragmentSource","program","attachShader","VERTEX_SHADER","FRAGMENT_SHADER","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","newLength","newArray","BaseRenderLayer","_container","id","zIndex","_alpha","_deviceCharWidth","_deviceCharHeight","_deviceCellWidth","_deviceCellHeight","_deviceCharLeft","_deviceCharTop","toString","_initCanvas","remove","_ctx","alpha","_clearAll","endRow","_setTransparency","oldCanvas","cloneNode","replaceChild","colorSet","dim","_fillBottomLineAtCells","fillRect","clearRect","fillStyle","_clearCells","_fillCharTrueColor","font","_getFont","textBaseline","TEXT_BASELINE","_clipCell","fillText","beginPath","rect","clip","isBold","isItalic","fontWeightBold","fontWeight","fontSize","fontFamily","container","coreBrowserService","optionsService","themeService","onShowLinkUnderline","_handleShowLinkUnderline","onHideLinkUnderline","_handleHideLinkUnderline","_state","_clearCurrentLink","middleRowCount","y2","x2","INVERTED_DEFAULT_COLOR","is256Color","node","addEventListener","disposed","removeEventListener","$colors","$fg","$bg","$hasFg","$hasBg","$isSelected","_selectionRenderModel","extended","forEachDecorationAtCell","backgroundColorRGB","foregroundColorRGB","isCellSelected","selectionBackgroundOpaque","selectionInactiveBackgroundOpaque","selectionForeground","charAtlasCache","deviceCellWidth","deviceCellHeight","deviceCharWidth","deviceCharHeight","devicePixelRatio","newConfig","generateConfig","entry","ownedByIndex","ownedBy","configEquals","config","core","newEntry","unicodeService","clonedColors","NULL_COLOR","selectionBackgroundTransparent","selectionInactiveBackgroundTransparent","contrastCache","halfContrastCache","customGlyphs","allowTransparency","drawBoldTextInBrightColors","minimumContrastRatio","colorCode","DIM_OPACITY","isFirefox","isLegacyEdge","_renderCallback","_restartInterval","isPaused","_blinkStartTimeout","_blinkInterval","clearInterval","_animationFrame","cancelAnimationFrame","_animationTimeRestarted","Date","now","requestAnimationFrame","timeToStart","BLINK_INTERVAL","time","setInterval","blockElementDefinitions","patternCharacterDefinitions","boxDrawingDefinitions","xp","yp","powerlineDefinitions","rightPadding","leftPadding","ctx","c","xOffset","yOffset","blockElementDefinition","charDefinition","box","xEighth","yEighth","drawBlockElementChar","patternDefinition","patternSet","cachedPatterns","Map","pattern","tmpCanvas","tmpCtx","imageData","ImageData","startsWith","parseInt","substring","split","map","parseFloat","data","putImageData","createPattern","drawPatternChar","boxDrawingDefinition","strokeStyle","instructions","Object","entries","actualInstructions","lineWidth","Number","instruction","svgToCanvasInstructionMap","args","translateArgs","stroke","closePath","drawBoxDrawingChar","powerlineDefinition","clipRegion","Path2D","cssLineWidth","drawPowerlineChar","bezierCurveTo","lineTo","moveTo","cellWidth","cellHeight","doClamp","parentWindow","callback","observer","ResizeObserver","find","target","disconnect","devicePixelContentBoxSize","inlineSize","blockSize","observe","isPowerlineGlyph","codepoint","isBoxOrBlockGlyph","SelectionRenderModel","hasSelection","viewportStartRow","viewportEndRow","viewportCappedStartRow","viewportCappedEndRow","endCol","selectionStart","selectionEnd","NULL_RASTERIZED_GLYPH","texturePosition","_pages","_document","_config","_unicodeService","_didWarmUp","_cacheMap","FourKeyMap","_cacheMapCombined","_activePages","_workBoundingBox","bottom","right","_workAttributeData","_textureSize","_requestClearModel","_createNewPage","_tmpCanvas","createCanvas","TMP_CANVAS_GLYPH_PADDING","_tmpCtx","willReadFrequently","page","_doWarmUp","IdleTaskQueue","enqueue","DEFAULT_COLOR","DEFAULT_EXT","rasterizedGlyph","_drawToCache","currentRow","pagesBySize","filter","sort","percentageUsed","sameSizeI","mergingPages","sortedMergingPagesIndexes","glyphs","mergedPageIndex","mergedPage","_mergePages","_deletePage","newPage","AtlasPage","mergedSize","p","drawImage","pageIndex","adjustingPage","restrictToCellHeight","_getFromCacheMap","cacheMap","key","_getColorFromAnsiIndex","idx","_getBackgroundColor","bgColorMode","bgColor","arr","toColorRGB","toColor","opaque","_getForegroundColor","fgColorMode","fgColor","bold","excludeFromContrastRatioDemands","minimumContrastColor","_getMinimumContrastColor","multiplyOpacity","_resolveBackgroundRgba","_resolveForegroundRgba","_getContrastCache","adjustedColor","getColor","bgRgba","fgRgba","ensureContrastRatio","setColor","codeOrChars","String","fromCharCode","allowedWidth","allowedHeight","save","isInvisible","isInverse","isDim","italic","underline","isUnderline","strikethrough","isStrikethrough","overline","isOverline","getFgColor","getFgColorMode","getBgColor","getBgColorMode","temp","temp2","globalCompositeOperation","fontStyle","powerlineGlyph","charCodeAt","restrictedPowerlineGlyph","isRestrictedPowerlineGlyph","foregroundColor","padding","customGlyph","tryDrawCustomChar","chWidth","enableClearThresholdCheck","wcwidth","getStringCellWidth","isUnderlineColorDefault","isUnderlineColorRGB","getUnderlineColor","xLeft","yTop","yMid","yBot","xChLeft","xChRight","xChMid","underlineStyle","yCurlyBot","yCurlyTop","setLineDash","restore","metrics","measureText","actualBoundingBoxDescent","strokeText","isBeyondCellBounds","clearColor","getImageData","isEmpty","checkCompletelyTransparent","_findGlyphBoundingBox","activePage","activeRow","fixedRows","wasPageAndRowFound","candidatePage","addGlyph","boundingBox","restrictedGlyph","alphaOffset","_usedPixels","_glyphs","glyph","sourcePages","enableThresholdCheck","fgR","fgG","fgB","threshold","abs","channels","rgb","toPaddedHex","s","contrastRatio","l1","l2","toCss","toRgba","opacity","toChannels","blend","bgR","bgG","bgB","isOpaque","ratio","rgbaColor","factor","$ctx","$litmusColor","isNode","createLinearGradient","repeat","rgbaMatch","relativeLuminance2","rs","gs","bs","pow","relativeLuminance","reduceLuminance","cr","increaseLuminance","bgL","fgL","resultA","resultARatio","resultB","TwoKeyMap","_data","first","second","third","fourth","navigator","userAgent","platform","isSafari","test","majorVersion","isMac","isIpad","isIphone","isWindows","isLinux","isChromeOS","TaskQueue","_tasks","_i","task","_start","flush","_idleCallback","_cancelCallback","_requestCallback","_process","bind","deadline","taskDuration","longestTask","lastDeadlineRemaining","timeRemaining","deadlineRemaining","PriorityTaskQueue","_createDeadline","identifier","duration","requestIdleCallback","cancelIdleCallback","_queue","ExtendedAttrs","fromColorRGB","clone","newObj","hasExtendedAttrs","isBlink","isProtected","isFgRGB","isBgRGB","isFgPalette","isBgPalette","isFgDefault","isBgDefault","isAttributeDefault","updateExtended","underlineColor","getUnderlineColorMode","isUnderlineColorPalette","getUnderlineStyle","_urlId","_ext","urlId","fromCharData","obj","stringFromCodePoint","CHAR_DATA_ATTR_INDEX","combined","CHAR_DATA_CHAR_INDEX","CHAR_DATA_WIDTH_INDEX","DEFAULT_ATTR","CHAR_DATA_CODE_INDEX","NULL_CELL_WIDTH","WHITESPACE_CELL_CHAR","WHITESPACE_CELL_WIDTH","WHITESPACE_CELL_CODE","codePoint","_interim","decode","input","startPos","interim","byte1","byte2","byte3","byte4","discardInterim","cp","tmp","pos","missing","fourStop","optionsKeyToLogLevel","trace","LogLevelEnum","TRACE","debug","DEBUG","info","INFO","WARN","ERROR","off","OFF","traceLogger","LogService","logLevel","_logLevel","_updateLogLevel","onSpecificOptionChange","_evalLazyOptionalParams","optionalParams","_log","message","logger","IOptionsService","_target","descriptor","fn","apply","name","JSON","stringify","DI_TARGET","DI_DEPENDENCIES","serviceRegistry","ctor","decorator","arguments","storeServiceDependency","IBufferService","createDecorator","ICoreMouseService","ICoreService","ICharsetService","IInstantiationService","ILogService","IOscLinkService","IUnicodeService","IDecorationService","WebglAddon","_preserveDrawingBuffer","getSafariVersion","onWillOpen","coreService","unsafeCore","renderService","_renderService","characterJoinerService","charSizeService","decorationService","logService","_logService","setTraceLogger","_renderer","setRenderer","_createRenderer"],"ignoreList":[],"sourceRoot":""}